!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("ismobilejs")):"function"==typeof define&&define.amd?define(["exports","ismobilejs"],e):e((t=t||self).fgui=t.fgui||{},t.isMobileCall)}(this,(function(t,e){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;class i extends createjs.Container{constructor(t){super(),this.UIOwner=t,this.mouseEnabled=!0,this.mouseChildren=!0}get scrollRect(){return this.$scrollRect}set scrollRect(t){if(this.$scrollRect=t,null!=t){if(!this.$rectMask){this.$rectMask=new createjs.Graphics;var e=new createjs.Shape(this.$rectMask);this.mask=e}this.$rectMask.clear(),t.width>0&&t.height>0&&(this.$rectMask.beginFill("#000"),this.$rectMask.drawRect(this.$scrollRect.x,this.$scrollRect.y,this.$scrollRect.width,this.$scrollRect.height),this.$rectMask.endFill())}else this.mask=null}}class s{}s.Down=(createjs.Touch.isSupported(),"mousedown"),s.Cancel=(createjs.Touch.isSupported(),"mousecancel"),s.Up=(createjs.Touch.isSupported(),"stagemouseup"),s.Click=(createjs.Touch.isSupported(),"click"),s.UpOutside=(createjs.Touch.isSupported(),"mouseupoutside"),s.Move=(createjs.Touch.isSupported(),"stagemousemove"),s.Over=(createjs.Touch.isSupported(),"mouseover"),s.Out=(createjs.Touch.isSupported(),"mouseout"),s.RightDown="rightdown",s.RightUp="rightup",s.RightClick="rightclick",s.RightUpOutside="rightupoutside";let h={gearDisplay:0,gearXY:1,gearSize:2,gearLook:3,gearColor:4,gearAni:5,gearText:6,gearIcon:7},r=["Normal","Add","Multiply","Screen","Overlay","Darken","Lighten","ColorDodge","ColorBurn","HardLight","SoftLight","Difference","Exclusion","Hue","Saturation","Color","Luminosity","NormalNPM","AddNPM","ScreenNPM"];function n(t){switch(t){case"visible":return 0;case"hidden":return 1;case"scroll":return 2;case"scale":return 3;case"scaleFree":return 4;default:return 0}}function a(t){switch(t){case"horizontal":return 0;case"vertical":return 1;case"both":return 2;default:return 1}}function l(t){switch(t){case"none":return 0;case"scale":return 1;case"scaleMatchHeight":return 2;case"scaleMatchWidth":return 3;case"scaleFree":return 4;case"scaleNoBorder":return 5;default:return 0}}function o(t){switch(t){case"column":return 0;case"row":return 1;case"flow_hz":return 2;case"flow_vt":return 3;case"pagination":return 4;default:return 0}}function $(t){switch(t){case"single":return 0;case"multiple":return 1;case"multipleSingleClick":return 2;case"none":return 3;default:return 0}}function c(t){switch(t){case"image":return 0;case"movieclip":return 2;case"sound":return 3;case"component":return 4;case"swf":return 1;case"font":return 6;case"atlas":return 7;default:return 5}}function d(t){switch(t){case"percent":return 0;case"valueAndmax":return 1;case"value":return 2;case"max":return 3;default:return 0}}function u(t){switch(t){case"default":return 0;case"visible":return 1;case"auto":return 2;case"hidden":return 3;default:return 0}}function p(t){switch(t){case"hz":return 1;case"vt":return 2;case"both":return 3;default:return 0}}function g(t){switch(t){case"Common":return 0;case"Check":return 1;case"Radio":return 2;default:return 0}}function f(t){switch(t){case"none":return 0;case"both":return 1;case"height":return 2;case"shrink":return 3;default:return 0}}function m(t){switch(t){case"left":return"left";case"center":return"center";case"right":return"right";default:return"left"}}function w(t){switch(t){case"top":return 0;case"middle":return 1;case"bottom":return 2;default:return 0}}function y(t){switch(t){case"ascent":return 0;case"descent":return 1;case"arch":return 2;default:return 0}}let b={Linear:createjs.Ease.linear,"Elastic.In":createjs.Ease.elasticIn,"Elastic.Out":createjs.Ease.elasticOut,"Elastic.InOut":createjs.Ease.elasticInOut,"Quad.In":createjs.Ease.quadIn,"Quad.Out":createjs.Ease.quadOut,"Quad.InOut":createjs.Ease.quadInOut,"Cube.In":createjs.Ease.cubicIn,"Cube.Out":createjs.Ease.cubicOut,"Cube.InOut":createjs.Ease.cubicInOut,"Quart.In":createjs.Ease.quartIn,"Quart.Out":createjs.Ease.quartOut,"Quart.InOut":createjs.Ease.quartInOut,"Quint.In":createjs.Ease.quintIn,"Quint.Out":createjs.Ease.quintOut,"Quint.InOut":createjs.Ease.quintInOut,"Sine.In":createjs.Ease.sineIn,"Sine.Out":createjs.Ease.sineOut,"Sine.InOut":createjs.Ease.sineInOut,"Bounce.In":createjs.Ease.bounceIn,"Bounce.Out":createjs.Ease.bounceOut,"Bounce.InOut":createjs.Ease.bounceInOut,"Circ.In":createjs.Ease.circIn,"Circ.Out":createjs.Ease.circOut,"Circ.InOut":createjs.Ease.circInOut,"Expo.In":createjs.Ease.quartIn,"Expo.Out":createjs.Ease.quartOut,"Expo.InOut":createjs.Ease.quartInOut,"Back.In":createjs.Ease.backIn,"Back.Out":createjs.Ease.backOut,"Back.InOut":createjs.Ease.backInOut};function x(t){return b[t]||b.Linear}class S{}S.defaultFont="Arial",S.modalLayerColor="#333333",S.modalLayerAlpha=.2,S.buttonSoundVolumeScale=1,S.defaultScrollSpeed=25,S.defaultScrollBarDisplay=1,S.defaultScrollTouchEffect=!0,S.defaultScrollBounceEffect=!0,S.defaultScrollDecelerationRate=.967,S.defaultComboBoxVisibleItemCount=10,S.touchScrollSensitivity=20,S.touchDragSensitivity=10,S.bringWindowToFrontOnClick=!0;class v{constructor(t){this.$lockToken=0,this.$owner=t,this.$easeType=x("Quad.Out"),this.$tweenTime=.3,this.$tweenDelay=0}get controller(){return this.$controller}set controller(t){t!=this.$controller&&(this.$controller=t,this.$controller&&this.init())}get tween(){return this.$tween}set tween(t){this.$tween=t}get tweenDelay(){return this.$tweenDelay}set tweenDelay(t){this.$tweenDelay=t}get tweenTime(){return this.$tweenTime}set tweenTime(t){this.$tweenTime=t}get easeType(){return this.$easeType}set easeType(t){this.$easeType=t}setup(t){if(this.$controller=this.$owner.parent.getController(t.attributes.controller),null==this.$controller)return;let e;if(this.init(),e=t.attributes.tween,e&&(this.$tween=!0),e=t.attributes.ease,e&&(this.$easeType=x(e)),e=t.attributes.duration,e&&(this.$tweenTime=parseFloat(e)),e=t.attributes.delay,e&&(this.$tweenDelay=parseFloat(e)),null!=this.$vid)e=t.attributes.pages,e&&(this.pages=e.split(","));else{let i,s;e=t.attributes.pages,e&&(i=e.split(",")),e=t.attributes.values,e&&(s=e.split("|")),i&&s&&s.forEach((t,e)=>{this.addStatus(i[e],t)}),e=t.attributes.default,e&&this.addStatus(null,e)}}updateFromRelations(t,e){}addStatus(t,e){}init(){}apply(){}updateState(){}}v.disableAllTweenEffect=!1;class C extends v{constructor(t){super(t),this.$vid=0,this.$lockToken=1}init(){this.pages=null}lock(){return this.$vid++,this.$lockToken}release(t){t==this.$lockToken&&this.$vid--}get connected(){return null==this.controller||this.$vid>0}apply(){this.$lockToken++,this.$lockToken<=0&&(this.$lockToken=1),null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this.$controller.selectedPageId)?this.$vid=1:this.$vid=0}}class I{constructor(){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.width=0,this.height=0,this.advance=0,this.lineHeight=0,this.channel=0}}class P{constructor(){this.size=0,this.glyphs={}}}class E{constructor(){this.addDelay=0}}class k extends createjs.LoadQueue{constructor(t,e,i){super(t,e),this.on("complete",this._onComplete,this)}_onComplete(t){var e=t.target._loadedResults;k.addResources(e)}static get resourcesPool(){return k.$resources}static destroyResource(t){k.$resources[t]&&delete k.$resources[t]}static addResources(t){if(t)for(let e in t)k.$resources[e]=t[e]}}k.$resources={};class O{}O.LITTLE_ENDIAN="littleEndian",O.BIG_ENDIAN="bigEndian";class T{constructor(t,e=0){this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,e<0&&(e=0),this.bufferExtSize=e;let i,s=0;if(t){let h;if(t instanceof Uint8Array?(h=t,s=t.length):(s=t.byteLength,h=new Uint8Array(t)),0==e)i=new Uint8Array(s);else{i=new Uint8Array((1+(s/e|0))*e)}i.set(h)}else i=new Uint8Array(e);this.write_position=s,this._position=0,this._bytes=i,this.data=new DataView(i.buffer),this.endian=O.BIG_ENDIAN}get endian(){return 0==this.$endian?O.LITTLE_ENDIAN:O.BIG_ENDIAN}set endian(t){this.$endian=t==O.LITTLE_ENDIAN?0:1}get readAvailable(){return this.write_position-this._position}get buffer(){return this.data.buffer.slice(0,this.write_position)}get rawBuffer(){return this.data.buffer}set buffer(t){let e,i=t.byteLength,s=new Uint8Array(t),h=this.bufferExtSize;if(0==h)e=new Uint8Array(i);else{e=new Uint8Array((1+(i/h|0))*h)}e.set(s),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)}get bytes(){return this._bytes}get dataView(){return this.data}set dataView(t){this.buffer=t.buffer}get bufferOffset(){return this.data.byteOffset}get position(){return this._position}set position(t){this._position=t,t>this.write_position&&(this.write_position=t)}get length(){return this.write_position}set length(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)}_validateBuffer(t){if(this.data.byteLength<t){let e,i=this.bufferExtSize;if(0==i)e=new Uint8Array(t);else{e=new Uint8Array((1+(t/i>>0))*i)}e.set(this._bytes),this._bytes=e,this.data=new DataView(e.buffer)}}get bytesAvailable(){return this.data.byteLength-this._position}clear(){let t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0}readBoolean(){if(this.validate(1))return!!this._bytes[this.position++]}readByte(){if(this.validate(1))return this.data.getInt8(this.position++)}readBytes(t,e=0,i=0){if(!t)return;let s=this._position,h=this.write_position-s;if(h<0)return;if(0==i)i=h;else if(i>h)return;const r=t._position;t._position=0,t.validateBuffer(e+i),t._position=r,t._bytes.set(this._bytes.subarray(s,s+i),e),this.position+=i}readDouble(){if(this.validate(8)){let t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}}readFloat(){if(this.validate(4)){let t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}}readInt(){if(this.validate(4)){let t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}}readShort(){if(this.validate(2)){let t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}}readUnsignedByte(){if(this.validate(1))return this._bytes[this.position++]}readUnsignedInt(){if(this.validate(4)){let t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}}readUnsignedShort(){if(this.validate(2)){let t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}}readUTF(){let t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""}readUTFBytes(t){if(!this.validate(t))return;let e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}writeBoolean(t){this.validateBuffer(1),this._bytes[this.position++]=+t}writeByte(t){this.validateBuffer(1),this._bytes[this.position++]=255&t}writeBytes(t,e=0,i=0){let s;e<0||i<0||(s=0==i?t.length-e:Math.min(t.length-e,i),s>0&&(this.validateBuffer(s),this._bytes.set(t._bytes.subarray(e,e+s),this._position),this.position=this._position+s))}writeDouble(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8}writeFloat(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4}writeInt(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4}writeShort(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2}writeUnsignedInt(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4}writeUnsignedShort(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2}writeUTF(t){let e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)}writeUTFBytes(t){this._writeUint8Array(this.encodeUTF8(t))}toString(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable}_writeUint8Array(t,e=!0){let i=this._position,s=i+t.length;e&&this.validateBuffer(s),this.bytes.set(t,i),this.position=s}validate(t){let e=this._bytes.length;if(e>0&&this._position+t<=e)return!0}validateBuffer(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)}encodeUTF8(t){let e=0,i=this.stringToCodePoints(t),s=[];for(;i.length>e;){let t=i[e++];if(this.inRange(t,55296,57343))this.encoderError(t);else if(this.inRange(t,0,127))s.push(t);else{let e,i;for(this.inRange(t,128,2047)?(e=1,i=192):this.inRange(t,2048,65535)?(e=2,i=224):this.inRange(t,65536,1114111)&&(e=3,i=240),s.push(this.div(t,Math.pow(64,e))+i);e>0;){let i=this.div(t,Math.pow(64,e-1));s.push(128+i%64),e-=1}}}return new Uint8Array(s)}decodeUTF8(t){let e,i=0,s="",h=0,r=0,n=0,a=0;for(;t.length>i;){let l=t[i++];if(l==this.EOF_byte)e=0!=r?this.decoderError(!1):this.EOF_code_point;else if(0==r)this.inRange(l,0,127)?e=l:(this.inRange(l,194,223)?(r=1,a=128,h=l-192):this.inRange(l,224,239)?(r=2,a=2048,h=l-224):this.inRange(l,240,244)?(r=3,a=65536,h=l-240):this.decoderError(!1),h*=Math.pow(64,r),e=null);else if(this.inRange(l,128,191))if(n+=1,h+=(l-128)*Math.pow(64,r-n),n!==r)e=null;else{let t=h,i=a;h=0,r=0,n=0,a=0,e=this.inRange(t,i,1114111)&&!this.inRange(t,55296,57343)?t:this.decoderError(!1,l)}else h=0,r=0,n=0,a=0,i--,e=this.decoderError(!1,l);null!==e&&e!==this.EOF_code_point&&(e<=65535?e>0&&(s+=String.fromCharCode(e)):(e-=65536,s+=String.fromCharCode(55296+(e>>10&1023)),s+=String.fromCharCode(56320+(1023&e))))}return s}encoderError(t){}decoderError(t,e){return e||65533}inRange(t,e,i){return e<=t&&t<=i}div(t,e){return Math.floor(t/e)}stringToCodePoints(t){let e=[],i=0,s=t.length;for(;i<t.length;){let h=t.charCodeAt(i);if(this.inRange(h,55296,57343))if(this.inRange(h,56320,57343))e.push(65533);else if(i==s-1)e.push(65533);else{let s=t.charCodeAt(i+1);if(this.inRange(s,56320,57343)){let t=1023&h,r=1023&s;i+=1,e.push(65536+(t<<10)+r)}else e.push(65533)}else e.push(h);i+=1}return e}}class j{static inRange(t,e,i){return e<=t&&t<=i}static decodeUTF8(t){let e,i=0,s="",h=0,r=0,n=0,a=0;for(;t.length>i;){let l=t[i++];if(-1==l)e=0!=r?65533:-1;else if(0==r)if(j.inRange(l,0,127))e=l;else{if(j.inRange(l,194,223))r=1,a=128,h=l-192;else if(j.inRange(l,224,239))r=2,a=2048,h=l-224;else{if(!j.inRange(l,240,244))throw new Error("failed to decode the raw binary data");r=3,a=65536,h=l-240}h*=Math.pow(64,r),e=null}else if(j.inRange(l,128,191))if(n+=1,h+=(l-128)*Math.pow(64,r-n),n!==r)e=null;else{let t=h,i=a;h=0,r=0,n=0,a=0,e=j.inRange(t,i,1114111)&&!this.inRange(t,55296,57343)?t:l}else h=0,r=0,n=0,a=0,i--,e=65533;null!==e&&-1!==e&&(e<=65535?e>0&&(s+=String.fromCharCode(e)):(e-=65536,s+=String.fromCharCode(55296+(e>>10&1023)),s+=String.fromCharCode(56320+(1023&e))))}return s}}var z;!function(t){t[t.BLOCK=0]="BLOCK",t[t.ADAPTIVE=1]="ADAPTIVE"}(z||(z={}));const A=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),B=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),D=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),L=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),F=t=>{var e,i,s,h,r,n,a,l,o,$,c,d=t.length,u=0,p=Number.POSITIVE_INFINITY;for(l=0,o=d;l<o;++l)t[l]>u&&(u=t[l]),t[l]<p&&(p=t[l]);for(e=1<<u,i=new Uint32Array(e),s=1,h=0,r=2;s<=u;){for(l=0;l<d;++l)if(t[l]===s){for(n=0,a=h,$=0;$<s;++$)n=n<<1|1&a,a>>=1;for(c=s<<16|l,$=n;$<e;$+=r)i[$]=c;++h}++s,h<<=1,r<<=1}return[i,u,p]},M=(()=>{let t=new Uint8Array(288);for(let e=0,i=t.length;e<i;++e)t[e]=e<=143?8:e<=255?9:e<=279?7:8;return F(t)[0]})(),_=(()=>{let t=new Uint8Array(30);for(let e=0,i=t.length;e<i;++e)t[e]=5;return F(t)})();class W{constructor(t,e){switch(this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(t),this.bfinal=!1,this.bufferType=z.ADAPTIVE,this.resize=!1,e&&(e.index&&(this.ip=e.index),e.bufferSize&&(this.bufferSize=e.bufferSize),e.bufferType&&(this.bufferType=e.bufferType),e.resize&&(this.resize=e.resize)),this.bufferType){case z.BLOCK:this.op=32768,this.output=new Uint8Array(32768+this.bufferSize+258);break;case z.ADAPTIVE:this.op=0,this.output=new Uint8Array(this.bufferSize);break;default:throw new Error("invalid inflate mode")}}decompress(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case z.BLOCK:return this.concatBufferBlock();case z.ADAPTIVE:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}}parseBlock(){let t=this.readBits(3);switch(1&t&&(this.bfinal=!0),t>>>=1,t){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+t)}}readBits(t){let e,i=this.bitsbuf,s=this.bitsbuflen,h=this.input,r=this.ip;if(r+(t-s+7>>3)>=h.length)throw new Error("input buffer is broken");for(;s<t;)i|=h[r++]<<s,s+=8;return e=i&(1<<t)-1,i>>>=t,s-=t,this.bitsbuf=i,this.bitsbuflen=s,this.ip=r,e}readCodeByTable(t){let e,i,s=this.bitsbuf,h=this.bitsbuflen,r=this.input,n=this.ip,a=r.length,l=t[0],o=t[1];for(;h<o&&!(n>=a);)s|=r[n++]<<h,h+=8;if(e=l[s&(1<<o)-1],i=e>>>16,i>h)throw new Error("invalid code length: "+i);return this.bitsbuf=s>>i,this.bitsbuflen=h-i,this.ip=n,65535&e}parseUncompressedBlock(){let t,e,i,s=this.input,h=this.ip,r=this.output,n=this.op,a=s.length,l=r.length;if(this.bitsbuf=0,this.bitsbuflen=0,h+1>=a)throw new Error("invalid uncompressed block header: LEN");if(t=s[h++]|s[h++]<<8,h+1>=a)throw new Error("invalid uncompressed block header: NLEN");if(e=s[h++]|s[h++]<<8,t===~e)throw new Error("invalid uncompressed block header: length verify");if(h+t>s.length)throw new Error("input buffer is broken");switch(this.bufferType){case z.BLOCK:for(;n+t>r.length;)i=l-n,t-=i,r.set(s.subarray(h,h+i),n),n+=i,h+=i,this.op=n,r=this.expandBufferBlock(),n=this.op;break;case z.ADAPTIVE:for(;n+t>r.length;)r=this.expandBufferAdaptive({fixRatio:2});break;default:throw new Error("invalid inflate mode")}r.set(s.subarray(h,h+t),n),n+=t,h+=t,this.ip=h,this.op=n,this.output=r}parseFixedHuffmanBlock(){switch(this.bufferType){case z.ADAPTIVE:this.decodeHuffmanAdaptive(M,_);break;case z.BLOCK:this.decodeHuffmanBlock(M,_);break;default:throw new Error("invalid inflate mode")}}parseDynamicHuffmanBlock(){let t,e,i,s,h,r,n,a,l=this.readBits(5)+257,o=this.readBits(5)+1,$=this.readBits(4)+4,c=new Uint8Array(A.length);for(n=0;n<$;++n)c[A[n]]=this.readBits(3);t=F(c);let d=new Uint8Array(l+o);for(n=0,a=l+o;n<a;)switch(s=this.readCodeByTable(t),s){case 16:for(r=3+this.readBits(2);r--;)d[n++]=h;break;case 17:for(r=3+this.readBits(3);r--;)d[n++]=0;h=0;break;case 18:for(r=11+this.readBits(7);r--;)d[n++]=0;h=0;break;default:d[n++]=s,h=s}switch(e=F(d.subarray(0,l)),i=F(d.subarray(l)),this.bufferType){case z.ADAPTIVE:this.decodeHuffmanAdaptive(e,i);break;case z.BLOCK:this.decodeHuffmanBlock(e,i);break;default:throw new Error("invalid inflate mode")}}decodeHuffmanBlock(t,e){let i=this.output,s=this.op;this.currentLitlenTable=t;let h,r,n,a,l=i.length-258,o=R,$=B,c=D,d=L;for(;256!==(h=this.readCodeByTable(t));)if(h<256)s>=l&&(this.op=s,i=this.expandBufferBlock(),s=this.op),i[s++]=h;else for(r=h-257,a=o[r],$[r]>0&&(a+=this.readBits($[r])),h=this.readCodeByTable(e),n=c[h],d[h]>0&&(n+=this.readBits(d[h])),s>=l&&(this.op=s,i=this.expandBufferBlock(),s=this.op);a--;)i[s]=i[s++-n];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=s}decodeHuffmanAdaptive(t,e){let i=this.output,s=this.op;this.currentLitlenTable=t;let h,r,n,a,l=i.length,o=R,$=B,c=D,d=L;for(;256!==(h=this.readCodeByTable(t));)if(h<256)s>=l&&(i=this.expandBufferAdaptive(),l=i.length),i[s++]=h;else for(r=h-257,a=o[r],$[r]>0&&(a+=this.readBits($[r])),h=this.readCodeByTable(e),n=c[h],d[h]>0&&(n+=this.readBits(d[h])),s+a>l&&(i=this.expandBufferAdaptive(),l=i.length);a--;)i[s]=i[s++-n];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=s}expandBufferBlock(){let t=new Uint8Array(this.op-32768),e=this.op-32768,i=this.output;return t.set(i.subarray(32768,t.length)),this.blocks.push(t),this.totalpos+=t.length,i.set(i.subarray(e,e+32768)),this.op=32768,i}expandBufferAdaptive(t){let e,i,s,h,r=this.input.length/this.ip+1|0,n=this.input,a=this.output;return t&&("number"==typeof t.fixRatio&&(r=t.fixRatio),"number"==typeof t.addRatio&&(r+=t.addRatio)),r<2?(i=(n.length-this.ip)/this.currentLitlenTable[2],h=i/2*258|0,s=h<a.length?a.length+h:a.length<<1):s=a.length*r,e=new Uint8Array(s),e.set(a),this.output=e,this.output}concatBufferBlock(){let t,e,i,s,h,r=0,n=this.totalpos+(this.op-32768),a=this.output,l=this.blocks,o=new Uint8Array(n);if(0===l.length)return this.output.subarray(32768,this.op);for(e=0,i=l.length;e<i;++e)for(t=l[e],s=0,h=t.length;s<h;++s)o[r++]=t[s];for(e=32768,i=this.op;e<i;++e)o[r++]=a[e];return this.blocks=[],this.buffer=o,this.buffer}concatBufferDynamic(){let t,e=this.op;return this.resize?(t=new Uint8Array(e),t.set(this.output.subarray(0,e))):t=this.output.subarray(0,e),this.buffer=t,this.buffer}}class H{static encodeHTML(t){return t?t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&apos;"):""}static getFileName(t){let e=t.lastIndexOf("/");return-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("\\"),-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("."),-1!=e?t.substring(0,e):t}static startsWith(t,e,i=!1){return!!t&&(!(t.length<e.length)&&(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e))}static endsWith(t,e,i=!1){return!!t&&(!(t.length<e.length)&&(t=t.substring(t.length-e.length),i?t.toLowerCase()==e.toLowerCase():t==e))}static trim(t){return H.trimLeft(H.trimRight(t))}static trimLeft(t){let e,i="";for(e=0;e<t.length&&(i=t.charAt(e)," "==i||"\n"==i||"\r"==i);e++);return t.substr(e)}static trimRight(t){let e,i="";for(e=t.length-1;e>=0&&(i=t.charAt(e)," "==i||"\n"==i||"\r"==i);e--);return t.substring(0,e+1)}static convertToHtmlColor(t,e=!1){let i;i=e?(t>>24&255).toString(16):"";let s=(t>>16&255).toString(16),h=(t>>8&255).toString(16),r=(255&t).toString(16);return 1==i.length&&(i="0"+i),1==s.length&&(s="0"+s),1==h.length&&(h="0"+h),1==r.length&&(r="0"+r),`#${i}${s}${h}${r}`}static convertFromHtmlColor(t,e=!1){return t.length<1?0:("#"==t.charAt(0)&&(t=t.substr(1)),8==t.length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16))}static convertToRGBA(t){"#"==t.charAt(0)&&(t=t.substr(1));let e=+(parseInt("0x"+t.slice(0,2))/255).toFixed(2);t=t.substr(2);let i=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),h=parseInt(t.substring(4),16);return createjs.Graphics.getRGB(i,s,h,e)}static HEX2RGB(t){return"#"==t.charAt(0)&&(t=t.substr(1)),3===t.length&&(t+=t),`${this.HEX2DEC(t.substring(0,2))},${this.HEX2DEC(t.substring(2,4))},${this.HEX2DEC(t.substring(4))}`}static HEX2DEC(t){return parseInt(t,16).toString()}}class G{static deepCopyProperties(t,e,i){for(var s in i)Array.isArray(e[s])?t[s]=e[s].slice():t[s]=e[s]}static fillPath(t,e,i,s){var h=e.length;t.moveTo(e[0]+i,e[1]+s);for(var r=2;r<h;r+=2)t.lineTo(e[r]+i,e[r+1]+s);t.lineTo(e[0]+i,e[1]+s)}}G.TextureCache={};class N{constructor(t){this.nodeName=t.nodeName,this.context=t,this.type=t.nodeType,this.text=this.type==Node.COMMENT_NODE||this.type==Node.TEXT_NODE?this.context.textContent:null}get children(){return this.$children||(this.$children=V.getChildNodes(this)),this.$children}get attributes(){return this.$attributes||(this.$attributes=V.getNodeAttributes(this)),this.$attributes}}class V{static tryParse(t,e="application/xml"){let i=V.$parser.parseFromString(t,e);return i&&i.childNodes&&i.childNodes.length>=1?new N(i.firstChild):null}static getXmlRoot(t){if(!t||!t.context)throw new Error("Invalid xml node");let e=t.context;for(;null!=e.parentNode;)e=e.parentNode;return e==t.context?t:new N(e)}static getChildNodes(t,e=null){let i=t.context.childNodes,s=[];if(!i||i.length<=0)return s;let h=i.length;for(let t=0;t<h;t++){let h=i.item(t);h.nodeType!=Node.TEXT_NODE&&((!e||e&&e.length>0&&h.nodeName.toLowerCase()==e.toLowerCase())&&s.push(new N(h)))}return s}static getNodeAttributes(t){let e=t.context.attributes,i={};if(!e||e.length<=0)return i;let s=e.length;for(let t=0;t<s;t++){let s=e.item(t);i[s.nodeName]=s.nodeValue}return i}}V.$parser=new DOMParser;class U{constructor(t,e){this.packageItem=t,this.type=e}}class X{constructor(){this.width=0,this.height=0,this.tiledSlices=0,this.interval=0,this.repeatDelay=0}load(){return this.owner.getItemAsset(this)}toString(){return this.name}}class Y{constructor(t,e,i,s,h){this.atlasName=t,this.frame=e,this.orig=i,this.trim=s,this.rotate=h}}class q{constructor(){this.$items=[],this.$atlasConfigs={}}static getById(t){return q.$packageInstById[t]}static getByName(t){return q.$packageInstByName[t]}static addPackage(t){let e=new q;return e.$resKey=t,e.create(t),q.$packageInstById[e.id]=e,q.$packageInstByName[e.name]=e,e.customId=t,e}static removePackage(t){let e=q.$packageInstById[t];e.dispose(),delete q.$packageInstById[e.id],null!=e.$customId&&delete q.$packageInstById[e.$customId],delete q.$packageInstByName[e.name]}static createObject(t,e,i){let s=q.getByName(t);return s?s.createObject(e,i):null}static createObjectFromURL(t,e){let i=q.getItemByURL(t);return i?i.owner.internalCreateObject(i,e):null}static getItemURL(t,e){let i=q.getByName(t);if(!i)return null;let s=i.$itemsByName[e];return s?`ui://${i.id}${s.id}`:null}static getItemByURL(t){let e=t.indexOf("//");if(-1==e)return null;let i,s=t.indexOf("/",e+2);if(-1==s){if(t.length>13){let e=t.substr(5,8);if(i=q.getById(e),null!=i){let e=t.substr(13);return i.getItemById(e)}}}else{let h=t.substr(e+2,s-e-2);if(i=q.getByName(h),null!=i){let e=t.substr(s+1);return i.getItemByName(e)}}return null}static getBitmapFontByURL(t){return q.$bitmapFonts[t]}static setStringsSource(t){q.$stringsSource={},V.tryParse(t).children.forEach(t=>{if("string"==t.nodeName){let e=t.attributes.name,i=e.indexOf("-");if(-1==i)return;let s=t.children.length>0?t.children[0].text:"",h=e.substr(0,i),r=e.substr(i+1),n=q.$stringsSource[h];n||(n={},q.$stringsSource[h]=n),n[r]=s}})}static normalizeURL(t){if(null==t)return null;let e=t.indexOf("//");if(-1==e)return null;let i=t.indexOf("/",e+2);if(-1==i)return t;let s=t.substr(e+2,i-e-2),h=t.substr(i+1);return q.getItemURL(s,h)}create(t){this.$resKey=t;let e=k.resourcesPool[this.$resKey];if(e||(e=k.resourcesPool[this.$resKey+"_fui"]),!e)throw new Error(`Resource '${this.$resKey}' not found, please make sure that you use "new fgui.utils.AssetLoader" to load resources".`);if(!(e&&e instanceof ArrayBuffer))throw new Error(`Resource '${this.$resKey}' is not a proper binary resource, please load it as binary format in manifest file add[{ id, src, type: "binary" }]`);this.loadPackage(e)}loadPackage(t){this.decompressPackage(t);let e=this.getResDescriptor("sprites.bytes");e&&e.split(q.sep1).forEach((t,e)=>{if(e>=1&&t&&t.length){let e,i=t.split(q.sep2),s=i[0],h=parseInt(i[1]);if(h>=0)e="atlas"+h;else{let t=s.indexOf("_");e=-1==t?"atlas_"+s:"atlas_"+s.substr(0,t)}let r=new Y(e);r.frame=new createjs.Rectangle(parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5])),r.rotate="1"==i[6]?6:0,r.orig=0!=r.rotate?new createjs.Rectangle(0,0,r.frame.height,r.frame.width):null,this.$atlasConfigs[s]=r}}),e=this.getResDescriptor("package.xml");let i=V.tryParse(e);this.$id=i.attributes.id,this.$name=i.attributes.name;let s=i.children[0].children;this.$itemsById={},this.$itemsByName={},s.forEach(t=>{let i=new X;if(i.type=c(t.nodeName),i.id=t.attributes.id,i.name=t.attributes.name,i.file=t.attributes.file,e=t.attributes.size,e){let t=e.split(q.sep0);i.width=parseInt(t[0]),i.height=parseInt(t[1])}switch(i.type){case 0:if(e=t.attributes.scale,"9grid"==e){if(e=t.attributes.scale9grid,e){let s=e.split(q.sep0),h=new createjs.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]));i.scale9Grid=h,e=t.attributes.gridTile,e&&(i.tiledSlices=parseInt(e))}}else"tile"==e&&(i.scaleByTile=!0)}i.owner=this,this.$items.push(i),this.$itemsById[i.id]=i,null!=i.name&&(this.$itemsByName[i.name]=i)},this),this.$items.forEach(t=>{6==t.type&&(this.loadFont(t),q.$bitmapFonts[t.bitmapFont.id]=t.bitmapFont)},this)}decompressPackage(t){this.$resData={};var e=new Uint8Array(t.slice(0,2));if(80==e[0]&&75==e[1])return void this.decodeUncompressed(t);let i,s,h=new W(t).decompress(),r=j.decodeUTF8(h),n=0;for(;;){let t=r.indexOf("|",n);if(-1==t)break;i=r.substring(n,t),n=t+1,t=r.indexOf("|",n),s=parseInt(r.substring(n,t)),n=t+1,this.$resData[i]=r.substr(n,s),n+=s}}decodeUncompressed(t){var e=new T(t);e.endian=O.LITTLE_ENDIAN;var i=e.length-22;e.position=i+10;var s=e.readUnsignedShort();e.position=i+16,i=e.readInt();for(var h=0;h<s;h++){e.position=i+28;var r=e.readUnsignedShort(),n=e.readUnsignedShort()+e.readUnsignedShort();e.position=i+46;var a=e.readUTFBytes(r);if("/"!=a[a.length-1]&&"\\"!=a[a.length-1]){e.position=i+20;var l=e.readInt();e.position=i+42;var o=e.readInt()+30+r;l>0&&(e.position=o,this.$resData[a]=e.readUTFBytes(l))}i+=46+r+n}}dispose(){this.$items.forEach(t=>{let e=this.$atlasConfigs[t.id];e&&k.destroyResource(`${this.$resKey}@${e.atlasName}`)},this)}get id(){return this.$id}get name(){return this.$name}get customId(){return this.$customId}set customId(t){null!=this.$customId&&delete q.$packageInstById[this.$customId],this.$customId=t,null!=this.$customId&&(q.$packageInstById[this.$customId]=this)}createObject(t,e){let i=this.$itemsByName[t];return i?this.internalCreateObject(i,e):null}internalCreateObject(t,e=null){let i=4==t.type&&null!=e?new e:K.UIObjectFactory.newObject(t);return null==i?null:(q.$constructingObjects++,i.packageItem=t,i.constructFromResource(),q.$constructingObjects--,i)}getItemById(t){return this.$itemsById[t]}getItemByName(t){return this.$itemsByName[t]}getItemAssetByName(t){let e=this.$itemsByName[t];if(null==e)throw new Error(`Resource '${t}' not found`);return this.getItemAsset(e)}createSpriteTexture(t,e){let i=this.$itemsById[e.atlasName];if(null!=i){let t=this.getItemAsset(i);if(!t)return null;e.texCacheID||(e.texCacheID=`${this.$resKey}@${e.atlasName}`);let s=G.TextureCache[e.texCacheID];return s||(s={image:t,rect:e.frame}),s}return null}getItemAsset(t){switch(t.type){case 0:if(!t.decoded){t.decoded=!0;let e=this.$atlasConfigs[t.id];null!=e&&(t.texture=this.createSpriteTexture(t.id,e))}return t.texture;case 7:if(!t.decoded){t.decoded=!0;let e=null!=t.file&&t.file.length>0?t.file:t.id+".png",i=`${this.$resKey}@${H.getFileName(e)}`,s=k.resourcesPool[i];if(!s)throw new Error(i+" not found in fgui.AssetLoader.resourcesPool, please load assets first!");t.texture=s,t.texture||(s=k.resourcesPool[`${this.$resKey}@${e.replace(".","_")}`],t.texture=s)}return t.texture;case 3:return t.decoded||(t.decoded=!0,this.loadAudio(t)),t.sound;case 6:return t.decoded||(t.decoded=!0,this.loadFont(t)),t.bitmapFont;case 2:return t.decoded||(t.decoded=!0,this.loadMovieClip(t)),t.frames;case 4:if(!t.decoded){t.decoded=!0;let e=this.getResDescriptor(t.id+".xml"),i=V.tryParse(e);t.componentData=i,this.loadComponentChildren(t),this.loadComponentTranslation(t)}return t.componentData;default:return k.resourcesPool[`${this.$resKey}@${t.id}`]}}loadComponentChildren(t){let e=V.getChildNodes(t.componentData,"displayList");null!=e&&e.length>0?(t.displayList=[],e[0].children.forEach(e=>{let i,s=e.nodeName,h=e.attributes.src;if(h){let r,n=e.attributes.pkg;r=n&&n!=t.owner.id?q.getById(n):t.owner;let a=null!=r?r.getItemById(h):null;i=null!=a?new U(a,null):new U(null,s)}else i="text"==s&&"true"==e.attributes.input?new U(null,"inputtext"):new U(null,s);i.desc=e,t.displayList.push(i)})):t.displayList=[]}getResDescriptor(t){return this.$resData[t]}loadComponentTranslation(t){if(null==q.$stringsSource)return;let e,i,s,h,r,n,a=q.$stringsSource[this.id+t.id];null!=a&&t.displayList.forEach(t=>{i=t.desc,h=i.nodeName,r=i.attributes.id,n=i.attributes.tooltips,n&&(e=a[r+"-tips"],null!=e&&(i.attributes.tooltips=e));let l=V.getChildNodes(i,"gearText");if(s=l&&l[0],s&&(e=a[r+"-texts"],null!=e&&(s.attributes.values=e),e=a[r+"-texts_def"],null!=e&&(s.attributes.default=e)),"text"==h||"richtext"==h)e=a[r],null!=e&&(i.attributes.text=e),e=a[r+"-prompt"],null!=e&&(i.attributes.prompt=e);else if("list"==h)i.children.forEach((t,i)=>{"item"==t.nodeName&&(e=a[`${r}-${i}`],null!=e&&(t.attributes.title=e))});else if("component"==h){if(l=V.getChildNodes(i,"Button"),s=l&&l[0],s)return e=a[r],null!=e&&(s.attributes.title=e),e=a[r+"-0"],void(null!=e&&(s.attributes.selectedTitle=e));if(l=V.getChildNodes(i,"Label"),s=l&&l[0],s)return e=a[r],void(null!=e&&(s.attributes.title=e));if(l=V.getChildNodes(i,"ComboBox"),s=l&&l[0],s)return e=a[r],null!=e&&(s.attributes.title=e),void s.children.forEach((t,i)=>{"item"==t.nodeName&&(e=a[`${r}-${i}`],null!=e&&(t.attributes.title=e))})}})}loadMovieClip(t){let e,i=V.tryParse(this.getResDescriptor(t.id+".xml"));e=i.attributes.interval,null!=e&&(t.interval=parseInt(e)),e=i.attributes.swing,null!=e&&(t.swing="true"==e),e=i.attributes.repeatDelay,null!=e&&(t.repeatDelay=parseInt(e)),t.frames=[],i.children[0].children.forEach((i,s)=>{let h=new E;e=i.attributes.rect;let r=e.split(q.sep0),n=new createjs.Rectangle(parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3]));if(e=i.attributes.addDelay,e&&(h.addDelay=parseInt(e)),t.frames.push(h),n.width<=0)return;e=i.attributes.sprite,e=e?`${t.id}_${e}`:`${t.id}_${s}`;let a=this.$atlasConfigs[e];null!=a&&(h.texture=this.createSpriteTexture(e,a),h.texture.trim=n)})}loadFont(t){let e=new P;e.id=`ui://${this.id}${t.id}`;let i,s,h=this.getResDescriptor(t.id+".fnt"),r=h.split(q.sep1),n={},a=!1,l=0,o=0,$=!1,c=!1,d=0,u=0,p=0,g=0;r.forEach(r=>{if(r&&r.length){h=H.trim(r);let f=h.split(q.sep2);if(f.forEach(t=>{let e=t.split(q.sep3);n[e[0]]=e[1]}),h=f[0],"char"==h){let t=new I;t.x=parseInt(n.x)||0,t.y=parseInt(n.y)||0,t.offsetX=parseInt(n.xoffset)||0,t.offsetY=parseInt(n.yoffset)||0,t.width=parseInt(n.width)||0,t.height=parseInt(n.height)||0,g=Math.max(t.height,g),t.advance=parseInt(n.xadvance)||0,null!=n.chnl&&(t.channel=parseInt(n.chnl),15==t.channel?t.channel=4:1==t.channel?t.channel=3:2==t.channel?t.channel=2:t.channel=1),a?null!=s&&(t.texture||(t.texture={image:s,rect:{}}),t.texture.rect=new createjs.Rectangle(t.x+d,t.y+u,t.width,t.height)):n.img&&(i=this.$itemsById[n.img],null!=i&&(i.load(),t.width=i.width,t.height=i.height,t.texture=i.texture)),a?t.lineHeight=p:(0==t.advance&&(t.advance=0==o?t.offsetX+t.width:o),t.lineHeight=t.offsetY<0?t.height:t.offsetY+t.height,l>0&&t.lineHeight<l&&(t.lineHeight=l)),e.glyphs[String.fromCharCode(0|+n.id)]=t}else if("info"==h){if(a=null!=n.face,n.size&&(l=parseInt(n.size)),$="true"==n.resizable,c="true"==n.colored,a){let e=this.$atlasConfigs[t.id];if(null!=e){d=e.frame.x,u=e.frame.y;let t=this.$itemsById[e.atlasName];null!=t&&(s=this.getItemAsset(t))}}}else"common"==h&&(n.lineHeight&&(p=parseInt(n.lineHeight)),0==l?l=p:0==p&&(p=l),n.xadvance&&(o=parseInt(n.xadvance)))}}),0==l&&g>0&&(l=g),e.ttf=a,e.size=l,e.resizable=$,e.colorable=c,t.bitmapFont=e}loadAudio(t){let e=null!=t.file&&t.file.length>0?t.file:t.id+".mp3",i=`${this.$resKey}@${H.getFileName(e)}`;k.resourcesPool[i]?t.sound=createjs.Sound.play(i):console.log("Resource '"+t.file+"' not found, please loadManifest first!")}}q.$constructingObjects=0,q.$packageInstById={},q.$packageInstByName={},q.$bitmapFonts={},q.$stringsSource=null,q.sep0=",",q.sep1="\n",q.sep2=" ",q.sep3="=";let K={};class Q extends v{constructor(t){super(t)}init(){this.$default=new J(this.$owner.alpha,this.$owner.rotation,this.$owner.grayed),this.$storage={}}addStatus(t,e){if("-"==e)return;let i,s=e.split(",");null==t?i=this.$default:(i=new J,this.$storage[t]=i),i.alpha=parseFloat(s[0]),i.rotation=parseInt(s[1]),i.grayed="1"==s[2]}apply(){let t=this.$storage[this.$controller.selectedPageId];if(t||(t=this.$default),!this.$tween||q.$constructingObjects||v.disableAllTweenEffect)this.$owner.$gearLocked=!0,this.$owner.grayed=t.grayed,this.$owner.alpha=t.alpha,this.$owner.rotation=t.rotation,this.$owner.$gearLocked=!1;else{if(this.$owner.$gearLocked=!0,this.$owner.grayed=t.grayed,this.$owner.$gearLocked=!1,this.$tweener){if(this.$tweenTarget.alpha===t.alpha&&this.$tweenTarget.rotation===t.rotation)return;this.$tweener.gotoAndStop(this.$tweener.duration),this.$tweener=null}let e=t.alpha!=this.$owner.alpha,i=t.rotation!=this.$owner.rotation;if(e||i){this.$owner.hasGearController(0,this.$controller)&&(this.$lockToken=this.$owner.lockGearDisplay()),this.$tweenTarget=t;let s={onChange:()=>{this.$owner.$gearLocked=!0,e&&(this.$owner.alpha=this.$tweenValue.x),i&&(this.$owner.rotation=this.$tweenValue.y),this.$owner.$gearLocked=!1}};null==this.$tweenValue&&(this.$tweenValue=new createjs.Point),this.$tweenValue.x=this.$owner.alpha,this.$tweenValue.y=this.$owner.rotation,this.$tweener=createjs.Tween.get(this.$tweenValue,s).wait(1e3*this.$tweenDelay).to({x:t.alpha,y:t.rotation},1e3*this.$tweenTime,this.$easeType).call(this.tweenComplete,null,this)}}}tweenComplete(){0!=this.$lockToken&&(this.$owner.releaseGearDisplay(this.$lockToken),this.$lockToken=0),this.$tweener=null;let t=new createjs.Event("__gearStop",!0,!1);this.$owner.dispatchEvent(t,this)}updateState(){if(null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding)return;let t=this.$storage[this.$controller.selectedPageId];t||(t=new J,this.$storage[this.$controller.selectedPageId]=t),t.alpha=this.$owner.alpha,t.rotation=this.$owner.rotation,t.grayed=this.$owner.grayed}}class J{constructor(t=0,e=0,i=!1){this.alpha=t,this.rotation=e,this.grayed=i}}class Z extends v{constructor(t){super(t)}init(){this.$default=new tt(this.$owner.width,this.$owner.height,this.$owner.scaleX,this.$owner.scaleY),this.$storage={}}addStatus(t,e){if("-"==e)return;let i,s=e.split(",");null==t?i=this.$default:(i=new tt,this.$storage[t]=i),i.width=parseInt(s[0]),i.height=parseInt(s[1]),s.length>2&&(i.scaleX=parseFloat(s[2]),i.scaleY=parseFloat(s[3]))}apply(){let t=this.$storage[this.$controller.selectedPageId];if(t||(t=this.$default),!this.$tween||q.$constructingObjects||v.disableAllTweenEffect)this.$owner.$gearLocked=!0,this.$owner.setSize(t.width,t.height,this.$owner.gearXY.controller==this.$controller),this.$owner.setScale(t.scaleX,t.scaleY),this.$owner.$gearLocked=!1;else{if(this.$tweener){if(this.$tweenTarget.width==t.width&&this.$tweenTarget.height==t.height&&this.$tweenTarget.scaleX==t.scaleX&&this.$tweenTarget.scaleY==t.scaleY)return;this.$tweener.gotoAndStop(this.$tweener.duration),this.$tweener=null}let e=t.width!=this.$owner.width||t.height!=this.$owner.height,i=t.scaleX!=this.$owner.scaleX||t.scaleY!=this.$owner.scaleY;if(e||i){this.$owner.hasGearController(0,this.$controller)&&(this.$lockToken=this.$owner.lockGearDisplay()),this.$tweenTarget=t;let s={onChange:()=>{this.$owner.$gearLocked=!0,e&&this.$owner.setSize(this.$tweenValue.width,this.$tweenValue.height,this.$owner.gearXY.controller==this.$controller),i&&this.$owner.setScale(this.$tweenValue.scaleX,this.$tweenValue.scaleY),this.$owner.$gearLocked=!1}};null==this.$tweenValue&&(this.$tweenValue=new tt),this.$tweenValue.width=this.$owner.width,this.$tweenValue.height=this.$owner.height,this.$tweenValue.scaleX=this.$owner.scaleX,this.$tweenValue.scaleY=this.$owner.scaleY,this.$tweener=createjs.Tween.get(this.$tweenValue,s).wait(1e3*this.$tweenDelay).to({width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY},1e3*this.$tweenTime,this.$easeType).call(this.tweenComplete,null,this)}}}tweenComplete(){0!=this.$lockToken&&(this.$owner.releaseGearDisplay(this.$lockToken),this.$lockToken=0),this.$tweener=null;let t=new createjs.Event("__gearStop",!0,!1);this.$owner.dispatchEvent(t,this)}updateState(){if(null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding)return;let t=this.$storage[this.$controller.selectedPageId];t||(t=new tt,this.$storage[this.$controller.selectedPageId]=t),t.width=this.$owner.width,t.height=this.$owner.height,t.scaleX=this.$owner.scaleX,t.scaleY=this.$owner.scaleY}updateFromRelations(t,e){if(null!=this.$controller&&null!=this.$storage){for(let i in this.$storage){let s=this.$storage[i];s.width+=t,s.height+=e}this.$default.width+=t,this.$default.height+=e,this.updateState()}}}class tt{constructor(t=0,e=0,i=0,s=0){this.width=t,this.height=e,this.scaleX=i,this.scaleY=s}}class et extends v{constructor(t){super(t)}init(){this.$default=new createjs.Point(this.$owner.x,this.$owner.y),this.$storage={}}addStatus(t,e){if("-"==e)return;let i,s=e.split(",");null==t?i=this.$default:(i=new createjs.Point,this.$storage[t]=i),i.x=parseInt(s[0]),i.y=parseInt(s[1])}apply(){let t=this.$storage[this.$controller.selectedPageId];if(t||(t=this.$default),!this.$tween||q.$constructingObjects||v.disableAllTweenEffect)this.$owner.$gearLocked=!0,this.$owner.setXY(t.x,t.y),this.$owner.$gearLocked=!1;else{if(this.$tweener){if(this.$tweenTarget.x===t.x&&this.$tweenTarget.y===t.y)return;this.$tweener.gotoAndStop(this.$tweener.duration),this.$tweener=null}if(this.$owner.x!=t.x||this.$owner.y!=t.y){this.$owner.hasGearController(0,this.$controller),this.$lockToken=this.$owner.lockGearDisplay(),this.$tweenTarget=t;let e={onChange:()=>{this.$owner.$gearLocked=!0,this.$owner.setXY(this.$tweenValue.x,this.$tweenValue.y),this.$owner.$gearLocked=!1}};null==this.$tweenValue&&(this.$tweenValue=new createjs.Point),this.$tweenValue.x=this.$owner.x,this.$tweenValue.y=this.$owner.y,this.$tweener=createjs.Tween.get(this.$tweenValue,e).wait(1e3*this.$tweenDelay).to({x:t.x,y:t.y},1e3*this.$tweenTime,this.$easeType).call(this.tweenComplete,null,this)}}}tweenComplete(){0!=this.$lockToken&&(this.$owner.releaseGearDisplay(this.$lockToken),this.$lockToken=0),this.$tweener=null;let t=new createjs.Event("__gearStop",!0,!1);this.$owner.dispatchEvent(t,this)}updateState(){if(null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding)return;let t=this.$storage[this.$controller.selectedPageId];t||(t=new createjs.Point,this.$storage[this.$controller.selectedPageId]=t),t.x=this.$owner.x,t.y=this.$owner.y}updateFromRelations(t,e){if(null!=this.$controller&&null!=this.$storage){for(let i in this.$storage){let s=this.$storage[i];s.x+=t,s.y+=e}this.$default.x+=t,this.$default.y+=e,this.updateState()}}}let it=function(t){return t&&"UIOwner"in t&&null!=t.UIOwner};class st{copyFrom(t){this.percent=t.percent,this.type=t.type}}class ht{constructor(t){this.$owner=t,this.$defs=[]}get owner(){return this.$owner}set target(t){this.$target!=t&&(this.$target&&this.releaseRefTarget(this.$target),this.$target=t,this.$target&&this.addRefTarget(this.$target))}get target(){return this.$target}add(t,e){if(24==t)return this.add(14,e),void this.add(15,e);let i=this.$defs.length;for(let e=0;e<i;e++){if(this.$defs[e].type==t)return}this.internalAdd(t,e)}internalAdd(t,e){if(24==t)return this.internalAdd(14,e),void this.internalAdd(15,e);let i=new st;i.percent=e,i.type=t,this.$defs.push(i),(e||1==t||3==t||5==t||8==t||10==t||12==t)&&(this.$owner.pixelSnapping=!0)}remove(t=0){if(24==t)return this.remove(14),void this.remove(15);for(let e=this.$defs.length-1;e>=0;e--)if(this.$defs[e].type==t){this.$defs.splice(e,1);break}}copyFrom(t){this.target=t.target,this.$defs.length=0,t.$defs.forEach(t=>{let e=new st;e.copyFrom(t),this.$defs.push(e)},this)}dispose(){null!=this.$target&&(this.releaseRefTarget(this.$target),this.$target=null)}get isEmpty(){return 0==this.$defs.length}applyOnSelfResized(t,e){let i=this.$owner.x,s=this.$owner.y;this.$defs.forEach(i=>{switch(i.type){case 3:case 5:this.$owner.x-=t/2;break;case 4:case 6:this.$owner.x-=t;break;case 10:case 12:this.$owner.y-=e/2;break;case 11:case 13:this.$owner.y-=e}},this),i==this.$owner.x&&s==this.$owner.y||(i=this.$owner.x-i,s=this.$owner.y-s,this.$owner.updateGearFromRelations(1,i,s),null!=this.$owner.parent&&this.$owner.parent.$transitions.length>0&&this.$owner.parent.$transitions.forEach(t=>{t.updateFromRelations(this.$owner.id,i,s)},this))}applyOnXYChanged(t,e,i){let s;switch(t.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:this.$owner.x+=e;break;case 7:case 8:case 9:case 10:case 11:case 12:case 13:this.$owner.y+=i;break;case 14:case 15:break;case 16:case 17:s=this.$owner.x,this.$owner.x+=e,this.$owner.width=this.$owner.$rawWidth-(this.$owner.x-s);break;case 18:case 19:this.$owner.width=this.$owner.$rawWidth+e;break;case 20:case 21:s=this.$owner.y,this.$owner.y+=i,this.$owner.height=this.$owner.$rawHeight-(this.$owner.y-s);break;case 22:case 23:this.$owner.height=this.$owner.$rawHeight+i}}applyOnSizeChanged(t){let e,i,s,h;switch(this.$target!=this.$owner.parent?(e=this.$target.x,i=this.$target.y):(e=0,i=0),t.type){case 0:break;case 1:s=this.$owner.x-(e+this.$targetWidth/2),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner.x=e+this.$target.$rawWidth/2+s;break;case 2:s=this.$owner.x-(e+this.$targetWidth),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner.x=e+this.$target.$rawWidth+s;break;case 3:s=this.$owner.x+this.$owner.$rawWidth/2-(e+this.$targetWidth/2),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner.x=e+this.$target.$rawWidth/2+s-this.$owner.$rawWidth/2;break;case 4:s=this.$owner.x+this.$owner.$rawWidth-e,t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner.x=e+s-this.$owner.$rawWidth;break;case 5:s=this.$owner.x+this.$owner.$rawWidth-(e+this.$targetWidth/2),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner.x=e+this.$target.$rawWidth/2+s-this.$owner.$rawWidth;break;case 6:s=this.$owner.x+this.$owner.$rawWidth-(e+this.$targetWidth),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner.x=e+this.$target.$rawWidth+s-this.$owner.$rawWidth;break;case 7:break;case 8:s=this.$owner.y-(i+this.$targetHeight/2),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner.y=i+this.$target.$rawHeight/2+s;break;case 9:s=this.$owner.y-(i+this.$targetHeight),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner.y=i+this.$target.$rawHeight+s;break;case 10:s=this.$owner.y+this.$owner.$rawHeight/2-(i+this.$targetHeight/2),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner.y=i+this.$target.$rawHeight/2+s-this.$owner.$rawHeight/2;break;case 11:s=this.$owner.y+this.$owner.$rawHeight-i,t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner.y=i+s-this.$owner.$rawHeight;break;case 12:s=this.$owner.y+this.$owner.$rawHeight-(i+this.$targetHeight/2),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner.y=i+this.$target.$rawHeight/2+s-this.$owner.$rawHeight;break;case 13:s=this.$owner.y+this.$owner.$rawHeight-(i+this.$targetHeight),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner.y=i+this.$target.$rawHeight+s-this.$owner.$rawHeight;break;case 14:s=this.$owner.$inProgressBuilding&&this.$owner==this.$target.parent?this.$owner.sourceWidth-this.$target.$initWidth:this.$owner.$rawWidth-this.$targetWidth,t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$target==this.$owner.parent?this.$owner.setSize(this.$target.$rawWidth+s,this.$owner.$rawHeight,!0):this.$owner.width=this.$target.$rawWidth+s;break;case 15:s=this.$owner.$inProgressBuilding&&this.$owner==this.$target.parent?this.$owner.sourceHeight-this.$target.$initHeight:this.$owner.$rawHeight-this.$targetHeight,t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$target==this.$owner.parent?this.$owner.setSize(this.$owner.$rawWidth,this.$target.$rawHeight+s,!0):this.$owner.height=this.$target.$rawHeight+s;break;case 16:break;case 17:s=this.$owner.x-(e+this.$targetWidth),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),h=this.$owner.x,this.$owner.x=e+this.$target.$rawWidth+s,this.$owner.width=this.$owner.$rawWidth-(this.$owner.x-h);break;case 18:break;case 19:s=this.$owner.$inProgressBuilding&&this.$owner==this.$target.parent?this.$owner.sourceWidth-(e+this.$target.$initWidth):this.$owner.width-(e+this.$targetWidth),this.$owner!=this.$target.parent&&(s+=this.$owner.x),t.percent&&(s=s/this.$targetWidth*this.$target.$rawWidth),this.$owner!=this.$target.parent?this.$owner.width=e+this.$target.$rawWidth+s-this.$owner.x:this.$owner.width=e+this.$target.$rawWidth+s;break;case 20:break;case 21:s=this.$owner.y-(i+this.$targetHeight),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),h=this.$owner.y,this.$owner.y=i+this.$target.$rawHeight+s,this.$owner.height=this.$owner.$rawHeight-(this.$owner.y-h);break;case 22:break;case 23:s=this.$owner.$inProgressBuilding&&this.$owner==this.$target.parent?this.$owner.sourceHeight-(i+this.$target.$initHeight):this.$owner.$rawHeight-(i+this.$targetHeight),this.$owner!=this.$target.parent&&(s+=this.$owner.y),t.percent&&(s=s/this.$targetHeight*this.$target.$rawHeight),this.$owner!=this.$target.parent?this.$owner.height=i+this.$target.$rawHeight+s-this.$owner.y:this.$owner.height=i+this.$target.$rawHeight+s}}addRefTarget(t){t!=this.$owner.parent&&t.on("__xyChanged",this.$targetXYChanged,this),t.on("__sizeChanged",this.$targetSizeChanged,this),t.on("__sizeDelayChange",this.$targetSizeWillChange,this),this.$targetX=this.$target.x,this.$targetY=this.$target.y,this.$targetWidth=this.$target.$rawWidth,this.$targetHeight=this.$target.$rawHeight}releaseRefTarget(t){t.off("__xyChanged",this.$targetXYChanged),t.off("__sizeChanged",this.$targetSizeChanged),t.off("__sizeDelayChange",this.$targetSizeWillChange)}$targetXYChanged(t){if(null!=this.$owner.relations.$dealing||null!=this.$owner.group&&this.$owner.group.$updating)return this.$targetX=this.$target.x,void(this.$targetY=this.$target.y);this.$owner.relations.$dealing=this.$target;let e=this.$owner.x,i=this.$owner.y,s=this.$target.x-this.$targetX,h=this.$target.y-this.$targetY;this.$defs.forEach(t=>{this.applyOnXYChanged(t,s,h)},this),this.$targetX=this.$target.x,this.$targetY=this.$target.y,e==this.$owner.x&&i==this.$owner.y||(e=this.$owner.x-e,i=this.$owner.y-i,this.$owner.updateGearFromRelations(1,e,i),null!=this.$owner.parent&&this.$owner.parent.$transitions.length>0&&this.$owner.parent.$transitions.forEach(t=>{t.updateFromRelations(this.$owner.id,e,i)},this)),this.$owner.relations.$dealing=null}$targetSizeChanged(t){if(null!=this.$owner.relations.$dealing)return;this.$owner.relations.$dealing=this.$target;let e=this.$owner.x,i=this.$owner.y,s=this.$owner.$rawWidth,h=this.$owner.$rawHeight;this.$defs.forEach(t=>{this.applyOnSizeChanged(t)},this),this.$targetWidth=this.$target.$rawWidth,this.$targetHeight=this.$target.$rawHeight,e==this.$owner.x&&i==this.$owner.y||(e=this.$owner.x-e,i=this.$owner.y-i,this.$owner.updateGearFromRelations(1,e,i),null!=this.$owner.parent&&this.$owner.parent.$transitions.length>0&&this.$owner.parent.$transitions.forEach(t=>{t.updateFromRelations(this.$owner.id,e,i)},this)),s==this.$owner.$rawWidth&&h==this.$owner.$rawHeight||(s=this.$owner.$rawWidth-s,h=this.$owner.$rawHeight-h,this.$owner.updateGearFromRelations(2,s,h)),this.$owner.relations.$dealing=null}$targetSizeWillChange(t){this.$owner.relations.sizeDirty=!0}}class rt{constructor(t){this.sizeDirty=!1,this.$owner=t,this.$items=[]}add(t,e,i=!1){let s=this.$items.length;for(let h=0;h<s;h++){let s=this.$items[h];if(s.target==t)return void s.add(e,i)}let h=new ht(this.$owner);h.target=t,h.add(e,i),this.$items.push(h)}addItems(t,e){let i,s,h=e.split(",");for(let e=0;e<2;e++){if(i=h[e],!i)continue;"%"==i.charAt(i.length-1)?(i=i.substr(0,i.length-1),s=!0):s=!1,-1==i.indexOf("-")&&(i=`${i}-${i}`);let r=rt.RELATION_NAMES.indexOf(i);if(-1==r)throw new Error("Invalid relation type");this.add(t,r,s)}}remove(t,e=0){let i=this.$items.length,s=0;for(;s<i;){let h=this.$items[s];h.target==t?(h.remove(e),h.isEmpty?(h.dispose(),this.$items.splice(s,1),i--):s++):s++}}contains(t){let e=this.$items.length;for(let i=0;i<e;i++)if(this.$items[i].target==t)return!0;return!1}clearFor(t){let e=this.$items.length,i=0;for(;i<e;){let s=this.$items[i];s.target==t?(s.dispose(),this.$items.splice(i,1),e--):i++}}clearAll(){this.$items.forEach(t=>{t.dispose()},this),this.$items.length=0}copyFrom(t){this.clearAll(),t.$items.forEach(t=>{let e=new ht(this.$owner);e.copyFrom(t),this.$items.push(e)},this)}dispose(){this.clearAll()}onOwnerSizeChanged(t,e){this.$items.length<=0||this.$items.forEach(i=>{i.applyOnSelfResized(t,e)},this)}ensureRelationsSizeCorrect(){0!=this.$items.length&&(this.sizeDirty=!1,this.$items.forEach(t=>{t.target.ensureSizeCorrect()},this))}get empty(){return 0==this.$items.length}setup(t){t.children.forEach(t=>{if("relation"!=t.nodeName)return;let e,i;e=t.attributes.target,i=this.$owner.parent?e?this.$owner.parent.getChildById(e):this.$owner.parent:this.$owner.getChildById(e),i&&this.addItems(i,t.attributes.sidePair)},this)}}rt.RELATION_NAMES=["left-left","left-center","left-right","center-center","right-left","right-center","right-right","top-top","top-middle","top-bottom","middle-middle","bottom-top","bottom-middle","bottom-bottom","width-width","height-height","leftext-left","leftext-right","rightext-left","rightext-right","topext-top","topext-bottom","bottomext-top","bottomext-bottom"];let nt=function(t){return t&&"color"in t};class at extends v{constructor(t){super(t),this.$default="#ffffff"}init(){this.$default=this.$owner.color,this.$storage={}}addStatus(t,e){if("-"==e)return;let i=e;null==t?this.$default=i:this.$storage[t]=i}apply(){this.$owner.$gearLocked=!0;let t=this.$storage[this.$controller.selectedPageId];this.$owner.color=null!=t?H.HEX2RGB(t):H.HEX2RGB(this.$default),this.$owner.$gearLocked=!1}updateState(){null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding||(this.$storage[this.$controller.selectedPageId]=this.$owner.color)}}let lt=function(t){return t&&"playing"in t&&"frame"in t};class ot extends v{constructor(t){super(t)}init(){this.$default=new $t(this.$owner.playing,this.$owner.frame),this.$storage={}}addStatus(t,e){if("-"==e)return;let i;null==t?i=this.$default:(i=new $t,this.$storage[t]=i);let s=e.split(",");i.frame=parseInt(s[0]),i.playing="p"==s[1]}apply(){this.$owner.$gearLocked=!0;let t=this.$storage[this.$controller.selectedPageId];t||(t=this.$default),this.$owner.frame=t.frame,this.$owner.playing=t.playing,this.$owner.$gearLocked=!1}updateState(){if(null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding)return;let t=this.$storage[this.$controller.selectedPageId];t||(t=new $t,this.$storage[this.$controller.selectedPageId]=t),t.frame=this.$owner.frame,t.playing=this.$owner.playing}}class $t{constructor(t=!0,e=0){this.playing=t,this.frame=e}}class ct extends createjs.DisplayObject{constructor(){super(),this.$tint="#fff",this.$isTrim=!1}get tint(){return this.$tint}set tint(t){this.$tint=t;let e=t.split(",");this.filters=[new createjs.ColorFilter(+e[0]/255,+e[1]/255,+e[2]/255,1,0,0,0,1)]}set sourceRect(t){this.$sourceRect=t}get sourceRect(){return this.$sourceRect}set textureRect(t){this.$textureRect=t}get textureRect(){return this.$textureRect}isVisible(){var t=this.cacheCanvas||this.texture&&(this.texture.naturalWidth||this.texture.getContext||this.texture.readyState>=2);return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)}getBounds(){var t=super.getBounds();if(t)return t;var e=this.texture,i=this.sourceRect||e;return e&&(e.naturalWidth||e.getContext||e.readyState>=2)?this.sourceRect.setValues(0,0,i.width,i.height):null}destroy(){}}ct.$cachedTexturePool={};class dt extends v{constructor(t){super(t)}init(){this.$default=this.$owner.icon,this.$storage={}}addStatus(t,e){null==t?this.$default=e:this.$storage[t]=e}apply(){this.$owner.$gearLocked=!0;let t=this.$storage[this.$controller.selectedPageId];this.$owner.icon=null!=t?t:this.$default,this.$owner.$gearLocked=!1}updateState(){null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding||(this.$storage[this.$controller.selectedPageId]=this.$owner.icon)}}class ut extends v{constructor(t){super(t)}init(){this.$default=this.$owner.text,this.$storage={}}addStatus(t,e){null==t?this.$default=e:this.$storage[t]=e}apply(){this.$owner.$gearLocked=!0;let t=this.$storage[this.$controller.selectedPageId];this.$owner.text=null!=t?t:this.$default,this.$owner.$gearLocked=!1}updateState(){null==this.$controller||this.$owner.$gearLocked||this.$owner.$inProgressBuilding||(this.$storage[this.$controller.selectedPageId]=this.$owner.text)}}class pt extends createjs.EventDispatcher{constructor(){super(),this.$x=0,this.$y=0,this.$width=0,this.$height=0,this.$alpha=1,this.$rotation=0,this.$visible=!0,this.$touchable=!0,this.$grayed=!1,this.$draggable=!1,this.$scaleX=1,this.$scaleY=1,this.$skewX=0,this.$skewY=0,this.$pivot=new createjs.Point,this.$pivotAsAnchor=!1,this.$pivotOffset=new createjs.Point,this.$sortingOrder=0,this.$internalVisible=!0,this.$focusable=!1,this.$pixelSnapping=!1,this.$handlingController=!1,this.$lastColorComponents=null,this.$displayEventMap={},this.$rawWidth=0,this.$rawHeight=0,this.$initWidth=0,this.$initHeight=0,this.$sourceWidth=0,this.$sourceHeight=0,this.$id=""+pt.gInstanceCounter++,this.$name="",this.createDisplayObject(),this.$relations=new rt(this),this.$gears=[],this.$touchable=!0}get id(){return this.$id}get name(){return this.$name}set name(t){this.$name=t}get x(){return this.$x}set x(t){this.setXY(t,this.$y)}get y(){return this.$y}set y(t){this.setXY(this.$x,t)}setXY(t,e){if(this.$x!=t||this.$y!=e){if(this.$x=t,this.$y=e,this.handleXYChanged(),this.updateGear(1),this.$parent){this.$parent.setBoundsChangedFlag();let t=new createjs.Event("__xyChanged",!0,!1);this.$displayObject.dispatchEvent(t,this)}pt.draggingObject!=this||pt.sUpdatingWhileDragging||this.localToGlobalRect(0,0,this.width,this.height,pt.sGlobalRect)}}get pixelSnapping(){return this.$pixelSnapping}set pixelSnapping(t){this.$pixelSnapping!=t&&(this.$pixelSnapping=t,this.handleXYChanged())}center(t=!1){let e;e=null!=this.$parent?this.parent:gt.GRoot.inst,this.setXY((e.width-this.width)/2,(e.height-this.height)/2),t&&(this.addRelation(e,3),this.addRelation(e,10))}get width(){return this.ensureSizeCorrect(),this.$relations.sizeDirty&&this.$relations.ensureRelationsSizeCorrect(),this.$width}set width(t){this.setSize(t,this.$rawHeight)}get height(){return this.ensureSizeCorrect(),this.$relations.sizeDirty&&this.$relations.ensureRelationsSizeCorrect(),this.$height}set height(t){this.setSize(this.$rawWidth,t)}setSize(t,e,i=!1){if(this.$rawWidth!=t||this.$rawHeight!=e){this.$rawWidth=t,this.$rawHeight=e,t=Math.max(0,t),e=Math.max(0,e);let s=t-this.mapPivotWidth(1),h=e-this.mapPivotHeight(1);this.$width=t,this.$height=e,this.handleSizeChanged(),0==this.$pivot.x&&0==this.$pivot.y||(this.$pivotAsAnchor?this.applyPivot():(i||this.setXY(this.x-this.$pivot.x*s,this.y-this.$pivot.y*h),this.updatePivotOffset())),this.updateGear(2),this.$parent&&(this.$relations.onOwnerSizeChanged(s,h),this.$parent.setBoundsChangedFlag());let r=new createjs.Event("__sizeChanged",!0,!1);this.$displayObject.dispatchEvent(r,this)}}ensureSizeCorrect(){}get sourceHeight(){return this.$sourceHeight}get sourceWidth(){return this.$sourceWidth}get initHeight(){return this.$initHeight}get initWidth(){return this.$initWidth}get actualWidth(){return this.width*Math.abs(this.$scaleX)}get actualHeight(){return this.height*Math.abs(this.$scaleY)}get scaleX(){return this.$scaleX}set scaleX(t){this.setScale(t,this.$scaleY)}get scaleY(){return this.$scaleY}set scaleY(t){this.setScale(this.$scaleX,t)}setScale(t,e){this.$scaleX==t&&this.$scaleY==e||(this.$scaleX=t,this.$scaleY=e,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))}get skewX(){return this.$skewX}set skewX(t){this.setSkew(t,this.$skewY)}get skewY(){return this.$skewY}set skewY(t){this.setSkew(this.$skewX,t)}setSkew(t,e){this.$skewX==t&&this.$skewY==e||(this.$skewX=t,this.$skewY=e,this.$displayObject.skewX=t,this.$displayObject.skewY=e,this.applyPivot())}mapPivotWidth(t){return t*this.$width}mapPivotHeight(t){return t*this.$height}get pivotX(){return this.$pivot.x}get pivotY(){return this.$pivot.y}set pivotX(t){this.setPivot(t,this.pivotY)}set pivotY(t){this.setPivot(this.pivotX,t)}setPivot(t,e,i=!1){this.$pivot.x==t&&this.$pivot.y==e&&this.$pivotAsAnchor==i||(this.$pivot.setValues(t,e),this.$pivotAsAnchor=i,this.updatePivotOffset(),this.handleXYChanged())}internalSetPivot(t,e,i){this.$pivot.setValues(t,e),this.$pivotAsAnchor=i,i&&this.handleXYChanged()}updatePivotOffset(){let t=this.$displayObject.getMatrix();if(0!=this.$pivot.x||0!=this.$pivot.y&&t){let e=this.mapPivotWidth(this.$pivot.x),i=this.mapPivotHeight(this.$pivot.y);pt.sHelperPoint.setValues(e,i);let s=t.transformPoint(pt.sHelperPoint.x,pt.sHelperPoint.y);s.x-=t.tx,s.y-=t.ty;let h=this.$pivot.x*this.$width-s.x,r=this.$pivot.y*this.$height-s.y;this.$pivotOffset.setValues(h,r)}else this.$pivotOffset.setValues(0,0)}applyPivot(){0==this.$pivot.x&&0==this.$pivot.y||(this.updatePivotOffset(),this.handleXYChanged())}get touchable(){return this.$touchable}set touchable(t){this.$touchable=t,this.$touchable?this.$displayObject.mouseEnabled=!0:this.$displayObject.mouseEnabled=!1}get grayed(){return this.$grayed}set grayed(t){this.$grayed!=t&&(this.$grayed=t,this.handleGrayedChanged(),this.updateGear(3))}get enabled(){return!this.$grayed&&this.$touchable}set enabled(t){this.grayed=!t,this.touchable=t}get rotation(){return this.$rotation}set rotation(t){this.$rotation!=t&&(this.$rotation=t,this.$displayObject&&(this.$displayObject.rotation=t),this.applyPivot(),this.updateGear(3))}get normalizeRotation(){let t=this.$rotation%360;return t>180?t-=360:t<-180&&(t+=360),t}get alpha(){return this.$alpha}set alpha(t){this.$alpha!=t&&(this.$alpha=t,this.updateAlpha())}updateAlpha(){this.$displayObject&&(this.$displayObject.alpha=this.$alpha),this.updateGear(3)}get visible(){return this.$visible}set visible(t){if(this.$visible!=t){this.$visible=t,this.$displayObject&&(this.$displayObject.visible=this.$visible),this.$parent&&(this.$parent.childStateChanged(this),this.$parent.setBoundsChangedFlag());let e=new createjs.Event("__visibleChanged",!0,!1);e.data={visible:this.$visible},this.dispatchEvent(e,this)}}set internalVisible(t){t!=this.$internalVisible&&(this.$internalVisible=t,this.$parent&&this.$parent.childStateChanged(this))}get internalVisible(){return this.$internalVisible}get finalVisible(){return this.$visible&&this.$internalVisible&&(!this.$group||this.$group.finalVisible)}get sortingOrder(){return this.$sortingOrder}set sortingOrder(t){if(t<0&&(t=0),this.$sortingOrder!=t){let e=this.$sortingOrder;this.$sortingOrder=t,null!=this.$parent&&this.$parent.childSortingOrderChanged(this,e,this.$sortingOrder)}}get focusable(){return this.$focusable}set focusable(t){this.$focusable=t}get focused(){return gt.GRoot.inst.focus==this}requestFocus(){let t=this;for(;t&&!t.$focusable;)t=t.parent;null!=t&&(gt.GRoot.inst.focus=t)}get tooltips(){return this.$tooltips}set tooltips(t){this.$tooltips=t}get blendMode(){return this.$displayObject&&this.$displayObject instanceof ct?r[this.$displayObject.compositeOperation]||"None":r[0]}set blendMode(t){if(t&&t.length&&this.$displayObject&&this.$displayObject instanceof ct)for(let e=0;e<r.length;e++)if(r[e].toLowerCase()===t.toLowerCase())return void(this.$displayObject.compositeOperation=r[e])}get filters(){return this.$displayObject.filters}set filters(t){this.$displayObject.filters=t}get inContainer(){return null!=this.$displayObject.parent}static isDisplayObjectOnStage(t){if(!t||!t.parent)return!1;let e=t;for(;null!=e;){if(e==gt.GRoot.inst.nativeStage)return!0;e=e.parent}return!1}get onStage(){return pt.isDisplayObjectOnStage(this.$displayObject)}get resourceURL(){return null!=this.packageItem?`ui://${this.packageItem.owner.id}${this.packageItem.id}`:null}set group(t){this.$group=t}get group(){return this.$group}getGear(t){let e=this.$gears[t];if(null==e){switch(t){case 0:e=new C(this);break;case 1:e=new et(this);break;case 2:e=new Z(this);break;case 3:e=new Q(this);break;case 4:if(!nt(this))throw new Error(`Invalid component type to add GearColor feature, please check the component named ${this.$name} in the Editor.`);e=new at(this);break;case 5:if(!lt(this))throw new Error(`Invalid component type to add GearAnimation feature, please check the component named ${this.$name} in the Editor.`);e=new ot(this);break;case 6:e=new ut(this);break;case 7:e=new dt(this);break;default:throw new Error("FGUI: invalid gear type")}this.$gears[t]=e}return e}updateGear(t){null!=this.$gears[t]&&this.$gears[t].updateState()}updateGearFromRelations(t,e,i){null!=this.$gears[t]&&this.$gears[t].updateFromRelations(e,i)}hasGearController(t,e){return this.$gears[t]&&this.$gears[t].controller==e}lockGearDisplay(){let t=this.$gears[0];if(t&&t.controller){let e=t.lock();return this.checkGearVisible(),e}return 0}releaseGearDisplay(t){let e=this.$gears[0];e&&e.controller&&(e.release(t),this.checkGearVisible())}checkGearVisible(){if(this.$handlingController)return;let t=this.$gears[0],e=!t||t.connected;e!=this.$internalVisible&&(this.$internalVisible=e,this.$parent&&this.$parent.childStateChanged(this))}get gearXY(){return this.getGear(1)}get gearSize(){return this.getGear(2)}get gearLook(){return this.getGear(3)}get relations(){return this.$relations}addRelation(t,e,i=!1){this.$relations.add(t,e,i)}removeRelation(t,e=0){this.$relations.remove(t,e)}get displayObject(){return this.$displayObject}createDisplayObject(){}setDisplayObject(t){this.$displayObject=t}get parent(){return this.$parent}set parent(t){this.$parent=t}removeFromParent(){this.$parent&&this.$parent.removeChild(this)}get text(){return null}set text(t){}get icon(){return null}set icon(t){}dispose(){this.removeFromParent(),this.$relations.dispose(),this.removeAllListeners(),this.$mouseMoveEvent=gt.GRoot.inst.nativeStage.off(s.Move,this.$moving),this.$mouseUpEvent=gt.GRoot.inst.nativeStage.off(s.Up,this.$end),this.$mouseMove2Event=gt.GRoot.inst.nativeStage.off(s.Move,this.$moving2),this.$mouseUp2Event=gt.GRoot.inst.nativeStage.off(s.Up,this.$end2)}click(t,e){this.on(s.Click,t,e)}removeClick(t){this.off(s.Click,t)}hasClick(t){return this.hasListener(s.Click)}on(t,e,i,s=!1){if(null==t)return this;let h=this.$displayObject.on(t,e,i,s);return this.$displayEventMap[t]=h,this}off(t,e){this.$displayObject.hasEventListener(t)&&this.$displayObject.off(t,this.$displayEventMap[t])}once(t,e,i){if(null==t)return this;this.on(t,e,i,!0)}hasListener(t){return this.$displayObject.hasEventListener(t)}dispatchEvent(t,...e){return!e||e.length<=0?e=[t]:e.unshift(t),this.$displayObject.dispatchEvent(t,this.$displayObject)}removeAllListeners(t){this.removeAllEventListeners(t)}get draggable(){return this.$draggable}set draggable(t){this.$draggable!=t&&(this.$draggable=t,this.initDrag())}get dragBounds(){return this.$dragBounds}set dragBounds(t){this.$dragBounds=t}startDrag(t=-1){this.onStage&&this.dragBegin()}stopDrag(){this.dragEnd()}get dragging(){return pt.draggingObject==this}localToGlobal(t=0,e=0,i){return this.$pivotAsAnchor&&(t+=this.$pivot.x*this.$width,e+=this.$pivot.y*this.$height),i||(i=pt.sHelperPoint),i.x=t,i.y=e,this.$displayObject.localToGlobal(i.x,i.y)}globalToLocal(t=0,e=0,i){return i||(i=pt.sHelperPoint),i.setValues(t,e),i=this.$displayObject.globalToLocal(i.x,i.y),this.$pivotAsAnchor&&(i.x-=this.$pivot.x*this.$width,i.y-=this.$pivot.y*this.$height),i}localToRoot(t=0,e=0,i){let s=this.localToGlobal(t,e,i);return s.x/=gt.GRoot.inst.contentScaleFactor,s.y/=gt.GRoot.inst.contentScaleFactor,s}rootToLocal(t=0,e=0,i){return t*=gt.GRoot.inst.contentScaleFactor,e*=gt.GRoot.inst.contentScaleFactor,this.globalToLocal(t,e,i)}localToGlobalRect(t=0,e=0,i=0,s=0,h){null==h&&(h=pt.sDragHelperRect);let r=this.localToGlobal(t,e);return h.x=r.x,h.y=r.y,h.width=i,h.height=s,h}globalToLocalRect(t=0,e=0,i=0,s=0,h){null==h&&(h=pt.sDragHelperRect);let r=this.globalToLocal(t,e);return h.x=r.x,h.y=r.y,h.width=i,h.height=s,h}handleControllerChanged(t){this.$handlingController=!0;for(let e=0;e<8;e++){let i=this.$gears[e];null!=i&&i.controller==t&&i.apply()}this.$handlingController=!1,this.checkGearVisible()}switchDisplayObject(t){if(t==this.$displayObject)return;let e=this.$displayObject;if(this.inContainer){let e=this.$displayObject.parent.getChildIndex(this.$displayObject);this.$displayObject.parent.addChildAt(t,e),this.$displayObject.parent.removeChild(this.$displayObject)}this.$displayObject=t,this.$displayObject.x=e.x,this.$displayObject.y=e.y,this.$displayObject.rotation=e.rotation,this.$displayObject.alpha=e.alpha,this.$displayObject.visible=e.visible,this.$displayObject.scaleX=e.scaleX,this.$displayObject.scaleY=e.scaleY,this.$displayObject.mouseEnabled=e.mouseEnabled}handleXYChanged(){if(this.$displayObject){let t=this.$x,e=this.$y;this.$pivotAsAnchor&&(t-=this.$pivot.x*this.$width,e-=this.$pivot.y*this.$height),this.$pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this.$displayObject.x=t+this.$pivotOffset.x,this.$displayObject.y=e+this.$pivotOffset.y}}handleSizeChanged(){}handleScaleChanged(){this.$displayObject&&(this.$displayObject.scaleX=this.$scaleX),this.$displayObject.scaleY=this.$scaleY}get colorFilter(){if(this.$colorFilter)return this.$colorFilter;var t=new createjs.ColorMatrix;if(this.$colorFilter=new createjs.ColorMatrixFilter(t),this.$displayObject){let t=this.$displayObject.filters||[];t.push(this.$colorFilter),this.$displayObject.filters=t}return this.$colorFilter}updateColorComponents(t,e,i,s){var h=(new createjs.ColorMatrix).adjustBrightness(t).adjustContrast(100*e).adjustHue(180*s).adjustSaturation(100*i);this.$displayObject.filters=[new createjs.ColorMatrixFilter(h)],this.$displayObject.cache(0,0,this.$width,this.$height),this.$lastColorComponents||(this.$lastColorComponents=[]),this.$lastColorComponents.length=0,this.$lastColorComponents.push(t,e,i,s)}handleGrayedChanged(){if(this.$displayObject)if(this.$grayed){var t=new createjs.ColorMatrixFilter([.3,.3,.3,0,0,.3,.3,.3,0,0,.3,.3,.3,0,0,0,0,0,1,0]);this.$displayObject.filters=[t],this.$displayObject.cache(0,0,this.$width,this.$height)}else this.$lastColorComponents&&this.$lastColorComponents.length>=4?this.updateColorComponents(this.$lastColorComponents[0],this.$lastColorComponents[1],this.$lastColorComponents[2],this.$lastColorComponents[3]):this.$displayObject.filters=[]}constructFromResource(){}setupBeforeAdd(t){let e,i;if(this.$id=t.attributes.id,this.$name=t.attributes.name,e=t.attributes.xy,i=e.split(","),this.setXY(parseInt(i[0]),parseInt(i[1])),e=t.attributes.size,e&&(i=e.split(","),this.$initWidth=parseInt(i[0]),this.$initHeight=parseInt(i[1]),this.setSize(this.$initWidth,this.$initHeight,!0)),e=t.attributes.scale,e&&(i=e.split(","),this.setScale(parseFloat(i[0]),parseFloat(i[1]))),e=t.attributes.rotation,e&&(this.rotation=parseInt(e)),e=t.attributes.skew,e&&(i=e.split(","),this.setSkew(parseFloat(i[0]),parseFloat(i[1]))),e=t.attributes.pivot,e){i=e.split(",");let s=parseFloat(i[0]),h=parseFloat(i[1]);e=t.attributes.anchor,this.setPivot(s,h,"true"==e)}if(e=t.attributes.alpha,e&&(this.alpha=parseFloat(e)),"false"==t.attributes.touchable&&(this.touchable=!1),"false"==t.attributes.visible&&(this.visible=!1),"true"==t.attributes.grayed&&(this.grayed=!0),this.tooltips=t.attributes.tooltips,e=t.attributes.blend,e&&(this.blendMode=e),e=t.attributes.filter,e)switch(e){case"color":e=t.attributes.filterData,i=e.split(","),this.updateColorComponents(parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]))}}setupAfterAdd(t){let e=t.attributes.group;e&&(this.$group=this.$parent.getChildById(e)),t.children.forEach(t=>{let e=h[t.nodeName];null!=e&&this.getGear(e).setup(t)},this)}static castFromNativeObject(t){return it(t)?t.UIOwner:null}initDrag(){this.$draggable?this.on(s.Down,this.$touchBegin,this):this.off(s.Down,this.$touchBegin)}dragBegin(){null!=pt.draggingObject&&pt.draggingObject.stopDrag(),pt.sGlobalDragStart.x=gt.GRoot.globalMouseStatus.mouseX,pt.sGlobalDragStart.y=gt.GRoot.globalMouseStatus.mouseY,this.localToGlobalRect(0,0,this.width,this.height,pt.sGlobalRect),pt.draggingObject=this,this.$mouseMove2Event=gt.GRoot.inst.nativeStage.on(s.Move,this.$moving2,this),this.$mouseUp2Event=gt.GRoot.inst.nativeStage.on(s.Up,this.$end2,this)}dragEnd(){pt.draggingObject==this&&(gt.GRoot.inst.nativeStage.off(s.Move,this.$mouseMove2Event),gt.GRoot.inst.nativeStage.off(s.Up,this.$mouseUp2Event),pt.draggingObject=null),pt.$dragBeginCancelled=!0}reset(){gt.GRoot.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),gt.GRoot.inst.nativeStage.off(s.Up,this.$mouseUpEvent)}$touchBegin(t){null==this.$touchDownPoint&&(this.$touchDownPoint=new createjs.Point),this.$touchDownPoint.x=t.stageX,this.$touchDownPoint.y=t.stageY,this.$mouseMoveEvent=gt.GRoot.inst.nativeStage.on(s.Move,this.$moving,this),this.$mouseUpEvent=gt.GRoot.inst.nativeStage.on(s.Up,this.$end,this)}$end(t){this.reset()}$moving(t){let e=S.touchDragSensitivity;if(null!=this.$touchDownPoint&&Math.abs(this.$touchDownPoint.x-t.stageX)<e&&Math.abs(this.$touchDownPoint.y-t.stageY)<e)return;this.reset(),pt.$dragBeginCancelled=!1;let i=new createjs.Event("__dragStart",!0,!1);i.data={currentTarget:this.$displayObject},this.$displayObject.dispatchEvent(i,this),pt.$dragBeginCancelled||this.dragBegin()}$moving2(t){let e=t.stageX-pt.sGlobalDragStart.x+pt.sGlobalRect.x,i=t.stageY-pt.sGlobalDragStart.y+pt.sGlobalRect.y;if(null!=this.$dragBounds){let t=gt.GRoot.inst.localToGlobalRect(this.$dragBounds.x,this.$dragBounds.y,this.$dragBounds.width,this.$dragBounds.height,pt.sDragHelperRect);e<t.x?e=t.x:e+pt.sGlobalRect.width>t.x+t.width&&(e=t.x+t.width-pt.sGlobalRect.width,e<t.x&&(e=t.x)),i<t.y?i=t.y:i+pt.sGlobalRect.height>t.y+t.height&&(i=t.y+t.height-pt.sGlobalRect.height,i<t.y&&(i=t.y))}pt.sUpdatingWhileDragging=!0,pt.sHelperPoint.x=e,pt.sHelperPoint.y=i;let s=this.parent.globalToLocal(e,i,pt.sHelperPoint);this.setXY(Math.round(s.x),Math.round(s.y)),pt.sUpdatingWhileDragging=!1;let h=this.$displayObject,r=new createjs.Event("__dragMoving",!0,!1);r.data={currentTarget:h},this.$displayObject.dispatchEvent(r,this)}$end2(t){if(pt.draggingObject==this){this.stopDrag();let t=this.$displayObject,e=new createjs.Event("__dragEnd",!0,!1);e.data={currentTarget:t},this.$displayObject.dispatchEvent(e,this)}}}pt.gInstanceCounter=0,pt.sGlobalDragStart=new createjs.Point,pt.sGlobalRect=new createjs.Rectangle,pt.sHelperPoint=new createjs.Point,pt.sDragHelperRect=new createjs.Rectangle;let gt={};class ft extends pt{createDisplayObject(){let t=new i(this);t.mouseEnabled=!1,this.setDisplayObject(t)}updateBounds(){if(this.$updating||!this.parent)return;let t,e=this.$parent.numChildren,i=0,s=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;this.$empty=!0;let a=0;for(i=0;i<e;i++)t=this.$parent.getChildAt(i),t.group==this&&(a=t.x,a<s&&(s=a),a=t.y,a<h&&(h=a),a=t.x+t.width,a>r&&(r=a),a=t.y+t.height,a>n&&(n=a),this.$empty=!1);this.$updating=!0,this.$empty?this.setSize(0,0):(this.setXY(s,h),this.setSize(r-s,n-h)),this.$updating=!1}setXY(t,e){if(this.$x!=t||this.$y!=e){let i=t-this.$x,s=e-this.$y;super.setXY(t,e),this.moveChildren(i,s)}}moveChildren(t,e){if(this.$updating||!this.$parent)return;this.$updating=!0;let i,s=this.$parent.numChildren,h=0;for(h=0;h<s;h++)i=this.$parent.getChildAt(h),i.group==this&&i.setXY(i.x+t,i.y+e);this.$updating=!1}updateAlpha(){if(super.updateAlpha(),this.$inProgressBuilding)return;let t,e,i=this.$parent.numChildren;for(t=0;t<i;t++)e=this.$parent.getChildAt(t),e.group==this&&(e.alpha=this.alpha)}}class mt extends createjs.Shape{constructor(t){super(),this.UIOwner=t,this.mouseEnabled=!1}}class wt extends pt{constructor(){super(),this.$type=0,this.$lineSize=1,this.$sides=0,this.$startAngle=0,this.$points=[],this.$lineSize=1,this.$lineColor="#000000",this.$fillColor="#FFFFFF"}drawRect(t,e,i){this.$type=1,this.$lineSize=t,this.$lineColor=e,this.$fillColor=i,this.drawGraph()}drawEllipse(t,e,i){this.$type=2,this.$lineSize=t,this.$lineColor=e,this.$fillColor=i,this.drawGraph()}get color(){return this.$fillColor}set color(t){this.$fillColor=t,0!=this.$type&&this.drawGraph()}drawGraph(){let t=this.$displayObject,e=t.graphics;e.clear();let i=this.width,s=this.height;if(0!=i&&0!=s){if(e.beginStroke(this.$lineColor),0==this.$lineSize?e.setStrokeStyle(.1):(e.setStrokeStyle(this.$lineSize),i-=this.$lineSize,s-=this.$lineSize),e.beginFill(this.$fillColor),1==this.$type)this.$corner&&this.$corner.length>=1?1==this.$corner.length?e.drawRoundRect(this.$lineSize/2,this.$lineSize/2,i,s,this.$corner[0]):e.drawRoundRectComplex(this.$lineSize/2,this.$lineSize/2,i,s,this.$corner[0],this.$corner[1],this.$corner[3],this.$corner[2]):e.drawRect(this.$lineSize/2,this.$lineSize/2,i,s);else if(2==this.$type){let t=.5*i;i==s?e.drawCircle(t+this.$lineSize/2,t+this.$lineSize/2,t):(i-=this.$lineSize,s-=this.$lineSize,e.drawEllipse(this.$lineSize/2,this.$lineSize/2,i,s))}else if(3==this.$type){let t=i>s?i/2:s/2;e.drawPolyStar(0+t,0+t,t,this.$sides,0,this.$startAngle)}else 4==this.$type&&G.fillPath(e,this.$points,0,0);e.endFill(),t.cache(0,0,this.$width,this.$height)}}replaceMe(t){if(!this.$parent)throw new Error("parent not set");t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);let e=this.$parent.getChildIndex(this);this.$parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this.$parent.removeChild(this,!0)}addBeforeMe(t){if(null==this.$parent)throw new Error("parent not set");let e=this.$parent.getChildIndex(this);this.$parent.addChildAt(t,e)}addAfterMe(t){if(null==this.$parent)throw new Error("parent not set");let e=this.$parent.getChildIndex(this);e++,this.$parent.addChildAt(t,e)}createDisplayObject(){this.$displayObject=new mt(this),this.$displayObject.mouseEnabled=!0}handleSizeChanged(){0!=this.$type&&this.drawGraph()}setupBeforeAdd(t){super.setupBeforeAdd(t);let e=t.attributes.type;if(e&&"empty"!=e){let i,s,h;i=t.attributes.lineSize,i&&(this.$lineSize=parseInt(i)),i=t.attributes.lineColor,i&&(s=H.convertToRGBA(i),this.$lineColor=s),i=t.attributes.fillColor,i&&(s=H.convertToRGBA(i),this.$fillColor=s),i=t.attributes.corner,i&&(h=i.split(","),h.length>1?this.$corner=[parseInt(h[0]),parseInt(h[1]),parseInt(h[2]),parseInt(h[3])]:this.$corner=[parseInt(h[0])]),"rect"==e?this.$type=1:"eclipse"==e?this.$type=2:"regular_polygon"==e?(this.$type=3,i=t.attributes.sides,i&&(this.$sides=parseInt(i)),i=t.attributes.startAngle,i&&(this.$startAngle=parseInt(i))):"polygon"==e&&(this.$type=4,i=t.attributes.points,i&&(h=i.split(","),this.$points=h.map(t=>parseInt(t)))),this.drawGraph()}}}class yt extends ct{constructor(t){if(super(),t){let{width:e,height:i,texture:s,id:h}=t;this.$frameId=h,"string"==typeof s?(this.texture=document.createElement("img"),this.texture.src=s):this.texture=s.image,this.sourceRect=new createjs.Rectangle(0,0,e,i),this.textureRect=s.rect}}draw(t,e){let i=super.draw(t,e);if(i)return i;if(this.sourceRect&&this.textureRect){let{x:e,y:i,width:s,height:h}=this.sourceRect;e=this.$isTrim?e:0,i=this.$isTrim?i:0,t.drawImage(this.texture,this.textureRect.x,this.textureRect.y,this.textureRect.width,this.textureRect.height,e,i,s,h)}else t.drawImage(this.texture,0,0);return!0}getBounds(){var t=super.getBounds();if(t)return t;var e=this.texture,i=this.sourceRect||e;return e&&(e.naturalWidth||e.getContext||e.readyState>=2)?this.sourceRect.setValues(0,0,i.width,i.height):null}}class bt extends ct{constructor(t,e){if(super(),t){let{width:e,height:i,texture:s,id:h}=t;this.$frameId=h,"string"==typeof s?(this.texture=document.createElement("img"),this.texture.src=s):this.texture=s.image,this.sourceRect=new createjs.Rectangle(0,0,e,i),this.textureRect=s.rect}this.scale9Grid=e,this.snapToPixel=!0}draw(t,e){if(super.draw(t,e))return!0;var i,s,h=this.scale9Grid.width,r=this.scale9Grid.height,n=this.sourceRect.height,a=this.sourceRect.width;if(0==h){if(0==r)throw"One of scale9Grid width or height must be greater than zero.";var l=this.textureRect.y+this.scale9Grid.y,o=this.textureRect.y+this.scale9Grid.y+this.scale9Grid.height,$=this.scale9Grid.y,c=this.scale9Grid.height;s=n-$-(d=this.textureRect.height-$-c),t.drawImage(this.texture,this.textureRect.x,this.textureRect.y,this.textureRect.width,$,0,0,a,$),t.drawImage(this.texture,this.textureRect.x,l,this.textureRect.width,c,0,$,a,s),t.drawImage(this.texture,this.textureRect.x,o,this.textureRect.width,d,0,s+$,a,d)}else if(0==r){var d;l=this.textureRect.x+this.scale9Grid.x,o=this.textureRect.x+this.scale9Grid.x+this.scale9Grid.width,$=this.scale9Grid.x,c=this.scale9Grid.width;i=a-$-(d=this.textureRect.width-$-c),t.drawImage(this.texture,this.textureRect.x,this.textureRect.y,$,this.textureRect.height,0,0,$,n),t.drawImage(this.texture,l,this.textureRect.y,c,this.textureRect.height,$,0,i,n),t.drawImage(this.texture,o,this.textureRect.y,d,this.textureRect.height,$+i,0,d,n)}else{var u=this.scale9Grid.x,p=this.scale9Grid.y,g=this.textureRect.width-h-u,f=this.textureRect.height-r-p;i=a-u-g,s=n-p-f,t.drawImage(this.texture,this.textureRect.x,this.textureRect.y,u,p,0,0,u,p),t.drawImage(this.texture,this.textureRect.x+u,this.textureRect.y,h,p,u,0,i,p),t.drawImage(this.texture,this.textureRect.x+u+h,this.textureRect.y,g,p,u+i,0,g,p),t.drawImage(this.texture,this.textureRect.x,this.textureRect.y+p,u,r,0,p,u,s),t.drawImage(this.texture,this.textureRect.x+u,this.textureRect.y+p,h,r,u,p,i,s),t.drawImage(this.texture,this.textureRect.x+u+h,this.textureRect.y+p,g,r,u+i,p,g,s),t.drawImage(this.texture,this.textureRect.x,this.textureRect.y+p+r,u,f,0,p+s,u,f),t.drawImage(this.texture,this.textureRect.x+u,this.textureRect.y+p+r,h,f,u,p+s,i,f),t.drawImage(this.texture,this.textureRect.x+u+h,this.textureRect.y+p+r,g,f,u+i,p+s,g,f)}return!0}}class xt extends ct{constructor(t){if(super(),t){let{width:e,height:i,texture:s,id:h}=t;this.$frameId=h,"string"==typeof s?(this.texture=document.createElement("img"),this.texture.src=s):this.texture=s.image,this.sourceRect=new createjs.Rectangle(0,0,e,i),this.textureRect=s.rect;let r=document.createElement("canvas"),n=r.getContext("2d");r.width=this.textureRect.width,r.height=this.textureRect.height,n.drawImage(this.texture,this.textureRect.x,this.textureRect.y,this.textureRect.width,this.textureRect.height,0,0,this.textureRect.width,this.textureRect.height),this._pattern=n.createPattern(r,"repeat")}}draw(t,e){let i=super.draw(t,e);if(i)return i;let{width:s,height:h}=this.sourceRect;return t.fillStyle=this._pattern,t.fillRect(0,0,s,h),!0}}class St extends createjs.Container{constructor(t){super(),this.UIOwner=t}set sourceRect(t){this.$disp.sourceRect=t}setCache(t,e,i,s){this.$disp.cache(t,e,i,s)}$initDisp(t){if(!this.$disp){if(t)if(t.load(),t.scaleByTile)this.$disp=new xt(t);else if(t.scale9Grid){let e=new createjs.Rectangle(t.scale9Grid.x,t.scale9Grid.y,Math.max(0,t.scale9Grid.width),Math.max(0,t.scale9Grid.height));this.$disp=new bt(t,e)}else this.$disp=new yt(t);else this.$disp=new yt;this.addChild(this.$disp)}}get tint(){return this.$disp.tint}set tint(t){this.$disp.tint=t}get height(){return this.$disp.sourceRect.height}set height(t){this.$disp.sourceRect.height=t}get width(){return this.$disp.sourceRect.width}set width(t){this.$disp.sourceRect.width=t}get texture(){return this.$disp.texture}set texture(t){this.$disp.texture=t}get scale9Grid(){return this.$disp instanceof bt?this.$disp.scale9Grid:null}set scale9Grid(t){this.$disp instanceof bt&&(this.$disp.scale9Grid=t)}destroy(){}}class vt extends pt{constructor(){super()}get touchable(){return!1}set touchable(t){this.$touchable=!1}get color(){return this.$content.tint}set color(t){this.color!=t&&(this.updateGear(4),this.$content.tint=t,this.$content.setCache(0,0,this.$width,this.$height))}get flip(){return this.$flip}set flip(t){this.$flip!=t&&(this.$flip=t,this.$content.scaleX=this.$content.scaleY=1,1!=this.$flip&&3!=this.$flip||(this.$content.scaleX=-1),2!=this.$flip&&3!=this.$flip||(this.$content.scaleY=-1),this.handleXYChanged())}get texture(){return this.$content.texture}set texture(t){null!=t?(this.$sourceWidth=t.width,this.$sourceHeight=t.height):this.$sourceWidth=this.$sourceHeight=0,this.$initWidth=this.$sourceWidth,this.$initHeight=this.$sourceHeight,this.$content.texture=t}createDisplayObject(){this.$content=new St(this),this.setDisplayObject(this.$content)}dispose(){this.$content.destroy(),super.dispose()}constructFromResource(){this.$sourceWidth=this.packageItem.width,this.$sourceHeight=this.packageItem.height,this.$initWidth=this.$sourceWidth,this.$initHeight=this.$sourceHeight,this.$content.$initDisp(this.packageItem),this.setSize(this.$sourceWidth,this.$sourceHeight)}handleXYChanged(){super.handleXYChanged(),0!=this.$flip&&(-1==this.$content.scaleX&&(this.$content.x+=this.width),-1==this.$content.scaleY&&(this.$content.y+=this.height))}handleSizeChanged(){this.$content.width=this.width,this.$content.height=this.height;let t=new createjs.Rectangle(this.x,this.y,this.width,this.height);this.$content.sourceRect=t}setupBeforeAdd(t){let e;super.setupBeforeAdd(t),e=t.attributes.color,e&&(this.color=H.HEX2RGB(e)),e=t.attributes.flip,e&&(this.flip=p(e))}}class Ct{constructor(){this.$enumIdx=0,this.$enumCount=0,this.$curTime=Date.now(),this.$items=[],this.$itemPool=[],createjs.Ticker.on("tick",this.advance,this)}getItem(){return this.$itemPool.length?this.$itemPool.pop():new It}findItem(t,e){let i=this.$items.length;for(let s=0;s<i;s++){let i=this.$items[s];if(i.callback==t&&i.thisObj==e)return i}return null}add(t,e,i,s,h){let r=this.findItem(i,s);r||(r=this.getItem(),r.callback=i,r.thisObj=s,this.$items.push(r)),r.delay=t,r.counter=0,r.repeat=e,r.param=h,r.end=!1}addLoop(t,e,i,s){this.add(t,0,e,i,s)}callLater(t,e,i){this.add(1,1,t,e,i)}callDelay(t,e,i,s){this.add(t,1,e,i,s)}exists(t,e){return null!=this.findItem(t,e)}remove(t,e){let i=this.findItem(t,e);if(i){let t=this.$items.indexOf(i);this.$items.splice(t,1),t<this.$enumIdx&&this.$enumIdx--,this.$enumCount--,i.callback=null,i.param=null,this.$itemPool.push(i)}}get ticker(){return this.$ticker}get curTime(){return this.$curTime}advance(){for(this.$enumIdx=0,this.$enumCount=this.$items.length;this.$enumIdx<this.$enumCount;){let t=this.$items[this.$enumIdx];this.$enumIdx++;let e=createjs.Ticker.interval;if(this.$curTime+=e,t.advance(e)){if(t.end&&(this.$enumIdx--,this.$enumCount--,this.$items.splice(this.$enumIdx,1),this.$itemPool.push(t)),t.callback){let i=[e];t.param&&t.param instanceof Array?i=t.param.concat(i):void 0!==t.param&&i.unshift(t.param),t.callback.apply(t.thisObj,i)}t.end&&(t.callback=t.thisObj=t.param=null)}}}}Ct.inst=new Ct;class It{constructor(){this.delay=0,this.counter=0,this.repeat=0}advance(t=0){return this.counter+=t,this.counter>=this.delay&&(this.counter-=this.delay,this.counter>this.delay&&(this.counter=this.delay),this.repeat>0&&(this.repeat--,0==this.repeat&&(this.end=!0)),!0)}}class Pt{static clamp(t,e,i){return t<e?t=e:t>i&&(t=i),t}static clamp01(t){return t>1?t=1:t<0&&(t=0),t}static isNumber(t){return"number"==typeof t&&!isNaN(t)}static sign(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}static angleToRadian(t){return t*Pt.RADIAN}static lerp(t,e,i){return t+i*(e-t)}}Pt.RADIAN=Math.PI/180;class Et{constructor(){this.repeatedCount=0,this.$curFrame=0,this.$lastTime=0,this.$curFrameDelay=0,this.$lastTime=Date.now()}update(t){let e=Date.now(),i=e-this.$lastTime;this.$lastTime=e;let s=this.$curFrame;s>=t.frameCount&&(s=t.frameCount-1),this.reachesEnd=!1,this.$curFrameDelay+=i;let h=t.interval+t.frames[s].addDelay+(0==s&&this.repeatedCount>0?t.repeatDelay:0);this.$curFrameDelay<h||(this.$curFrameDelay-=h,this.$curFrameDelay>t.interval&&(this.$curFrameDelay=t.interval),t.swing?this.reversed?(this.$curFrame--,this.$curFrame<0&&(this.$curFrame=Math.min(1,t.frameCount-1),this.repeatedCount++,this.reversed=!this.reversed)):(this.$curFrame++,this.$curFrame>t.frameCount-1&&(this.$curFrame=Math.max(0,t.frameCount-2),this.repeatedCount++,this.reachesEnd=!0,this.reversed=!this.reversed)):(this.$curFrame++,this.$curFrame>t.frameCount-1&&(this.$curFrame=0,this.repeatedCount++,this.reachesEnd=!0)))}get currentFrame(){return this.$curFrame}set currentFrame(t){this.$curFrame=t,this.$curFrameDelay=0}rewind(){this.$curFrame=0,this.$curFrameDelay=0,this.reversed=!1,this.reachesEnd=!1}reset(){this.$curFrame=0,this.$curFrameDelay=0,this.repeatedCount=0,this.reachesEnd=!1,this.reversed=!1}copy(t){this.$curFrame=t.$curFrame,this.$curFrameDelay=t.$curFrameDelay,this.repeatedCount=t.repeatedCount,this.reachesEnd=t.reachesEnd,this.reversed=t.reversed}}class kt{constructor(){this.startFrame=0,this.endFrame=-1,this.repeatCount=0,this.loopEndAt=-1,this.endCallback=null,this.endCallbackContext=null}mix(t){let e=this;for(let i in t)"mix"!=i&&(e[i]=t[i]);return this}}class Ot extends yt{constructor(t){super(),this.interval=0,this.repeatDelay=0,this.$frameCount=0,this.$currentFrame=0,this.$status=0,this.UIOwner=t,this.data=new Et,this.$playing=!0,this.mouseEnabled=!1,this.$settings=new kt,this.$isTrim=!0,this.on("added",this.added,this),this.on("removed",this.removed,this)}get frames(){return this.$frames}set frames(t){this.$frames=t,null!=this.$frames?this.$frameCount=this.$frames.length:this.$frameCount=0,(-1==this.$settings.endFrame||this.$settings.endFrame>this.$frameCount-1)&&(this.$settings.endFrame=this.$frameCount-1),(-1==this.$settings.loopEndAt||this.$settings.loopEndAt>this.$frameCount-1)&&(this.$settings.loopEndAt=this.$frameCount-1),(this.$currentFrame<0||this.$currentFrame>this.$frameCount-1)&&(this.$currentFrame=this.$frameCount-1),this.$frameCount>0?this.setFrame(this.$frames[this.$currentFrame]):this.setFrame(null),this.data.rewind()}get frameCount(){return this.$frameCount}set boundsRect(t){}get currentFrame(){return this.$currentFrame}set currentFrame(t){this.$currentFrame!=t&&(this.$currentFrame=t,this.data.currentFrame=t,this.setFrame(this.$currentFrame<this.$frameCount?this.$frames[this.$currentFrame]:null))}get playing(){return this.$playing}set playing(t){this.$playing=t,t&&pt.isDisplayObjectOnStage(this)?Ct.inst.add(0,0,this.update,this):Ct.inst.remove(this.update,this)}setPlaySettings(...t){if(1==t.length&&"object"==typeof t[0])this.$settings.mix(t[0]);else{let e=t[0],i=t[1],s=t[2],h=t[3],r=t[4],n=t[5],a={};Pt.isNumber(e)&&(a.startFrame=e),Pt.isNumber(i)&&(a.endFrame=i),Pt.isNumber(s)&&(a.repeatCount=s),Pt.isNumber(h)&&(a.loopEndAt=h),r&&"function"==typeof r&&(a.endCallback=r),n&&(a.endCallbackContext=n),this.$settings.mix(a)}(-1==this.$settings.endFrame||this.$settings.endFrame>this.$frameCount-1)&&(this.$settings.endFrame=this.$frameCount-1),-1==this.$settings.loopEndAt&&(this.$settings.loopEndAt=this.$settings.endFrame),this.$status=0,this.currentFrame=this.$settings.startFrame}update(){this.UIOwner.$inProgressBuilding||this.$playing&&0!=this.$frameCount&&3!=this.$status&&(this.data.update(this),this.$currentFrame!=this.data.currentFrame&&(1==this.$status?(this.$currentFrame=this.$settings.startFrame,this.data.currentFrame=this.$currentFrame,this.$status=0):2==this.$status?(this.$currentFrame=this.$settings.loopEndAt,this.data.currentFrame=this.$currentFrame,this.$status=3,null!=this.$settings.endCallback&&Ct.inst.callLater(this.$playEnd,this)):(this.$currentFrame=this.data.currentFrame,this.$currentFrame==this.$settings.endFrame&&this.$settings.repeatCount>0&&(this.$settings.repeatCount--,0==this.$settings.repeatCount?this.$status=2:this.$status=1)),this.setFrame(this.$frames[this.$currentFrame])))}$playEnd(){if(null!=this.$settings.endCallback){let t=this.$settings.endCallback,e=this.$settings.endCallbackContext;this.$settings.endCallback=this.$settings.endCallbackContext=null,this.$settings.endCallbackContext=null,t&&t.call(e,this)}}setFrame(t){this.texture=null==t?null:t.texture.image,this.textureRect=t.texture.rect,this.sourceRect=t.texture.trim;let{x:e,y:i,width:s,height:h}=this.sourceRect;this.cache(e,i,s,h)}added(t){this.$playing&&Ct.inst.add(0,0,this.update,this)}removed(t){this.$playing&&Ct.inst.remove(this.update,this)}destroy(){Ct.inst.remove(this.update,this),this.off("added",this.added),this.off("removed",this.removed),super.destroy()}}class Tt extends pt{constructor(){super()}mapPivotWidth(t){return t*this.$sourceWidth}mapPivotHeight(t){return t*this.$sourceHeight}handleSizeChanged(){null!=this.$displayObject&&0!=this.$sourceWidth&&0!=this.$sourceHeight&&this.$displayObject.set({scaleX:this.$width/this.$sourceWidth*this.$scaleX,scaleY:this.$height/this.$sourceHeight*this.$scaleY})}handleScaleChanged(){null!=this.$displayObject&&this.$displayObject.set({scaleX:this.$width/this.$sourceWidth*this.$scaleX,scaleY:this.$height/this.$sourceHeight*this.$scaleY})}get touchable(){return!1}set touchable(t){this.$touchable=!1}get color(){return this.$movieClip.tint}set color(t){this.$movieClip.tint=t}createDisplayObject(){this.$movieClip=new Ot(this),this.setDisplayObject(this.$movieClip)}get playing(){return this.$movieClip.playing}set playing(t){this.$movieClip.playing!=t&&(this.$movieClip.playing=t,this.updateGear(5))}get frame(){return this.$movieClip.currentFrame}set frame(t){this.$movieClip.currentFrame!=t&&(this.$movieClip.currentFrame=t,this.updateGear(5))}setPlaySettings(...t){this.$movieClip.setPlaySettings.apply(this.$movieClip,t)}constructFromResource(){this.$sourceWidth=this.packageItem.width,this.$sourceHeight=this.packageItem.height,this.$initWidth=this.$sourceWidth,this.$initHeight=this.$sourceHeight,this.setSize(this.$sourceWidth,this.$sourceHeight),this.packageItem.load(),this.$movieClip.interval=this.packageItem.interval,this.$movieClip.swing=this.packageItem.swing,this.$movieClip.repeatDelay=this.packageItem.repeatDelay,this.$movieClip.frames=this.packageItem.frames,this.$movieClip.boundsRect=new createjs.Rectangle(0,0,this.$sourceWidth,this.$sourceHeight)}setupBeforeAdd(t){let e;super.setupBeforeAdd(t),e=t.attributes.frame,e&&(this.$movieClip.currentFrame=parseInt(e)),e=t.attributes.playing,this.$movieClip.playing="false"!=e,e=t.attributes.color,e&&(this.color=H.HEX2RGB(e))}}class jt extends createjs.EventDispatcher{constructor(){super(),this.retEvent={},this.nullLowestDeltaTimeout=NaN,this.$pressedKeys={},this.$releasedKeys={},this.$downKeys=[],window.addEventListener("resize",t=>this.notifyResizeEvents(t),!1),window.addEventListener("keydown",t=>this.onWindowKeyDown(t),!1),window.addEventListener("keyup",t=>this.onWindowKeyUp(t),!1);const t="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];for(let e=t.length;e;)window.addEventListener(t[--e],t=>this.onMouseWheel(t),!1)}notifyResizeEvents(t){this.dispatchEvent("resize")}onMouseWheel(t){let e=t||window.event,i=0,s=0,h=0,r=0;if("detail"in e&&(h=-1*e.detail),"wheelDelta"in e&&(h=e.wheelDelta),"wheelDeltaY"in e&&(h=e.wheelDeltaY),"wheelDeltaX"in e&&(s=-1*e.wheelDeltaX),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(s=-1*h,h=0),i=0===h?s:h,"deltaY"in e&&(h=-1*e.deltaY,i=h),"deltaX"in e&&(s=e.deltaX,0===h&&(i=-1*s)),0===h&&0===s)return;if(1===e.deltaMode){const t=16;i*=t,h*=t,s*=t}else if(2===e.deltaMode){const t=16;i*=t,h*=t,s*=t}r=Math.max(Math.abs(h),Math.abs(s)),(!this.lowestDelta||r<this.lowestDelta)&&(this.lowestDelta=r,"mousewheel"===e.type&&r%120==0&&(this.lowestDelta/=40)),"mousewheel"===e.type&&r%120==0&&(i/=40,s/=40,h/=40),i=Math[i>=1?"floor":"ceil"](i/this.lowestDelta),s=Math[s>=1?"floor":"ceil"](s/this.lowestDelta),h=Math[h>=1?"floor":"ceil"](h/this.lowestDelta),this.retEvent.delta=i,this.retEvent.deltaX=s,this.retEvent.deltaY=h,this.retEvent.deltaFactor=this.lowestDelta,this.retEvent.deltaMode=0,this.nullLowestDeltaTimeout&&clearTimeout(this.nullLowestDeltaTimeout),this.nullLowestDeltaTimeout=window.setTimeout(()=>this.nullLowestDelta(),200);let n=new createjs.Event("__mouseWheel",!0,!1);n.data={event:this.retEvent},this.dispatchEvent(n,this)}nullLowestDelta(){this.lowestDelta=null}isKeyDown(t){return this.$downKeys.indexOf(t)>=0}isKeyPressed(t){return!!this.$pressedKeys[t]}isKeyReleased(t){return!!this.$releasedKeys[t]}onWindowKeyDown(t){let e=t.which||t.keyCode;this.isKeyDown(e)||(this.$downKeys.push(e),this.$pressedKeys[e]=!0,this.dispatchEvent("keyPressed",e))}onWindowKeyUp(t){let e=t.which||t.keyCode;if(this.isKeyDown(e)){this.$pressedKeys[e]=!1,this.$releasedKeys[e]=!0;let t=this.$downKeys.indexOf(e);t>=0&&this.$downKeys.splice(t,1),this.dispatchEvent("keyReleased",e)}}}jt.inst=new jt;class zt{constructor(){this.$requestToShow=!1,this.$scaleX=1,this.$scaleY=1}static get inst(){return zt.$instance||(zt.$instance=new zt),zt.$instance}initialize(t,e){let i;this.$canvas=e,this.$delegateDiv||(i=document.createElement("div"),this.$delegateDiv=i,i.id="__delegateDiv",t.appendChild(i),this.initDomPos(i),this.$wrapper=document.createElement("div"),this.initDomPos(this.$wrapper),this.$wrapper.style.width="0px",this.$wrapper.style.height="0px",this.$wrapper.style.left="0px",this.$wrapper.style.top="-100px",this.setTransform(this.$wrapper,"0% 0% 0px"),i.appendChild(this.$wrapper),gt.GRoot.inst.on(s.Click,this.canvasClickHandler,this),this.initInputElement(!0),this.initInputElement(!1))}isInputOn(){return null!=this.$input}canvasClickHandler(t){this.$requestToShow?(this.$requestToShow=!1,this.$input.onClickHandler(t),this.show()):this.$curEle&&(this.clearInputElement(),this.$curEle.blur(),this.$curEle=null)}isInputShown(){return null!=this.$input}isCurrentInput(t){return this.$input==t}initDomPos(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"}setTransform(t,e,i){let s=t.style;s.transformOrigin=s.webkitTransformOrigin=s.msTransformOrigin=s.mozTransformOrigin=s.oTransformOrigin=e,i&&i.length>0&&(s.transform=s.webkitTransform=s.msTransform=s.mozTransform=s.oTransform=i)}updateSize(t,e){if(!this.$canvas)return;this.$scaleX=t,this.$scaleY=e,this.$delegateDiv.style.left=this.$canvas.style.left,this.$delegateDiv.style.top=this.$canvas.style.top;let i=this.$canvas.style;this.setTransform(this.$delegateDiv,"0% 0% 0px",i.transform||i.webkitTransform||i.msTransform||i.mozTransform||i.oTransform)}initInputElement(t){let e;t?(e=document.createElement("textarea"),e.style.resize="none",this.$multiLine=e,e.id="stageTextAreaEle"):(e=document.createElement("input"),this.$singleLine=e,e.type="text",e.id="stageInputEle"),this.$wrapper.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",this.initDomPos(e);let i=e.style;i.outline="thin",i.background="none",i.overflow="hidden",i.wordBreak="break-all",i.opacity=0,e.oninput=t=>{this.$input&&this.$input.onInputHandler()}}show(){Ct.inst.callLater(()=>{this.$curEle.style.opacity="1"},this)}disconnect(t){null!=this.$input&&this.$input!=t||(this.clearInputElement(),this.$curEle&&this.$curEle.blur())}clearAttributes(t){if(this.$curEle)for(let e in t)this.$curEle.removeAttribute(e)}clearInputElement(){if(this.$curEle){this.$curEle.value="",this.$curEle.onblur=null;let t,e=this.$curEle.style;e.width="1px",e.height="12px",e.left="0px",e.top="0px",e.opacity="0",t=this.$singleLine==this.$curEle?this.$multiLine:this.$singleLine,t.style.display="block",this.$wrapper.style.left="0px",this.$wrapper.style.top="-100px",this.$wrapper.style.height="0px",this.$wrapper.style.width="0px"}this.$input&&(this.$input.onDisconnect(),this.$input=null,zt.isTyping=!1)}requestInput(t){let e;return this.clearInputElement(),this.$input=t,zt.isTyping=!0,this.$input.textField.multipleLine?(this.$curEle=this.$multiLine,e=this.$singleLine):(this.$curEle=this.$singleLine,e=this.$multiLine),e.style.display="none",this.$curEle}}zt.isTyping=!1;class At{constructor(){this.scaleMode="showAll",this.orientation="auto",this.resolution=1,this.designWidth=800,this.designHeight=600,this.alignV=4,this.alignH=1,this.fallbackWidth=0,this.fallbackHeight=0}}class Rt{getRect(t,e,i){let s=t.parentElement;if(!s)throw new Error("Your view of PIXI are still in memory but not appended to DOM yet? it's necessary that there is a parent element to wrap your view up.");let h=s.getBoundingClientRect(),r={x:0,y:0,width:0,height:0};return!h||h.width<=0||h.height<=0?(console.warn("It seems that you did not set a explicit size for the parent element of your view, now fall back to window size instead."),r.width=window.innerWidth,r.height=window.innerHeight,r.x=0,r.y=0):(r.x=h.left,r.y=h.top,r.width=h.width,r.height=h.height),(r.width<=0||r.height<=0)&&(console.warn("fetch container size to initialize PIXI in all ways have failed, now use default size (fallbackWidth / fallbackHeight) specified in the options instead."),r.width=e,r.height=i),r}}class Bt extends createjs.EventDispatcher{constructor(t,e){let i;if(super(),this.$width=0,this.$height=0,this.$scaleX=1,this.$scaleY=1,this.$canvasMatrix=new createjs.Matrix2D,this.offsetX=0,this.offsetY=0,this.$sizeCalcer=new Rt,Dt.push(this),this.$appContext=t,e instanceof At)i=e;else if(i=new At,null!=e)for(let t in e)i[t]=e[t];if(!i.designWidth||!i.designHeight)throw new Error("Invalid designWidth / designHeight in the parameter 'stageOptions'.");this.$options=i,this.$appContext.canvas.style.position="absolute";let s,h=this.$appContext.canvas.parentElement,r=h.style;"DIV"!=h.tagName&&(h=document.createElement("DIV"),r.position="relative",r.left=r.top="0px",r.width=r.height="100%",r.overflow="hidden"),s=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(h).position:r.position,""!=s&&"static"!=s||(s="relative",h.style.position=s),zt.inst.initialize(h,this.$appContext.canvas),this.updateScreenSize()}get orientation(){return this.$options.orientation}get stageWidth(){return this.$width}get stageHeight(){return this.$height}get applicationContext(){return this.$appContext}get nativeStage(){return this.$appContext}get resolution(){return this.$options.resolution}set resolution(t){this.$options.resolution=t,this.updateScreenSize()}get scaleX(){return this.$scaleX}get scaleY(){return this.$scaleY}get designWidth(){return this.$options.designWidth}get designHeight(){return this.$options.designHeight}setDesignSize(t,e){let i=this.$options;i.designWidth=t,i.designHeight=e,this.updateScreenSize()}calculateStageSize(t,e,i,s,h){let r=e,n=i,a=s,l=h,o=e/a||0,$=i/l||0;switch(t){case"exactFit":break;case"fixedHeight":a=Math.round(e/$);break;case"fixedWidth":l=Math.round(i/o);break;case"noBorder":o>$?n=Math.round(l*o):r=Math.round(a*$);break;case"showAll":o>$?r=Math.round(a*$):n=Math.round(l*o);break;case"fixedAuto":r/n<a/l?($=o,l=Math.round(i/o)):(o=$,a=Math.round(e/$));break;default:a=e,l=i}return{stageWidth:a,stageHeight:l,displayWidth:r,displayHeight:n}}updateScreenSize(){if(zt.isTyping)return;let t=this.$appContext.canvas,e=t.style,i=this.$sizeCalcer.getRect(t,this.$options.fallbackWidth,this.$options.fallbackHeight),s=!1,h=this.$options.orientation;"auto"!=h&&(s="portrait"!=h&&i.height>i.width||"portrait"==h&&i.width>i.height);let r=s?i.height:i.width,n=s?i.width:i.height,a=this.calculateStageSize(this.$options.scaleMode,r,n,this.$options.designWidth,this.$options.designHeight),l=a.stageWidth,o=a.stageHeight,$=a.displayWidth,c=a.displayHeight;t.width!==l&&(t.width=l),t.height!==o&&(t.height=o),e.transformOrigin=e.webkitTransformOrigin=e.msTransformOrigin=e.mozTransformOrigin=e.oTransformOrigin="0px 0px 0px",e.width=$+"px",e.height=c+"px";let d,u,p=this.$canvasMatrix.identity(),g=s?c:$,f=s?$:c;d=0==this.$options.alignH?0:2==this.$options.alignH?i.width-g:.5*(i.width-g),u=3==this.$options.alignV?0:5==this.$options.alignV?i.height-f:.5*(i.height-f),s?"landscape"==this.$options.orientation?(p.rotate(Math.PI/2),p.translate(n-d,u)):(p.rotate(-Math.PI/2),p.translate(d,r-u)):p.translate(d,u),s?(p.tx+=this.offsetY,p.ty+=this.offsetX):(p.tx+=this.offsetX,p.ty+=this.offsetY),p.a=this.formatData(p.a),p.d=this.formatData(p.d),p.tx=this.formatData(p.tx),p.ty=this.formatData(p.ty),e.transformOrigin=e.webkitTransformOrigin=e.msTransformOrigin=e.mozTransformOrigin=e.oTransformOrigin="0px 0px 0px",e.transform=e.webkitTransform=e.msTransform=e.mozTransform=e.oTransform=`matrix(${p.a},${p.b},${p.c},${p.d},${p.tx},${p.ty})`,this.$width=l,this.$height=o,this.$scaleX=l/$,this.$scaleY=o/c,this.$appContext.set({width:l,height:o}),zt.inst.updateSize($/l,c/o);let m=new createjs.Event("__sizeChanged",!0,!1);this.dispatchEvent(m,this)}formatData(t){return Math.abs(t)<1e-6?0:Math.abs(1-t)<.001?t>0?1:-1:t}dispose(){let t=Dt.length;for(;t-- >=0;)Dt[t]===this&&Dt.splice(t,1)}}let Dt=[],Lt=NaN;function Ft(){Dt.forEach(t=>{t.updateScreenSize()})}jt.inst.on("resize",(function(){clearTimeout(Lt),Lt=window.setTimeout(Ft,300)}));class Mt{execute(t,e,i){this.fromPage&&0!=this.fromPage.length&&-1==this.fromPage.indexOf(e)||this.toPage&&0!=this.toPage.length&&-1==this.toPage.indexOf(i)?this.leave(t):this.enter(t)}enter(t){}leave(t){}setup(t){let e;e=t.attributes.fromPage,e&&(this.fromPage=e.split(",")),e=t.attributes.toPage,e&&(this.toPage=e.split(","))}}class _t extends Mt{enter(t){if(!this.controllerName)return;let e;if(e=this.objectId?t.parent.getChildById(this.objectId):t.parent,e){let i=e.getController(this.controllerName);i&&i!=t&&!i.$updating&&(i.selectedPageId=this.targetPage)}}setup(t){super.setup(t),this.objectId=t.attributes.objectId,this.controllerName=t.attributes.controller,this.targetPage=t.attributes.targetPage}}class Wt extends Mt{constructor(){super(...arguments),this.repeat=1,this.delay=0,this.stopOnExit=!1}enter(t){let e=t.parent.getTransition(this.transitionName);e&&(this.$currentTransition&&this.$currentTransition.playing?e.changeRepeat(this.repeat):e.play({times:this.repeat,delay:this.delay}),this.$currentTransition=e)}leave(){this.stopOnExit&&this.$currentTransition&&(this.$currentTransition.stop(),this.$currentTransition=null)}setup(t){let e;super.setup(t),this.transitionName=t.attributes.transition,e=t.attributes.repeat,e&&(this.repeat=parseInt(e)),e=t.attributes.delay,e&&(this.delay=parseFloat(e)),this.stopOnExit="true"==t.attributes.stopOnExit}}class Ht extends createjs.EventDispatcher{constructor(){super(),this.$selectedIndex=0,this.$previousIndex=0,this.$pageIds=[],this.$pageNames=[],this.$selectedIndex=-1,this.$previousIndex=-1}get name(){return this.$name}set name(t){this.$name=t}get parent(){return this.$parent}get selectedIndex(){return this.$selectedIndex}set selectedIndex(t){if(this.$selectedIndex!=t){if(t>this.$pageIds.length-1)throw new Error("index out of range: "+t);this.$updating=!0,this.$previousIndex=this.$selectedIndex,this.$selectedIndex=t,this.$parent.applyController(this);let e=new createjs.Event("__stateChanged",!0,!1);this.dispatchEvent(e,this),this.$updating=!1}}setSelectedIndex(t=0){if(this.$selectedIndex!=t){if(t>this.$pageIds.length-1)throw new Error("index out of range: "+t);this.$updating=!0,this.$previousIndex=this.$selectedIndex,this.$selectedIndex=t,this.$parent.applyController(this),this.$updating=!1}}get previsousIndex(){return this.$previousIndex}get selectedPage(){return-1==this.$selectedIndex?null:this.$pageNames[this.$selectedIndex]}set selectedPage(t){this.selectedIndex=Math.max(0,this.$pageNames.indexOf(t))}setSelectedPage(t){this.setSelectedIndex(Math.max(0,this.$pageNames.indexOf(t)))}get previousPage(){return-1==this.$previousIndex?null:this.$pageNames[this.$previousIndex]}get pageCount(){return this.$pageIds.length}getPageName(t=0){return this.$pageNames[t]}addPage(t=""){this.addPageAt(t,this.$pageIds.length)}addPageAt(t,e=0){let i=""+Ht.$nextPageId++;e==this.$pageIds.length?(this.$pageIds.push(i),this.$pageNames.push(t)):(this.$pageIds.splice(e,0,i),this.$pageNames.splice(e,0,t))}removePage(t){let e=this.$pageNames.indexOf(t);-1!=e&&(this.$pageIds.splice(e,1),this.$pageNames.splice(e,1),this.$selectedIndex>=this.$pageIds.length?this.selectedIndex=this.$selectedIndex-1:this.$parent.applyController(this))}removePageAt(t=0){this.$pageIds.splice(t,1),this.$pageNames.splice(t,1),this.$selectedIndex>=this.$pageIds.length?this.selectedIndex=this.$selectedIndex-1:this.$parent.applyController(this)}clearPages(){this.$pageIds.length=0,this.$pageNames.length=0,-1!=this.$selectedIndex?this.selectedIndex=-1:this.$parent.applyController(this)}hasPage(t){return this.$pageNames.indexOf(t)>=0}getPageIndexById(t){return this.$pageIds.indexOf(t)}getPageIdByName(t){let e=this.$pageNames.indexOf(t);return-1!=e?this.$pageIds[e]:null}getPageNameById(t){let e=this.$pageIds.indexOf(t);return-1!=e?this.$pageNames[e]:null}getPageId(t=0){return this.$pageIds[t]}get selectedPageId(){return-1==this.$selectedIndex?null:this.$pageIds[this.$selectedIndex]}set selectedPageId(t){this.selectedIndex=this.$pageIds.indexOf(t)}set oppositePageId(t){this.$pageIds.indexOf(t)>0?this.selectedIndex=0:this.$pageIds.length>1&&(this.selectedIndex=1)}get previousPageId(){return-1==this.$previousIndex?null:this.$pageIds[this.$previousIndex]}executeActions(){this.$actions&&this.$actions.length>0&&this.$actions.forEach(t=>{t.execute(this,this.previousPageId,this.selectedPageId)})}createAction(t){switch(t){case"play_transition":return new Wt;case"change_page":return new _t}return null}setup(t){this.$name=t.attributes.name,this.$autoRadioGroupDepth="true"==t.attributes.autoRadioGroupDepth;let e=t.attributes.pages;if(e){let t=e.split(","),i=t.length;for(let e=0;e<i;e+=2)this.$pageIds.push(t[e]),this.$pageNames.push(t[e+1])}let i=t.children;if(i.length>0&&(this.$actions=this.$actions||[],i.forEach(t=>{let e=this.createAction(t.attributes.type);e.setup(t),this.$actions.push(e)})),e=t.attributes.transitions,e){let t,i;this.$actions=this.$actions||[],e.split(",").forEach(e=>{if(e&&e.length){let s=new Wt;t=e.indexOf("="),s.transitionName=e.substr(t+1),e=e.substring(0,t),t=e.indexOf("-"),i=parseInt(e.substring(t+1)),i<this.$pageIds.length&&(s.toPage=[this.$pageIds[i]]),"*"!=(e=e.substring(0,t))&&(i=parseInt(e),i<this.$pageIds.length&&(s.fromPage=[this.$pageIds[i]])),s.stopOnExit=!0,this.$actions.push(s)}})}this.$parent&&this.$pageIds.length>0?this.$selectedIndex=0:this.$selectedIndex=-1}}Ht.$nextPageId=0;class Gt{static clamp(t,e,i){return t<e?t=e:t>i&&(t=i),t}static clamp01(t){return t>1?t=1:t<0&&(t=0),t}static isNumber(t){return"number"==typeof t&&!isNaN(t)}static sign(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}static angleToRadian(t){return t*Gt.RADIAN}static lerp(t,e,i){return t+i*(e-t)}}Gt.RADIAN=Math.PI/180;const Nt=e(window.navigator);class Vt extends createjs.EventDispatcher{constructor(t,e,h,r,n,a,l,o,$){let c;if(super(),this.$isDragging=!1,this.$owner=t,this.$maskContainer=new i(null),this.$owner.$rootContainer.addChild(this.$maskContainer),this.$container=this.$owner.$container,this.$container.x=0,this.$container.y=0,this.$maskContainer.addChild(this.$container),this.$scrollBarMargin=h,this.$scrollType=e,this.$scrollSpeed=S.defaultScrollSpeed,this.$mouseWheelSpeed=2*this.$scrollSpeed,this.$decelerationRate=S.defaultScrollDecelerationRate,this.$displayOnLeft=0!=(1&n),this.$snapToItem=0!=(2&n),this.$displayOnDemand=0!=(4&n),this.$pageMode=0!=(8&n),this.$touchEffect=!!(16&n)||!(32&n)&&S.defaultScrollTouchEffect,this.$bouncebackEffect=!!(64&n)||!(128&n)&&S.defaultScrollBounceEffect,this.$inertiaDisabled=0!=(256&n),0==(512&n)&&(this.$maskContainer.scrollRect=new createjs.Rectangle),this.$scrollBarVisible=!0,this.$mouseWheelEnabled=!0,this.$xPos=0,this.$yPos=0,this.$aniFlag=0,this.$footerLockedSize=0,this.$headerLockedSize=0,0==r&&(r=S.defaultScrollBarDisplay),this.$viewSize=new createjs.Point,this.$contentSize=new createjs.Point,this.$pageSize=new createjs.Point(1,1),this.$overlapSize=new createjs.Point,this.$tweening=0,this.$tweenTime=new createjs.Point,this.$tweenStart=new createjs.Point,this.$tweenDuration=new createjs.Point,this.$tweenChange=new createjs.Point,this.$velocity=new createjs.Point,this.$containerPos=new createjs.Point,this.$beginTouchPos=new createjs.Point,this.$lastTouchPos=new createjs.Point,this.$lastTouchGlobalPos=new createjs.Point,3!=r){if(2==this.$scrollType||1==this.$scrollType){const t=a||S.verticalScrollBar;if(t){if(this.$vtScrollBar=q.createObjectFromURL(t),!this.$vtScrollBar)throw new Error("Cannot create scrollbar from "+t);this.$vtScrollBar.setScrollPane(this,!0),this.$owner.$rootContainer.addChild(this.$vtScrollBar.displayObject)}}if((2==this.$scrollType||0==this.$scrollType)&&(c=l||S.horizontalScrollBar,c)){if(this.$hzScrollBar=q.createObjectFromURL(c),!this.$hzScrollBar)throw new Error("Cannot create scrollbar from "+c);this.$hzScrollBar.setScrollPane(this,!1),this.$owner.$rootContainer.addChild(this.$hzScrollBar.displayObject)}this.$scrollBarDisplayAuto=2==r,this.$scrollBarDisplayAuto&&(this.$scrollBarVisible=!1,this.$vtScrollBar&&(this.$vtScrollBar.displayObject.visible=!1),this.$hzScrollBar&&(this.$hzScrollBar.displayObject.visible=!1))}else this.$mouseWheelEnabled=!1;if(o&&(this.$header=q.createObjectFromURL(o),null==this.$header))throw new Error("Cannot create scrollPane.header from "+c);if($&&(this.$footer=q.createObjectFromURL($),null==this.$footer))throw new Error("Cannot create scrollPane.footer from "+c);null==this.$header&&null==this.$footer||(this.$refreshBarAxis=2==this.$scrollType||1==this.$scrollType?"y":"x"),this.setSize(t.width,t.height),this.$owner.on(s.Over,this.$rollOver,this),this.$owner.on(s.Out,this.$rollOut,this),this.$owner.on(s.Down,this.$mouseDown,this),this.$owner.on("__mouseWheel",this.$mouseWheel,this)}get owner(){return this.$owner}dispose(){0!=this.$tweening&&Ct.inst.remove(this.tweenUpdate,this),this.$pageController=null,null!=this.$hzScrollBar&&this.$hzScrollBar.dispose(),null!=this.$vtScrollBar&&this.$vtScrollBar.dispose(),null!=this.$header&&this.$header.dispose(),null!=this.$footer&&this.$footer.dispose(),gt.GRoot.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),gt.GRoot.inst.nativeStage.off(s.Up,this.$mouseUpEvent),gt.GRoot.inst.nativeStage.off(s.Click,this.$clickEvent),this.$owner.off(s.Over,this.$rollOver),this.$owner.off(s.Out,this.$rollOut),this.$owner.off(s.Down,this.$mouseDown),this.$owner.off("__mouseWheel",this.$mouseWheel)}get horzScrollBar(){return this.$hzScrollBar}get vertScrollBar(){return this.$vtScrollBar}get header(){return this.$header}get footer(){return this.$footer}get bouncebackEffect(){return this.$bouncebackEffect}set bouncebackEffect(t){this.$bouncebackEffect=t}get touchEffect(){return this.$touchEffect}set touchEffect(t){this.$touchEffect=t}set scrollSpeed(t){this.$scrollSpeed=t,0==this.$scrollSpeed&&(this.$scrollSpeed=S.defaultScrollSpeed),this.$mouseWheelSpeed=2*this.$scrollSpeed}get scrollSpeed(){return this.$scrollSpeed}get snapToItem(){return this.$snapToItem}set snapToItem(t){this.$snapToItem=t}get mouseWheelEnabled(){return this.$mouseWheelEnabled}set mouseWheelEnabled(t){this.$mouseWheelEnabled=t}get decelerationRate(){return this.$decelerationRate}set decelerationRate(t){this.$decelerationRate=t}get percX(){return 0==this.$overlapSize.x?0:this.$xPos/this.$overlapSize.x}set percX(t){this.setPercX(t,!1)}setPercX(t,e=!1){this.$owner.ensureBoundsCorrect(),this.setPosX(this.$overlapSize.x*Gt.clamp01(t),e)}get percY(){return 0==this.$overlapSize.y?0:this.$yPos/this.$overlapSize.y}set percY(t){this.setPercY(t,!1)}setPercY(t,e=!1){this.$owner.ensureBoundsCorrect(),this.setPosY(this.$overlapSize.y*Gt.clamp01(t),e)}get posX(){return this.$xPos}set posX(t){this.setPosX(t,!1)}setPosX(t,e=!1){this.$owner.ensureBoundsCorrect(),1==this.$loop&&(t=this.loopCheckingNewPos(t,"x")),(t=Gt.clamp(t,0,this.$overlapSize.x))!=this.$xPos&&(this.$xPos=t,this.posChanged(e))}get posY(){return this.$yPos}set posY(t){this.setPosY(t,!1)}setPosY(t,e=!1){this.$owner.ensureBoundsCorrect(),1==this.$loop&&(t=this.loopCheckingNewPos(t,"y")),(t=Gt.clamp(t,0,this.$overlapSize.y))!=this.$yPos&&(this.$yPos=t,this.posChanged(e))}get contentWidth(){return this.$contentSize.x}get contentHeight(){return this.$contentSize.y}get viewWidth(){return this.$viewSize.x}set viewWidth(t){t=t+this.$owner.margin.left+this.$owner.margin.right,null!=this.$vtScrollBar&&(t+=this.$vtScrollBar.width),this.$owner.width=t}get viewHeight(){return this.$viewSize.y}set viewHeight(t){t=t+this.$owner.margin.top+this.$owner.margin.bottom,null!=this.$hzScrollBar&&(t+=this.$hzScrollBar.height),this.$owner.height=t}get currentPageX(){if(!this.$pageMode)return 0;var t=Math.floor(this.$xPos/this.$pageSize.x);return this.$xPos-t*this.$pageSize.x>.5*this.$pageSize.x&&t++,t}set currentPageX(t){this.$pageMode&&this.$overlapSize.x>0&&this.setPosX(t*this.$pageSize.x,!1)}get currentPageY(){if(!this.$pageMode)return 0;let t=Math.floor(this.$yPos/this.$pageSize.y);return this.$yPos-t*this.$pageSize.y>.5*this.$pageSize.y&&t++,t}set currentPageY(t){this.$pageMode&&this.$overlapSize.y>0&&this.setPosY(t*this.$pageSize.y,!1)}get isBottomMost(){return this.$yPos==this.$overlapSize.y||0==this.$overlapSize.y}get isRightMost(){return this.$xPos==this.$overlapSize.x||0==this.$overlapSize.x}get pageController(){return this.$pageController}set pageController(t){this.$pageController=t}get scrollingPosX(){return Gt.clamp(-this.$container.x,0,this.$overlapSize.x)}get scrollingPosY(){return Gt.clamp(-this.$container.y,0,this.$overlapSize.y)}scrollTop(t=!1){this.setPercY(0,t)}scrollBottom(t=!1){this.setPercY(1,t)}scrollUp(t=1,e=!1){this.$pageMode?this.setPosY(this.$yPos-this.$pageSize.y*t,e):this.setPosY(this.$yPos-this.$scrollSpeed*t,e)}scrollDown(t=1,e=!1){this.$pageMode?this.setPosY(this.$yPos+this.$pageSize.y*t,e):this.setPosY(this.$yPos+this.$scrollSpeed*t,e)}scrollLeft(t=1,e=!1){this.$pageMode?this.setPosX(this.$xPos-this.$pageSize.x*t,e):this.setPosX(this.$xPos-this.$scrollSpeed*t,e)}scrollRight(t=1,e=!1){this.$pageMode?this.setPosX(this.$xPos+this.$pageSize.x*t,e):this.setPosX(this.$xPos+this.$scrollSpeed*t,e)}scrollToView(t,e=!1,i=!1){let s;if(this.$owner.ensureBoundsCorrect(),this.$needRefresh&&this.refresh(),t instanceof pt?t.parent!=this.$owner?(t.parent.localToGlobalRect(t.x,t.y,t.width,t.height,Vt.sHelperRect),s=this.$owner.globalToLocalRect(Vt.sHelperRect.x,Vt.sHelperRect.y,Vt.sHelperRect.width,Vt.sHelperRect.height,Vt.sHelperRect)):(s=Vt.sHelperRect,s.x=t.x,s.y=t.y,s.width=t.width,s.height=t.height):s=t,this.$overlapSize.y>0){const t=this.$yPos+this.$viewSize.y;i||s.y<=this.$yPos||s.height>=this.$viewSize.y?this.$pageMode?this.setPosY(Math.floor(s.y/this.$pageSize.y)*this.$pageSize.y,e):this.setPosY(s.y,e):s.y+s.height>t&&(this.$pageMode?this.setPosY(Math.floor(s.y/this.$pageSize.y)*this.$pageSize.y,e):s.height<=this.$viewSize.y/2?this.setPosY(s.y+2*s.height-this.$viewSize.y,e):this.setPosY(s.y+s.height-this.$viewSize.y,e))}if(this.$overlapSize.x>0){let t=this.$xPos+this.$viewSize.x;i||s.x<=this.$xPos||s.width>=this.$viewSize.x?this.$pageMode?this.setPosX(Math.floor(s.x/this.$pageSize.x)*this.$pageSize.x,e):this.setPosX(s.x,e):s.x+s.width>t&&(this.$pageMode?this.setPosX(Math.floor(s.x/this.$pageSize.x)*this.$pageSize.x,e):s.width<=this.$viewSize.x/2?this.setPosX(s.x+2*s.width-this.$viewSize.x,e):this.setPosX(s.x+s.width-this.$viewSize.x,e))}!e&&this.$needRefresh&&this.refresh()}isChildInView(t){if(this.$overlapSize.y>0){var e=t.y+this.$container.y;if(e<-t.height||e>this.$viewSize.y)return!1}return!(this.$overlapSize.x>0&&((e=t.x+this.$container.x)<-t.width||e>this.$viewSize.x))}cancelDragging(){gt.GRoot.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),gt.GRoot.inst.nativeStage.off(s.Up,this.$mouseUpEvent),gt.GRoot.inst.nativeStage.off(s.Click,this.$clickEvent),Vt.draggingPane==this&&(Vt.draggingPane=null),Vt.$gestureFlag=0,this.$isDragging=!1,this.$maskContainer.mouseEnabled=!0}get isDragging(){return this.$isDragging}lockHeader(t){this.$headerLockedSize!=t&&(this.$headerLockedSize=t,!this.$refreshEventDispatching&&this.$container[this.$refreshBarAxis]>=0&&(this.$tweenStart.setValues(this.$container.x,this.$container.y),this.$tweenChange.setValues(0,0),this.$tweenChange[this.$refreshBarAxis]=this.$headerLockedSize-this.$tweenStart[this.$refreshBarAxis],this.$tweenDuration.setValues(Vt.TWEEN_DEFAULT_DURATION,Vt.TWEEN_DEFAULT_DURATION),this.$tweenTime.setValues(0,0),this.$tweening=2,Ct.inst.addLoop(1,this.tweenUpdate,this)))}lockFooter(t){if(this.$footerLockedSize!=t&&(this.$footerLockedSize=t,!this.$refreshEventDispatching&&this.$container[this.$refreshBarAxis]<=-this.$overlapSize[this.$refreshBarAxis])){this.$tweenStart.setValues(this.$container.x,this.$container.y),this.$tweenChange.setValues(0,0);let t=this.$overlapSize[this.$refreshBarAxis];0==t?t=Math.max(this.$contentSize[this.$refreshBarAxis]+this.$footerLockedSize-this.$viewSize[this.$refreshBarAxis],0):t+=this.$footerLockedSize,this.$tweenChange[this.$refreshBarAxis]=-t-this.$tweenStart[this.$refreshBarAxis],this.$tweenDuration.setValues(Vt.TWEEN_DEFAULT_DURATION,Vt.TWEEN_DEFAULT_DURATION),this.$tweenTime.setValues(0,0),this.$tweening=2,Ct.inst.addLoop(1,this.tweenUpdate,this)}}onOwnerSizeChanged(){this.setSize(this.$owner.width,this.$owner.height),this.posChanged(!1)}handleControllerChanged(t){this.$pageController==t&&(0==this.$scrollType?this.currentPageX=t.selectedIndex:this.currentPageY=t.selectedIndex)}updatePageController(){if(null!=this.$pageController&&!this.$pageController.$updating){let t;if(t=0==this.$scrollType?this.currentPageX:this.currentPageY,t<this.$pageController.pageCount){const e=this.$pageController;this.$pageController=null,e.selectedIndex=t,this.$pageController=e}}}adjustMaskContainer(){let t,e;t=this.$displayOnLeft&&null!=this.$vtScrollBar?Math.floor(this.$owner.margin.left+this.$vtScrollBar.width):Math.floor(this.$owner.margin.left),e=Math.floor(this.$owner.margin.top),this.$maskContainer.set({x:t,y:e}),0!=this.$owner.$alignOffset.x||0!=this.$owner.$alignOffset.y?(null==this.$alignContainer&&(this.$alignContainer=new createjs.Container,this.$maskContainer.addChild(this.$alignContainer),this.$alignContainer.addChild(this.$container)),this.$alignContainer.set({x:this.$owner.$alignOffset.x,y:this.$owner.$alignOffset.y})):this.$alignContainer&&this.$alignContainer.set({x:0,y:0})}setSize(t,e){this.adjustMaskContainer(),this.$hzScrollBar&&(this.$hzScrollBar.y=e-this.$hzScrollBar.height,this.$vtScrollBar&&!this.$vScrollNone?(this.$hzScrollBar.width=t-this.$vtScrollBar.width-this.$scrollBarMargin.left-this.$scrollBarMargin.right,this.$displayOnLeft?this.$hzScrollBar.x=this.$scrollBarMargin.left+this.$vtScrollBar.width:this.$hzScrollBar.x=this.$scrollBarMargin.left):(this.$hzScrollBar.width=t-this.$scrollBarMargin.left-this.$scrollBarMargin.right,this.$hzScrollBar.x=this.$scrollBarMargin.left)),this.$vtScrollBar&&(this.$displayOnLeft||(this.$vtScrollBar.x=t-this.$vtScrollBar.width),this.$hzScrollBar?this.$vtScrollBar.height=e-this.$hzScrollBar.height-this.$scrollBarMargin.top-this.$scrollBarMargin.bottom:this.$vtScrollBar.height=e-this.$scrollBarMargin.top-this.$scrollBarMargin.bottom,this.$vtScrollBar.y=this.$scrollBarMargin.top),this.$viewSize.x=t,this.$viewSize.y=e,this.$hzScrollBar&&!this.$hScrollNone&&(this.$viewSize.y-=this.$hzScrollBar.height),this.$vtScrollBar&&!this.$vScrollNone&&(this.$viewSize.x-=this.$vtScrollBar.width),this.$viewSize.x-=this.$owner.margin.left+this.$owner.margin.right,this.$viewSize.y-=this.$owner.margin.top+this.$owner.margin.bottom,this.$viewSize.x=Math.max(1,this.$viewSize.x),this.$viewSize.y=Math.max(1,this.$viewSize.y),this.$pageSize.x=this.$viewSize.x,this.$pageSize.y=this.$viewSize.y,this.handleSizeChanged()}setContentSize(t,e){this.$contentSize.x==t&&this.$contentSize.y==e||(this.$contentSize.x=t,this.$contentSize.y=e,this.handleSizeChanged())}changeContentSizeOnScrolling(t,e,i,s){const h=this.$xPos==this.$overlapSize.x,r=this.$yPos==this.$overlapSize.y;this.$contentSize.x+=t,this.$contentSize.y+=e,this.handleSizeChanged(),1==this.$tweening?(0!=t&&h&&this.$tweenChange.x<0&&(this.$xPos=this.$overlapSize.x,this.$tweenChange.x=-this.$xPos-this.$tweenStart.x),0!=e&&r&&this.$tweenChange.y<0&&(this.$yPos=this.$overlapSize.y,this.$tweenChange.y=-this.$yPos-this.$tweenStart.y)):2==this.$tweening?(0!=i&&(this.$container.x-=i,this.$tweenStart.x-=i,this.$xPos=-this.$container.x),0!=s&&(this.$container.y-=s,this.$tweenStart.y-=s,this.$yPos=-this.$container.y)):this.$isDragging?(0!=i&&(this.$container.x-=i,this.$containerPos.x-=i,this.$xPos=-this.$container.x),0!=s&&(this.$container.y-=s,this.$containerPos.y-=s,this.$yPos=-this.$container.y)):(0!=t&&h&&(this.$xPos=this.$overlapSize.x,this.$container.x=-this.$xPos),0!=e&&r&&(this.$yPos=this.$overlapSize.y,this.$container.y=-this.$yPos)),this.$pageMode&&this.updatePageController()}handleSizeChanged(t=!1){this.$displayOnDemand&&(this.$vtScrollBar&&(this.$contentSize.y<=this.$viewSize.y?this.$vScrollNone||(this.$vScrollNone=!0,this.$viewSize.x+=this.$vtScrollBar.width):this.$vScrollNone&&(this.$vScrollNone=!1,this.$viewSize.x-=this.$vtScrollBar.width)),this.$hzScrollBar&&(this.$contentSize.x<=this.$viewSize.x?this.$hScrollNone||(this.$hScrollNone=!0,this.$viewSize.y+=this.$hzScrollBar.height):this.$hScrollNone&&(this.$hScrollNone=!1,this.$viewSize.y-=this.$hzScrollBar.height))),this.$vtScrollBar&&(this.$viewSize.y<this.$vtScrollBar.minSize?this.$vtScrollBar.displayObject.visible=!1:(this.$vtScrollBar.displayObject.visible=this.$scrollBarVisible&&!this.$vScrollNone,0==this.$contentSize.y?this.$vtScrollBar.displayPerc=0:this.$vtScrollBar.displayPerc=Math.min(1,this.$viewSize.y/this.$contentSize.y))),this.$hzScrollBar&&(this.$viewSize.x<this.$hzScrollBar.minSize?this.$hzScrollBar.displayObject.visible=!1:(this.$hzScrollBar.displayObject.visible=this.$scrollBarVisible&&!this.$hScrollNone,0==this.$contentSize.x?this.$hzScrollBar.displayPerc=0:this.$hzScrollBar.displayPerc=Math.min(1,this.$viewSize.x/this.$contentSize.x)));const e=this.$maskContainer.scrollRect;if(e&&(e.width=this.$viewSize.x,e.height=this.$viewSize.y,this.$maskContainer.scrollRect=e),0==this.$scrollType||2==this.$scrollType?this.$overlapSize.x=Math.ceil(Math.max(0,this.$contentSize.x-this.$viewSize.x)):this.$overlapSize.x=0,1==this.$scrollType||2==this.$scrollType?this.$overlapSize.y=Math.ceil(Math.max(0,this.$contentSize.y-this.$viewSize.y)):this.$overlapSize.y=0,this.$xPos=Gt.clamp(this.$xPos,0,this.$overlapSize.x),this.$yPos=Gt.clamp(this.$yPos,0,this.$overlapSize.y),null!=this.$refreshBarAxis){var i=this.$overlapSize[this.$refreshBarAxis];0==i?i=Math.max(this.$contentSize[this.$refreshBarAxis]+this.$footerLockedSize-this.$viewSize[this.$refreshBarAxis],0):i+=this.$footerLockedSize,"x"==this.$refreshBarAxis?this.$container.set({x:Gt.clamp(this.$container.x,-i,this.$headerLockedSize),y:Gt.clamp(this.$container.y,-this.$overlapSize.y,0)}):this.$container.set({x:Gt.clamp(this.$container.x,-this.$overlapSize.x,0),y:Gt.clamp(this.$container.y,-i,this.$headerLockedSize)}),null!=this.$header&&("x"==this.$refreshBarAxis?this.$header.height=this.$viewSize.y:this.$header.width=this.$viewSize.x),null!=this.$footer&&("y"==this.$refreshBarAxis?this.$footer.height=this.$viewSize.y:this.$footer.width=this.$viewSize.x)}else this.$container.set({x:Gt.clamp(this.$container.x,-this.$overlapSize.x,0),y:Gt.clamp(this.$container.y,-this.$overlapSize.y,0)});this.syncScrollBar(),this.checkRefreshBar(),this.$pageMode&&this.updatePageController()}posChanged(t){0==this.$aniFlag?this.$aniFlag=t?1:-1:1!=this.$aniFlag||t||(this.$aniFlag=-1),this.$needRefresh=!0,Ct.inst.callLater(this.refresh,this)}refresh(){this.$needRefresh=!1,Ct.inst.remove(this.refresh,this),(this.$pageMode||this.$snapToItem)&&(Vt.sEndPos.setValues(-this.$xPos,-this.$yPos),this.alignPosition(Vt.sEndPos,!1),this.$xPos=-Vt.sEndPos.x,this.$yPos=-Vt.sEndPos.y),this.refresh2();let t=new createjs.Event("__scroll",!0,!1);this.dispatchEvent(t,this),this.$needRefresh&&(this.$needRefresh=!1,Ct.inst.remove(this.refresh,this),this.refresh2()),this.syncScrollBar(),this.$aniFlag=0}refresh2(){if(1!=this.$aniFlag||this.$isDragging)0!=this.$tweening&&this.killTween(),this.$container.set({x:Math.floor(-this.$xPos),y:Math.floor(-this.$yPos)}),this.loopCheckingCurrent();else{let t,e;this.$overlapSize.x>0?t=-Math.floor(this.$xPos):(0!=this.$container.x&&(this.$container.x=0),t=0),this.$overlapSize.y>0?e=-Math.floor(this.$yPos):(0!=this.$container.y&&(this.$container.y=0),e=0),t!=this.$container.x||e!=this.$container.y?(this.$tweening=1,this.$tweenTime.setValues(0,0),this.$tweenDuration.setValues(Vt.TWEEN_MANUALLY_SET_DURATION,Vt.TWEEN_MANUALLY_SET_DURATION),this.$tweenStart.setValues(this.$container.x,this.$container.y),this.$tweenChange.setValues(t-this.$tweenStart.x,e-this.$tweenStart.y),Ct.inst.addLoop(1,this.tweenUpdate,this)):0!=this.$tweening&&this.killTween()}this.$pageMode&&this.updatePageController()}syncScrollBar(t=!1){null!=this.$vtScrollBar&&(this.$vtScrollBar.scrollPerc=0==this.$overlapSize.y?0:Gt.clamp(-this.$container.y,0,this.$overlapSize.y)/this.$overlapSize.y,this.$scrollBarDisplayAuto&&this.showScrollBar(!t)),null!=this.$hzScrollBar&&(this.$hzScrollBar.scrollPerc=0==this.$overlapSize.x?0:Gt.clamp(-this.$container.x,0,this.$overlapSize.x)/this.$overlapSize.x,this.$scrollBarDisplayAuto&&this.showScrollBar(!t)),t&&(this.$maskContainer.mouseEnabled=!0)}$mouseDown(t){if(!this.$touchEffect)return;0!=this.$tweening?(this.killTween(),this.$isDragging=!0):this.$isDragging=!1;const e=Nt.any?this.$owner.globalToLocal(t.localX,t.localY):this.$owner.globalToLocal(gt.GRoot.globalMouseStatus.mouseX,gt.GRoot.globalMouseStatus.mouseY,Vt.sHelperPoint);this.$containerPos.setValues(this.$container.x,this.$container.y),this.$beginTouchPos.copy(e),this.$lastTouchPos.copy(e),this.$lastTouchGlobalPos.copy(e),this.$isHoldAreaDone=!1,this.$velocity.setValues(0,0),this.$velocityScale=1,this.$lastMoveTime=Ct.inst.curTime/1e3,this.$mouseMoveEvent=gt.GRoot.inst.nativeStage.on(s.Move,this.$mouseMove,this),this.$mouseUpEvent=gt.GRoot.inst.nativeStage.on(s.Up,this.$mouseUp,this),this.$clickEvent=gt.GRoot.inst.nativeStage.on(s.Click,this.$click,this)}$mouseMove(){if(!this.$touchEffect)return;if(null!=Vt.draggingPane&&Vt.draggingPane!=this||null!=pt.draggingObject)return;let t=S.touchScrollSensitivity;const e=this.$owner.globalToLocal(gt.GRoot.globalMouseStatus.mouseX,gt.GRoot.globalMouseStatus.mouseY,Vt.sHelperPoint);let i,s,h,r;if(1==this.$scrollType){if(!this.$isHoldAreaDone){if(Vt.$gestureFlag|=1,i=Math.abs(this.$beginTouchPos.y-e.y),i<t)return;if(0!=(2&Vt.$gestureFlag)&&(s=Math.abs(this.$beginTouchPos.x-e.x),i<s))return}h=!0}else if(0==this.$scrollType){if(!this.$isHoldAreaDone){if(Vt.$gestureFlag|=2,i=Math.abs(this.$beginTouchPos.x-e.x),i<t)return;if(0!=(1&Vt.$gestureFlag)&&(s=Math.abs(this.$beginTouchPos.y-e.y),i<s))return}r=!0}else{if(Vt.$gestureFlag=3,!this.$isHoldAreaDone&&(i=Math.abs(this.$beginTouchPos.y-e.y),i<t&&(i=Math.abs(this.$beginTouchPos.x-e.x),i<t)))return;h=r=!0}let n=Math.floor(this.$containerPos.x+e.x-this.$beginTouchPos.x),a=Math.floor(this.$containerPos.y+e.y-this.$beginTouchPos.y);h&&(a>0?this.$bouncebackEffect?null!=this.$header&&0!=this.$header.height?this.$container.y=Math.floor(Math.min(.5*a,this.$header.height)):this.$container.y=Math.floor(Math.min(.5*a,this.$viewSize.y*Vt.PULL_DIST_RATIO)):this.$container.y=0:a<-this.$overlapSize.y?this.$bouncebackEffect?null!=this.$footer&&this.$footer.height>0?this.$container.y=Math.floor(Math.max(.5*(a+this.$overlapSize.y),-this.$footer.height)-this.$overlapSize.y):this.$container.y=Math.floor(Math.max(.5*(a+this.$overlapSize.y),-this.$viewSize.y*Vt.PULL_DIST_RATIO)-this.$overlapSize.y):this.$container.y=-this.$overlapSize.y:this.$container.y=a),r&&(n>0?this.$bouncebackEffect?null!=this.$header&&0!=this.$header.width?this.$container.x=Math.floor(Math.min(.5*n,this.$header.width)):this.$container.x=Math.floor(Math.min(.5*n,this.$viewSize.x*Vt.PULL_DIST_RATIO)):this.$container.x=0:n<0-this.$overlapSize.x?this.$bouncebackEffect?null!=this.$footer&&this.$footer.width>0?this.$container.x=Math.floor(Math.max(.5*(n+this.$overlapSize.x),-this.$footer.width)-this.$overlapSize.x):this.$container.x=Math.floor(Math.max(.5*(n+this.$overlapSize.x),-this.$viewSize.x*Vt.PULL_DIST_RATIO)-this.$overlapSize.x):this.$container.x=-this.$overlapSize.x:this.$container.x=n);const l=createjs.Ticker.framerate,o=Ct.inst.curTime/1e3,$=Math.max(o-this.$lastMoveTime,1/l);let c=e.x-this.$lastTouchPos.x,d=e.y-this.$lastTouchPos.y;if(r||(c=0),h||(d=0),0!=$){const t=$*l-1;if(t>1){const e=Math.pow(.833,t);this.$velocity.x=this.$velocity.x*e,this.$velocity.y=this.$velocity.y*e}this.$velocity.x=Gt.lerp(this.$velocity.x,60*c/l/$,10*$),this.$velocity.y=Gt.lerp(this.$velocity.y,60*d/l/$,10*$)}const u=this.$lastTouchGlobalPos.x-e.x,p=this.$lastTouchGlobalPos.y-e.y;0!=c?this.$velocityScale=Math.abs(u/c):0!=d&&(this.$velocityScale=Math.abs(p/d)),this.$lastTouchPos.copy(e),this.$lastTouchGlobalPos.copy(e),this.$lastMoveTime=o,this.$overlapSize.x>0&&(this.$xPos=Gt.clamp(-this.$container.x,0,this.$overlapSize.x)),this.$overlapSize.y>0&&(this.$yPos=Gt.clamp(-this.$container.y,0,this.$overlapSize.y)),0!=this.$loop&&(n=this.$container.x,a=this.$container.y,this.loopCheckingCurrent()&&(this.$containerPos.x+=this.$container.x-n,this.$containerPos.y+=this.$container.y-a)),Vt.draggingPane=this,this.$isHoldAreaDone=!0,this.$isDragging=!0,this.syncScrollBar(),this.checkRefreshBar(),this.$pageMode&&this.updatePageController();let g=new createjs.Event("__scroll",!0,!1);this.dispatchEvent(g,this)}$mouseUp(){if(gt.GRoot.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),gt.GRoot.inst.nativeStage.off(s.Up,this.$mouseMoveEvent),gt.GRoot.inst.nativeStage.off(s.Click,this.$clickEvent),Vt.draggingPane==this&&(Vt.draggingPane=null),Vt.$gestureFlag=0,!this.$isDragging||!this.$touchEffect)return this.$isDragging=!1,void(this.$maskContainer.mouseEnabled=!0);this.$isDragging=!1,this.$maskContainer.mouseEnabled=!0,this.$tweenStart.setValues(this.$container.x,this.$container.y),Vt.sEndPos.setValues(this.$tweenStart.x,this.$tweenStart.y);let t=!1;if(this.$container.x>0?(Vt.sEndPos.x=0,t=!0):this.$container.x<-this.$overlapSize.x&&(Vt.sEndPos.x=-this.$overlapSize.x,t=!0),this.$container.y>0?(Vt.sEndPos.y=0,t=!0):this.$container.y<-this.$overlapSize.y&&(Vt.sEndPos.y=-this.$overlapSize.y,t=!0),t){if(this.$tweenChange.setValues(Vt.sEndPos.x-this.$tweenStart.x,Vt.sEndPos.y-this.$tweenStart.y),this.$tweenChange.x<-S.touchDragSensitivity||this.$tweenChange.y<-S.touchDragSensitivity){this.$refreshEventDispatching=!0;let t=new createjs.Event("__pullDownRelease",!0,!1);this.dispatchEvent(t,this),this.$refreshEventDispatching=!1}else if(this.$tweenChange.x>S.touchDragSensitivity||this.$tweenChange.y>S.touchDragSensitivity){this.$refreshEventDispatching=!0;let t=new createjs.Event("__pullUpRelease",!0,!1);this.dispatchEvent(t,this),this.$refreshEventDispatching=!1}if(this.$headerLockedSize>0&&0==Vt.sEndPos[this.$refreshBarAxis])Vt.sEndPos[this.$refreshBarAxis]=this.$headerLockedSize,this.$tweenChange.x=Vt.sEndPos.x-this.$tweenStart.x,this.$tweenChange.y=Vt.sEndPos.y-this.$tweenStart.y;else if(this.$footerLockedSize>0&&Vt.sEndPos[this.$refreshBarAxis]==-this.$overlapSize[this.$refreshBarAxis]){var e=this.$overlapSize[this.$refreshBarAxis];0==e?e=Math.max(this.$contentSize[this.$refreshBarAxis]+this.$footerLockedSize-this.$viewSize[this.$refreshBarAxis],0):e+=this.$footerLockedSize,Vt.sEndPos[this.$refreshBarAxis]=-e,this.$tweenChange.x=Vt.sEndPos.x-this.$tweenStart.x,this.$tweenChange.y=Vt.sEndPos.y-this.$tweenStart.y}this.$tweenDuration.setValues(Vt.TWEEN_DEFAULT_DURATION,Vt.TWEEN_DEFAULT_DURATION)}else{if(this.$inertiaDisabled)this.$tweenDuration.setValues(Vt.TWEEN_DEFAULT_DURATION,Vt.TWEEN_DEFAULT_DURATION);else{const t=createjs.Ticker.framerate,e=(Ct.inst.curTime/1e3-this.$lastMoveTime)*t-1;if(e>1){const t=Math.pow(.833,e);this.$velocity.x=this.$velocity.x*t,this.$velocity.y=this.$velocity.y*t}this.updateTargetAndDuration(this.$tweenStart,Vt.sEndPos)}if(Vt.sOldChange.setValues(Vt.sEndPos.x-this.$tweenStart.x,Vt.sEndPos.y-this.$tweenStart.y),this.loopCheckingTarget(Vt.sEndPos),(this.$pageMode||this.$snapToItem)&&this.alignPosition(Vt.sEndPos,!0),this.$tweenChange.x=Vt.sEndPos.x-this.$tweenStart.x,this.$tweenChange.y=Vt.sEndPos.y-this.$tweenStart.y,0==this.$tweenChange.x&&0==this.$tweenChange.y)return void(this.$scrollBarDisplayAuto&&this.showScrollBar(!1));(this.$pageMode||this.$snapToItem)&&(this.fixDuration("x",Vt.sOldChange.x),this.fixDuration("y",Vt.sOldChange.y))}this.$tweening=2,this.$tweenTime.setValues(0,0),Ct.inst.addLoop(1,this.tweenUpdate,this)}$click(){this.$isDragging=!1}$mouseWheel(t){let e=t.data.event;if(!this.$mouseWheelEnabled)return;const i=e.delta>0?-1:e.delta<0?1:0;this.$overlapSize.x>0&&0==this.$overlapSize.y?this.$pageMode?this.setPosX(this.$xPos+this.$pageSize.x*i,!1):this.setPosX(this.$xPos+this.$mouseWheelSpeed*i,!1):this.$pageMode?this.setPosY(this.$yPos+this.$pageSize.y*i,!1):this.setPosY(this.$yPos+this.$mouseWheelSpeed*i,!1)}$rollOver(){this.showScrollBar(!0)}$rollOut(){this.showScrollBar(!1)}showScrollBar(t){t?(Ct.inst.remove(this.setScrollBarVisible,this),this.setScrollBarVisible(!0)):Ct.inst.add(500,1,this.setScrollBarVisible,this,t)}setScrollBarVisible(t){this.$scrollBarVisible=t&&this.$viewSize.x>0&&this.$viewSize.y>0,this.$vtScrollBar&&(this.$vtScrollBar.displayObject.visible=this.$scrollBarVisible&&!this.$vScrollNone),this.$hzScrollBar&&(this.$hzScrollBar.displayObject.visible=this.$scrollBarVisible&&!this.$hScrollNone)}getLoopPartSize(t,e){return(this.$contentSize[e]+0)/t}loopCheckingCurrent(){let t=!1;return 1==this.$loop&&this.$overlapSize.x>0?this.$xPos<.001?(this.$xPos+=this.getLoopPartSize(2,"x"),t=!0):this.$xPos>=this.$overlapSize.x&&(this.$xPos-=this.getLoopPartSize(2,"x"),t=!0):2==this.$loop&&this.$overlapSize.y>0&&(this.$yPos<.001?(this.$yPos+=this.getLoopPartSize(2,"y"),t=!0):this.$yPos>=this.$overlapSize.y&&(this.$yPos-=this.getLoopPartSize(2,"y"),t=!0)),t&&this.$container.set({x:Math.floor(-this.$xPos),y:Math.floor(-this.$yPos)}),t}loopCheckingTarget(t){1==this.$loop&&this.loopCheckingTarget2(t,"x"),2==this.$loop&&this.loopCheckingTarget2(t,"y")}loopCheckingTarget2(t,e){let i,s;t[e]>0?(i=this.getLoopPartSize(2,e),s=this.$tweenStart[e]-i,s<=0&&s>=-this.$overlapSize[e]&&(t[e]-=i,this.$tweenStart[e]=s)):t[e]<-this.$overlapSize[e]&&(i=this.getLoopPartSize(2,e),s=this.$tweenStart[e]+i,s<=0&&s>=-this.$overlapSize[e]&&(t[e]+=i,this.$tweenStart[e]=s))}loopCheckingNewPos(t,e){if(0==this.$overlapSize[e])return t;let i,s="x"==e?this.$xPos:this.$yPos,h=!1;return t<.001?(t+=this.getLoopPartSize(2,e))>s&&(i=this.getLoopPartSize(6,e),i=Math.ceil((t-s)/i)*i,s=Gt.clamp(s+i,0,this.$overlapSize[e]),h=!0):t>=this.$overlapSize[e]&&(t-=this.getLoopPartSize(2,e))<s&&(i=this.getLoopPartSize(6,e),i=Math.ceil((s-t)/i)*i,s=Gt.clamp(s-i,0,this.$overlapSize[e]),h=!0),h&&("x"==e?this.$container.x=-Math.floor(s):this.$container.y=-Math.floor(s)),t}alignPosition(t,e){if(this.$pageMode)t.x=this.alignByPage(t.x,"x",e),t.y=this.alignByPage(t.y,"y",e);else if(this.$snapToItem){var i=this.$owner.getSnappingPosition(-t.x,-t.y,Vt.sHelperPoint);t.x<0&&t.x>-this.$overlapSize.x&&(t.x=-i.x),t.y<0&&t.y>-this.$overlapSize.y&&(t.y=-i.y)}}alignByPage(t,e,i){let s;if(t>0)s=0;else if(t<-this.$overlapSize[e])s=Math.ceil(this.$contentSize[e]/this.$pageSize[e])-1;else{s=Math.floor(-t/this.$pageSize[e]);var h=i?t-this.$containerPos[e]:t-this.$container[e],r=Math.min(this.$pageSize[e],this.$contentSize[e]-(s+1)*this.$pageSize[e]),n=-t-s*this.$pageSize[e];Math.abs(h)>this.$pageSize[e]?n>.5*r&&s++:n>r*(h<0?.3:.7)&&s++;const a=this.$pageSize[e];(t=-s*a)<-a&&(t=-a)}if(i){var a,l=this.$tweenStart[e];a=l>0?0:l<-this.$overlapSize[e]?Math.ceil(this.$contentSize[e]/this.$pageSize[e])-1:Math.floor(-l/this.$pageSize[e]);var o=Math.floor(-this.$containerPos[e]/this.$pageSize[e]);Math.abs(s-o)>1&&Math.abs(a-o)<=1&&(s=s>o?o+1:o-1,t=-s*this.$pageSize[e])}return t}updateTargetAndDuration(t,e){e.x=this.updateTargetAndDuration2(t.x,"x"),e.y=this.updateTargetAndDuration2(t.y,"y")}updateTargetAndDuration2(t,e){let i=this.$velocity[e];var s=0;if(t>0)t=0;else if(t<-this.$overlapSize[e])t=-this.$overlapSize[e];else{let h=Math.abs(i)*this.$velocityScale;Nt.any&&(h*=Math.max(gt.GRoot.inst.stageWrapper.designWidth,gt.GRoot.inst.stageWrapper.designHeight)/Math.max(gt.GRoot.inst.stageWidth,gt.GRoot.inst.stageHeight));let r=0;if(this.$pageMode||!Nt.any?h>500&&(r=Math.pow((h-500)/500,2)):h>1e3&&(r=Math.pow((h-1e3)/1e3,2)),0!=r){r>1&&(r=1),h*=r,i*=r,this.$velocity[e]=i,s=Math.log(60/h)/Math.log(this.$decelerationRate)/60;t+=(i/60-1)/(1-this.$decelerationRate)}}return s<Vt.TWEEN_DEFAULT_DURATION&&(s=Vt.TWEEN_DEFAULT_DURATION),this.$tweenDuration[e]=s,t}fixDuration(t,e){if(0==this.$tweenChange[t]||Math.abs(this.$tweenChange[t])>=Math.abs(e))return;let i=Math.abs(this.$tweenChange[t]/e)*this.$tweenDuration[t];i<Vt.TWEEN_DEFAULT_DURATION&&(i=Vt.TWEEN_DEFAULT_DURATION),this.$tweenDuration[t]=i}killTween(){if(1==this.$tweening){this.$container.set({x:this.$tweenStart.x+this.$tweenChange.x,y:this.$tweenStart.y+this.$tweenChange.y});let t=new createjs.Event("__scroll",!0,!1);this.dispatchEvent(t,this)}this.$tweening=0,Ct.inst.remove(this.tweenUpdate,this);let t=new createjs.Event("__scrollEnd",!0,!1);this.dispatchEvent(t,this)}checkRefreshBar(){if(null==this.$header&&null==this.$footer)return;const t=this.$container[this.$refreshBarAxis];if(null!=this.$header)if(t>0){null==this.$header.displayObject.parent&&this.$maskContainer.addChildAt(this.$header.displayObject,0);const e=Vt.sHelperPoint;e.setValues(this.$header.width,this.$header.height),e[this.$refreshBarAxis]=t,this.$header.setSize(e.x,e.y)}else null!=this.$header.displayObject.parent&&this.$maskContainer.removeChild(this.$header.displayObject);if(null!=this.$footer){var e=this.$overlapSize[this.$refreshBarAxis];if(t<-e||0==e&&this.$footerLockedSize>0){null==this.$footer.displayObject.parent&&this.$maskContainer.addChildAt(this.$footer.displayObject,0);const i=Vt.sHelperPoint;i.setValues(this.$footer.x,this.$footer.y),i[this.$refreshBarAxis]=e>0?t+this.$contentSize[this.$refreshBarAxis]:Math.max(Math.min(t+this.$viewSize[this.$refreshBarAxis],this.$viewSize[this.$refreshBarAxis]-this.$footerLockedSize),this.$viewSize[this.$refreshBarAxis]-this.$contentSize[this.$refreshBarAxis]),this.$footer.setXY(i.x,i.y),i.setValues(this.$footer.width,this.$footer.height),i[this.$refreshBarAxis]=e>0?-e-t:this.$viewSize[this.$refreshBarAxis]-this.$footer[this.$refreshBarAxis],this.$footer.setSize(i.x,i.y)}else null!=this.$footer.displayObject.parent&&this.$maskContainer.removeChild(this.$footer.displayObject)}}tweenUpdate(){var t=this.runTween("x"),e=this.runTween("y");if(this.$container.set({x:t,y:e}),2==this.$tweening&&(this.$overlapSize.x>0&&(this.$xPos=Gt.clamp(-t,0,this.$overlapSize.x)),this.$overlapSize.y>0&&(this.$yPos=Gt.clamp(-e,0,this.$overlapSize.y)),this.$pageMode&&this.updatePageController()),0==this.$tweenChange.x&&0==this.$tweenChange.y){this.$tweening=0,Ct.inst.remove(this.tweenUpdate,this),this.loopCheckingCurrent(),this.syncScrollBar(!0),this.checkRefreshBar();let t=new createjs.Event("__scroll",!0,!1);this.dispatchEvent(t,this);let e=new createjs.Event("__scrollEnd",!0,!1);this.dispatchEvent(e,this)}else{this.syncScrollBar(!1),this.checkRefreshBar();let t=new createjs.Event("__scroll",!0,!1);this.dispatchEvent(t,this)}}runTween(t){const e=createjs.Ticker.interval;let i;if(0!=this.$tweenChange[t]){if(this.$tweenTime[t]+=e*createjs.Ticker.framerate,this.$tweenTime[t]>=this.$tweenDuration[t])i=this.$tweenStart[t]+this.$tweenChange[t],this.$tweenChange[t]=0;else{const e=Vt.$easeTypeFunc(this.$tweenTime[t],this.$tweenDuration[t]);i=this.$tweenStart[t]+Math.floor(this.$tweenChange[t]*e)}var s=0,h=-this.$overlapSize[t];if(this.$headerLockedSize>0&&this.$refreshBarAxis==t&&(s=this.$headerLockedSize),this.$footerLockedSize>0&&this.$refreshBarAxis==t){var r=this.$overlapSize[this.$refreshBarAxis];0==r?r=Math.max(this.$contentSize[this.$refreshBarAxis]+this.$footerLockedSize-this.$viewSize[this.$refreshBarAxis],0):r+=this.$footerLockedSize,h=-r}2==this.$tweening&&this.$bouncebackEffect?i>20+s&&this.$tweenChange[t]>0||i>s&&0==this.$tweenChange[t]?(this.$tweenTime[t]=0,this.$tweenDuration[t]=Vt.TWEEN_DEFAULT_DURATION,this.$tweenChange[t]=-i+s,this.$tweenStart[t]=i):(i<h-20&&this.$tweenChange[t]<0||i<h&&0==this.$tweenChange[t])&&(this.$tweenTime[t]=0,this.$tweenDuration[t]=Vt.TWEEN_DEFAULT_DURATION,this.$tweenChange[t]=h-i,this.$tweenStart[t]=i):i>s?(i=s,this.$tweenChange[t]=0):i<h&&(i=h,this.$tweenChange[t]=0)}else i=this.$container[t];return i}}Vt.$easeTypeFunc=(t,e)=>(t=t/e-1)*t*t+1,Vt.$gestureFlag=0,Vt.sHelperPoint=new createjs.Point,Vt.sHelperRect=new createjs.Rectangle,Vt.sEndPos=new createjs.Point,Vt.sOldChange=new createjs.Point,Vt.TWEEN_DEFAULT_DURATION=.4,Vt.TWEEN_MANUALLY_SET_DURATION=.5,Vt.PULL_DIST_RATIO=.5;class Ut{static create(t,e,...i){return e?function(){let s=arguments.length>0?[].concat(Array.prototype.slice.call(arguments)).concat(i):[].concat(i);t.apply(e,s)}:t}}class Xt{constructor(t){this.autoPlayRepeat=1,this.autoPlayDelay=0,this.$ownerBaseX=0,this.$ownerBaseY=0,this.$totalTimes=0,this.$startTime=0,this.$totalTasks=0,this.$playing=!1,this.$options=0,this.$maxTime=0,this.$owner=t,this.$items=[],this.$owner.on("__visibleChanged",this.$ownerVisibleChanged,this)}$ownerVisibleChanged(t){let e=t.data;0==(this.$options&Xt.OPTION_AUTO_STOP_DISABLED)&&!1===e&&this.stop(0!=(this.$options&Xt.OPTION_AUTO_STOP_AT_END),!1)}get autoPlay(){return this.$autoPlay}set autoPlay(t){this.$autoPlay!=t&&(this.$autoPlay=t,this.$autoPlay?this.$owner.onStage&&this.play({times:this.autoPlayRepeat,delay:this.autoPlayDelay}):this.$owner.onStage||this.stop(!1,!0))}changeRepeat(t){this.$totalTimes=0|t}play(...t){if(t.length&&"object"==typeof t[0]){let e=t[0];this.$play(e.onComplete,e.onCompleteObj,e.onCompleteParam,e.times||1,e.delay||0,!1)}else this.$play(t[0],t[1],t[2],t[3]||1,t[4]||0,!1)}playReverse(...t){if(t.length&&"object"==typeof t[0]){let e=t[0];this.$play(e.onComplete,e.onCompleteObj,e.onCompleteParam,e.times||1,e.delay||0,!0)}else this.$play(t[0],t[1],t[2],t[3]||1,t[4]||0,!0)}$play(t,e,i,s,h,r=!1){this.stop(),0==s?s=1:-1==s&&(s=Number.MAX_VALUE),this.$totalTimes=s,this.$startTime=0,this.$reversed=r,this.internalPlay(h),this.$playing=this.$totalTasks>0,this.$playing?(this.$onComplete=t,this.$onCompleteParam=i,this.$onCompleteObj=e,0!=(this.$options&Xt.OPTION_IGNORE_DISPLAY_CONTROLLER)&&this.$items.forEach(t=>{null!=t.target&&t.target!=this.$owner&&(t.lockToken=t.target.lockGearDisplay())},this)):null!=t&&(i&&i.length?t.apply(e,i):t.call(e,i))}stop(t=!0,e=!1){if(this.$playing){this.$playing=!1,this.$totalTasks=0,this.$totalTimes=0;let i=this.$onComplete,s=this.$onCompleteParam,h=this.$onCompleteObj;this.$onComplete=null,this.$onCompleteParam=null,this.$onCompleteObj=null;let r,n=this.$items.length;if(this.$reversed)for(let e=n-1;e>=0;e--)r=this.$items[e],null!=r.target&&this.stopItem(r,t);else for(let e=0;e<n;e++)r=this.$items[e],null!=r.target&&this.stopItem(r,t);e&&null!=i&&(s&&s.length>0?i.apply(h,s):i.call(h,s))}}stopItem(t,e){if(0!=t.lockToken&&(t.target.releaseGearDisplay(t.lockToken),t.lockToken=0),12==t.type&&t.filterCreated&&(t.target.filters=null),!t.completed)if(this.disposeTween(t),10==t.type){let i=t.target.getTransition(t.value.s);null!=i&&i.stop(e,!1)}else 11==t.type?(Ct.inst.remove(t.$shake,t),t.target.$gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1,t.target.y-t.startValue.f2),t.target.$gearLocked=!1):e&&(t.tween?t.yoyo&&t.repeat%2!=0?this.applyValue(t,this.$reversed?t.endValue:t.startValue):this.applyValue(t,this.$reversed?t.startValue:t.endValue):9!=t.type&&this.applyValue(t,t.value))}dispose(){Ct.inst.remove(this.internalPlay,this),this.$owner.off("__visibleChanged",this.$ownerVisibleChanged),this.$playing=!1,this.$items.forEach(t=>{if(null!=t.target&&!t.completed)if(this.disposeTween(t),10==t.type){let e=t.target.getTransition(t.value.s);null!=e&&e.dispose()}else 11==t.type&&Ct.inst.remove(t.$shake,t)},this)}get playing(){return this.$playing}setValue(t,...e){this.$items.forEach(i=>{if(null==i.label&&null==i.label2)return;let s;if(i.label==t)s=i.tween?i.startValue:i.value;else{if(i.label2!=t)return;s=i.endValue}switch(i.type){case 0:case 1:case 3:case 2:case 13:s.b1=!0,s.b2=!0,s.f1=parseFloat(e[0]),s.f2=parseFloat(e[1]);break;case 4:s.f1=parseFloat(e[0]);break;case 5:s.i=parseInt(e[0]);break;case 6:s.c=e[0];break;case 7:s.i=parseInt(e[0]),e.length>1&&(s.b=e[1]);break;case 8:s.b=e[0];break;case 9:s.s=e[0],e.length>1&&(s.f1=parseFloat(e[1]));break;case 10:s.s=e[0],e.length>1&&(s.i=parseInt(e[1]));break;case 11:s.f1=parseFloat(e[0]),e.length>1&&(s.f2=parseFloat(e[1]));break;case 12:s.f1=parseFloat(e[0]),s.f2=parseFloat(e[1]),s.f3=parseFloat(e[2]),s.f4=parseFloat(e[3])}},this)}setHook(t,e,i){let s=this.$items.length;for(let h=0;h<s;h++){let s=this.$items[h];if(s.label==t){s.hook=e,s.hookObj=i;break}if(s.label2==t){s.hook2=e,s.hook2Obj=i;break}}}clearHooks(){this.$items.forEach(t=>{t.hook=null,t.hookObj=null,t.hook2=null,t.hook2Obj=null},this)}setTarget(t,e){this.$items.forEach(i=>{i.label==t&&(i.targetId=e.id)},this)}setDuration(t,e){this.$items.forEach(i=>{i.tween&&i.label==t&&(i.duration=e)},this)}updateFromRelations(t,e,i){this.$items.forEach(s=>{0==s.type&&s.targetId==t&&(s.tween?(s.startValue.f1+=e,s.startValue.f2+=i,s.endValue.f1+=e,s.endValue.f2+=i):(s.value.f1+=e,s.value.f2+=i))},this)}internalPlay(t=0){this.$ownerBaseX=this.$owner.x,this.$ownerBaseY=this.$owner.y,this.$totalTasks=0,this.$items.forEach(e=>{if(e.targetId?e.target=this.$owner.getChildById(e.targetId):e.target=this.$owner,null==e.target)return;let i;this.disposeTween(e),e.tween?(i=this.$reversed?t+this.$maxTime-e.time-e.duration:t+e.time,i>0?(this.$totalTasks++,e.completed=!1,e.tweener=createjs.Tween.get(e.value).wait(1e3*i).call(this.$delayCall,[e],this)):this.startTween(e)):(i=this.$reversed?t+this.$maxTime-e.time:t+e.time,i<=0?this.applyValue(e,e.value):(this.$totalTasks++,e.completed=!1,e.tweener=createjs.Tween.get(e.value).wait(1e3*i).call(this.$delayCall2,[e],this)))},this)}prepareValue(t,e,i=!1){let s,h;switch(i?(s=t.endValue,h=t.startValue):(s=t.startValue,h=t.endValue),t.type){case 0:case 1:0==t.type?t.target==this.$owner?(s.b1||(s.f1=0),s.b2||(s.f2=0)):(s.b1||(s.f1=t.target.x),s.b2||(s.f2=t.target.y)):(s.b1||(s.f1=t.target.width),s.b2||(s.f2=t.target.height)),t.value.f1=s.f1,t.value.f2=s.f2,h.b1||(h.f1=t.value.f1),h.b2||(h.f2=t.value.f2),t.value.b1=s.b1||h.b1,t.value.b2=s.b2||h.b2,e.f1=h.f1,e.f2=h.f2;break;case 2:case 13:t.value.f1=s.f1,t.value.f2=s.f2,e.f1=h.f1,e.f2=h.f2;break;case 4:t.value.f1=s.f1,e.f1=h.f1;break;case 5:t.value.i=s.i,e.i=h.i;break;case 12:t.value.f1=s.f1,t.value.f2=s.f2,t.value.f3=s.f3,t.value.f4=s.f4,e.f1=h.f1,e.f2=h.f2,e.f3=h.f3,e.f4=h.f4}}startTween(t){let e,i=new qt;this.prepareValue(t,i,this.$reversed),this.applyValue(t,t.value),0!=t.repeat?(t.tweenTimes=0,e=Ut.create(this.$tweenRepeatComplete,this,t)):e=Ut.create(this.$tweenComplete,this,t),this.$totalTasks++,t.completed=!1,this.prepareValue(t,i,this.$reversed),t.tweener=createjs.Tween.get(t.value,{onChange:Ut.create(this.$tweenUpdate,this,t)}).to(i,1e3*t.duration,t.easeType).call(e),null!=t.hook&&t.hook.call(t.hookObj)}$delayCall(t){this.disposeTween(t),this.$totalTasks--,this.startTween(t)}$delayCall2(t){this.disposeTween(t),this.$totalTasks--,t.completed=!0,this.applyValue(t,t.value),null!=t.hook&&t.hook.call(t.hookObj),this.checkAllComplete()}$tweenUpdate(t,e){this.applyValue(e,e.value)}$tweenComplete(t,e){this.disposeTween(e),this.$totalTasks--,e.completed=!0,null!=e.hook2&&e.hook2.call(e.hook2Obj),this.checkAllComplete()}$tweenRepeatComplete(t,e){if(e.tweenTimes++,-1==e.repeat||e.tweenTimes<e.repeat+1){let t,i=new qt;t=e.yoyo?this.$reversed?e.tweenTimes%2==0:e.tweenTimes%2==1:this.$reversed,this.prepareValue(e,i,t),this.disposeTween(e),e.tweener=createjs.Tween.get(e.value,{onChange:Ut.create(this.$tweenUpdate,this,e)}).to(i,1e3*e.duration,e.easeType).call(this.$tweenRepeatComplete,[null,e],this)}else this.$tweenComplete(null,e)}disposeTween(t){t&&t.tweener&&(t.tweener.paused=!0,t.tweener.removeAllEventListeners(),createjs.Tween.removeTweens(t.value),t.tweener=null)}$playTransComplete(t){this.disposeTween(t),this.$totalTasks--,t.completed=!0,this.checkAllComplete()}checkAllComplete(){if(this.$playing&&0==this.$totalTasks)if(this.$totalTimes<0)Ct.inst.callLater(this.internalPlay,this,0);else if(this.$totalTimes--,this.$totalTimes>0)Ct.inst.callLater(this.internalPlay,this,0);else if(this.$playing=!1,this.$items.forEach(t=>{null!=t.target&&(0!=t.lockToken&&(t.target.releaseGearDisplay(t.lockToken),t.lockToken=0),t.filterCreated&&(t.filterCreated=!1,t.target.filters=null),this.disposeTween(t))}),null!=this.$onComplete){let t=this.$onComplete,e=this.$onCompleteParam,i=this.$onCompleteObj;this.$onComplete=null,this.$onCompleteParam=null,this.$onCompleteObj=null,e&&e.length?t.apply(i,e):t.call(i,e)}}applyValue(t,e){switch(t.target.$gearLocked=!0,t.type){case 0:if(t.target==this.$owner){let i=0,s=0;i=e.b1?e.f1+this.$ownerBaseX:t.target.x,s=e.b2?e.f2+this.$ownerBaseY:t.target.y,t.target.setXY(i,s)}else e.b1||(e.f1=t.target.x),e.b2||(e.f2=t.target.y),t.target.setXY(e.f1,e.f2);break;case 1:e.b1||(e.f1=t.target.width),e.b2||(e.f2=t.target.height),t.target.setSize(e.f1,e.f2);break;case 3:t.target.setPivot(e.f1,e.f2);break;case 4:t.target.alpha=e.f1;break;case 5:t.target.rotation=e.i;break;case 2:t.target.setScale(e.f1,e.f2);break;case 13:t.target.setSkew(e.f1,e.f2);break;case 6:nt(t.target)&&(t.target.color=e.c);break;case 7:lt(t.target)&&(e.b1||(e.i=t.target.frame),t.target.frame=e.i,t.target.playing=e.b);break;case 8:t.target.visible=e.b;break;case 10:let s=t.target.getTransition(e.s);null!=s&&(0==e.i?s.stop(!1,!0):s.playing?s.$totalTimes=-1==e.i?Number.MAX_VALUE:e.i:(t.completed=!1,this.$totalTasks++,this.$reversed?s.playReverse(this.$playTransComplete,this,t,t.value.i):s.play(this.$playTransComplete,this,t,t.value.i)));break;case 9:if(this.$playing&&t.time>=this.$startTime){if(!e.audioClip){var i=q.getItemByURL(e.s);i&&(e.audioClip=i.owner.getItemAsset(i))}e.audioClip&&gt.GRoot.inst.playOneShotSound(e.audioClip,e.f1)}break;case 11:t.startValue.f1=0,t.startValue.f2=0,t.startValue.f3=t.value.f2,Ct.inst.add(1,0,t.$shake,t,[this]),this.$totalTasks++,t.completed=!1;break;case 12:t.target.updateColorComponents(e.f1,e.f2,e.f3,e.f4)}t.target.$gearLocked=!1}$shakeItem(t,e){let i=Math.ceil(t.value.f1*t.startValue.f3/t.value.f2),s=(2*Math.random()-1)*i,h=(2*Math.random()-1)*i;s=s>0?Math.ceil(s):Math.floor(s),h=h>0?Math.ceil(h):Math.floor(h),t.target.$gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1+s,t.target.y-t.startValue.f2+h),t.target.$gearLocked=!1,t.startValue.f1=s,t.startValue.f2=h,t.startValue.f3-=e/1e3,t.startValue.f3<=0&&(t.target.$gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1,t.target.y-t.startValue.f2),t.target.$gearLocked=!1,t.completed=!0,this.$totalTasks--,Ct.inst.remove(t.$shake,t),this.checkAllComplete())}setup(t){this.name=t.attributes.name;let e=t.attributes.options;e&&(this.$options=parseInt(e)),this.$autoPlay="true"==t.attributes.autoPlay,this.$autoPlay&&(e=t.attributes.autoPlayRepeat,e&&(this.autoPlayRepeat=parseInt(e)),e=t.attributes.autoPlayDelay,e&&(this.autoPlayDelay=parseFloat(e))),t.children.forEach(t=>{if("item"!=t.nodeName)return;let i=new Yt;switch(this.$items.push(i),i.time=parseInt(t.attributes.time)/Xt.FRAME_RATE,i.targetId=t.attributes.target,e=t.attributes.type,e){case"XY":i.type=0;break;case"Size":i.type=1;break;case"Scale":i.type=2;break;case"Pivot":i.type=3;break;case"Alpha":i.type=4;break;case"Rotation":i.type=5;break;case"Color":i.type=6;break;case"Animation":i.type=7;break;case"Visible":i.type=8;break;case"Sound":i.type=9;break;case"Transition":i.type=10;break;case"Shake":i.type=11;break;case"ColorFilter":i.type=12;break;case"Skew":i.type=13;break;default:i.type=14}if(i.tween="true"==t.attributes.tween,i.label=t.attributes.label,i.tween){i.duration=parseInt(t.attributes.duration)/Xt.FRAME_RATE,i.time+i.duration>this.$maxTime&&(this.$maxTime=i.time+i.duration),e=t.attributes.ease,e&&(i.easeType=x(e)),e=t.attributes.repeat,e&&(i.repeat=parseInt(e)),i.yoyo="true"==t.attributes.yoyo,i.label2=t.attributes.label2;let s=t.attributes.endValue;s?(this.decodeValue(i.type,t.attributes.startValue,i.startValue),this.decodeValue(i.type,s,i.endValue)):(i.tween=!1,this.decodeValue(i.type,t.attributes.startValue,i.value))}else i.time>this.$maxTime&&(this.$maxTime=i.time),this.decodeValue(i.type,t.attributes.value,i.value)},this)}decodeValue(t,e,i){let s;switch(t){case 0:case 1:case 3:case 13:s=e.split(","),"-"==s[0]?i.b1=!1:(i.f1=parseFloat(s[0]),i.b1=!0),"-"==s[1]?i.b2=!1:(i.f2=parseFloat(s[1]),i.b2=!0);break;case 4:i.f1=parseFloat(e);break;case 5:i.i=parseInt(e);break;case 2:s=e.split(","),i.f1=parseFloat(s[0]),i.f2=parseFloat(s[1]);break;case 6:i.c=H.HEX2RGB(e);break;case 7:s=e.split(","),"-"==s[0]?i.b1=!1:(i.i=parseInt(s[0]),i.b1=!0),i.b="p"==s[1];break;case 8:i.b="true"==e;break;case 9:if(s=e.split(","),i.s=s[0],s.length>1){let t=parseInt(s[1]);i.f1=0==t||100==t?1:t/100}else i.f1=1;break;case 10:s=e.split(","),i.s=s[0],s.length>1?i.i=parseInt(s[1]):i.i=1;break;case 11:s=e.split(","),i.f1=parseFloat(s[0]),i.f2=parseFloat(s[1]);break;case 12:s=e.split(","),i.f1=parseFloat(s[0]),i.f2=parseFloat(s[1]),i.f3=parseFloat(s[2]),i.f4=parseFloat(s[3])}}}Xt.OPTION_IGNORE_DISPLAY_CONTROLLER=1,Xt.OPTION_AUTO_STOP_DISABLED=0,Xt.OPTION_AUTO_STOP_AT_END=0,Xt.FRAME_RATE=24;class Yt{constructor(){this.time=0,this.type=0,this.duration=0,this.repeat=0,this.yoyo=!1,this.tween=!1,this.tweenTimes=0,this.completed=!1,this.lockToken=0,this.easeType=x("Quad.Out"),this.value=new qt,this.startValue=new qt,this.endValue=new qt}$shake(t,e){t.$shakeItem(this,e)}}class qt{constructor(){this.f1=0,this.f2=0,this.f3=0,this.f4=0,this.i=0,this.b=!1,this.b1=!0,this.b2=!0}}class Kt{constructor(){this.left=0,this.right=0,this.top=0,this.bottom=0}parse(t){if(!t)return void(this.left=this.right=this.top=this.bottom=0);let e=t.split(",");if(1==e.length){let t=parseInt(e[0]);this.left=this.right=this.top=this.bottom=t}else this.top=parseInt(e[0]),this.bottom=parseInt(e[1]),this.left=parseInt(e[2]),this.right=parseInt(e[3])}copy(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right}}class Qt extends pt{constructor(){super(),this.$sortingChildCount=0,this.$children=[],this.$controllers=[],this.$transitions=[],this.$margin=new Kt,this.$alignOffset=new createjs.Point}createDisplayObject(){this.$rootContainer=new i(this),this.setDisplayObject(this.$rootContainer),this.$container=this.$rootContainer}dispose(){Ct.inst.remove(this.$validate,this),this.off("added",this.$added),this.off("removed",this.$removed),this.$transitions.forEach(t=>{t.dispose()});for(let t=this.$children.length-1;t>=0;--t){let e=this.$children[t];e.parent=null,e.dispose()}this.$boundsChanged=!1,this.$scrollPane&&this.$scrollPane.dispose(),super.dispose()}get displayListContainer(){return this.$container}addChild(t){return this.addChildAt(t,this.$children.length),t}addChildAt(t,e=0){if(!t)throw new Error("Invalid child");let i=this.$children.length;if(e>=0&&e<=i){if(t.parent==this)this.setChildIndex(t,e);else{t.removeFromParent(),t.parent=this;let i=this.$children.length;0!=t.sortingOrder?(this.$sortingChildCount++,e=this.getInsertPosForSortingChild(t)):this.$sortingChildCount>0&&e>i-this.$sortingChildCount&&(e=i-this.$sortingChildCount),e==i?this.$children.push(t):this.$children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()}return t}throw new Error("Invalid child index")}getInsertPosForSortingChild(t){let e=this.$children.length,i=0;for(i=0;i<e;i++){let e=this.$children[i];if(e!=t&&t.sortingOrder<e.sortingOrder)break}return i}removeChild(t,e=!1){let i=this.$children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t}removeChildAt(t,e=!1){if(t>=0&&t<this.numChildren){let i=this.$children[t];return i.parent=null,0!=i.sortingOrder&&this.$sortingChildCount--,this.$children.splice(t,1),i.inContainer&&this.$container.removeChild(i.displayObject),!0===e&&i.dispose(),this.setBoundsChangedFlag(),i}throw new Error("Invalid child index")}removeChildren(t=0,e=-1,i=!1){(e<0||e>=this.numChildren)&&(e=this.numChildren-1);for(let s=t;s<=e;++s)this.removeChildAt(t,i)}getChildAt(t=0){if(t>=0&&t<this.numChildren)return this.$children[t];throw new Error("Invalid child index")}getChild(t){let e=this.$children.length;for(let i=0;i<e;++i)if(this.$children[i].name==t)return this.$children[i];return null}getChildInGroup(t,e){let i=this.$children.length;for(let s=0;s<i;++s){let i=this.$children[s];if(i.group==e&&i.name==t)return i}return null}getChildById(t){let e=this.$children.length;for(let i=0;i<e;++i)if(this.$children[i].id==t)return this.$children[i];return null}getChildIndex(t){return this.$children.indexOf(t)}setChildIndex(t,e=0){let i=this.$children.indexOf(t);if(-1==i)throw new Error("no such child found");if(0!=t.sortingOrder)return;let s=this.$children.length;this.$sortingChildCount>0&&e>s-this.$sortingChildCount-1&&(e=s-this.$sortingChildCount-1),this.$setChildIndex(t,i,e)}setChildIndexBefore(t,e){let i=this.$children.indexOf(t);if(-1==i)throw new Error("no such child found");if(0!=t.sortingOrder)return i;let s=this.$children.length;return this.$sortingChildCount>0&&e>s-this.$sortingChildCount-1&&(e=s-this.$sortingChildCount-1),i<e?this.$setChildIndex(t,i,e-1):this.$setChildIndex(t,i,e)}$setChildIndex(t,e,i=0){let s=this.$children.length;if(i>s&&(i=s),e==i)return e;if(this.$children.splice(e,1),this.$children.splice(i,0,t),t.inContainer){let e=0,s=this.$container.children.length;for(let t=0;t<i;t++){this.$children[t].inContainer&&e++}e==s&&e--,this.$container.setChildIndex(t.displayObject,e),this.setBoundsChangedFlag()}return i}swapChildren(t,e){let i=this.$children.indexOf(t),s=this.$children.indexOf(e);if(-1==i||-1==s)throw new Error("no such child found");this.swapChildrenAt(i,s)}swapChildrenAt(t,e=0){let i=this.$children[t],s=this.$children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)}get numChildren(){return this.$children.length}isAncestorOf(t){if(null==t)return!1;let e=t.parent;for(;e;){if(e==this)return!0;e=e.parent}return!1}addController(t){this.$controllers.push(t),t.$parent=this,this.applyController(t)}getControllerAt(t){return this.$controllers[t]}getController(t){let e=this.$controllers.length;for(let i=0;i<e;++i){let e=this.$controllers[i];if(e.name==t)return e}return null}removeController(t){let e=this.$controllers.indexOf(t);if(-1==e)throw new Error("controller not exists");t.$parent=null,this.$controllers.splice(e,1),this.$children.forEach(e=>{e.handleControllerChanged(t)})}get controllers(){return this.$controllers}childStateChanged(t){if(!this.$buildingDisplayList)if(t instanceof ft)this.$children.forEach(e=>{e.group==t&&this.childStateChanged(e)},this);else if(t.displayObject)if(t.finalVisible){if(!t.displayObject.parent){let e=0,i=this.$children.length;for(let s=0;s<i;s++){let i=this.$children[s];if(i==t)break;i.displayObject&&i.displayObject.parent&&e++}this.$container.addChildAt(t.displayObject,e)}}else t.displayObject.parent&&this.$container.removeChild(t.displayObject)}applyController(t){this.$applyingController=t,this.$children.forEach(e=>{e.handleControllerChanged(t)}),this.$applyingController=null,t.executeActions()}applyAllControllers(){this.$controllers.forEach(t=>{this.applyController(t)},this)}adjustRadioGroupDepth(t,e){let i=-1,s=-1;this.$children.forEach((h,r)=>{h==t?i=r:"relatedController"in h&&h.relatedController==e&&r>s&&(s=r)}),i<s&&(null!=this.$applyingController&&this.$children[s].handleControllerChanged(this.$applyingController),this.swapChildrenAt(i,s))}getTransitionAt(t){return this.$transitions[t]}getTransition(t){let e=this.$transitions.length;for(let i=0;i<e;++i){let e=this.$transitions[i];if(e.name==t)return e}return null}isChildInView(t){return null!=this.$rootContainer.scrollRect?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:null==this.$scrollPane||this.$scrollPane.isChildInView(t)}getFirstChildInView(){let t=this.$children.length;for(let e=0;e<t;++e){let t=this.$children[e];if(this.isChildInView(t))return e}return-1}get scrollPane(){return this.$scrollPane}get opaque(){return this.$opaque}set opaque(t){this.$opaque!=t&&(this.$opaque=t,this.$opaque?this.updateOpaque():this.$rootContainer.hitArea&&this.$rootContainer.hitArea instanceof createjs.DisplayObject&&(this.$rootContainer.hitArea=null))}get margin(){return this.$margin}set margin(t){this.$margin.copy(t),null!=this.$rootContainer.scrollRect&&(this.$container.x=this.$margin.left+this.$alignOffset.x,this.$container.y=this.$margin.top+this.$alignOffset.y),this.handleSizeChanged()}get mask(){return this.$rootContainer.mask}set mask(t){t&&t instanceof createjs.Shape&&(this.$rootContainer.mask=t)}updateOpaque(){}updateScrollRect(){let t=this.$rootContainer.scrollRect;null==t&&(t=new createjs.Rectangle);let e=this.width-this.$margin.right,i=this.height-this.$margin.bottom;t.x=t.y=0,t.width=e,t.height=i,this.$rootContainer.scrollRect=t}setupScroll(t,e,i,s,h,r,n,a){this.$rootContainer==this.$container&&(this.$container=new createjs.Container,this.$rootContainer.addChild(this.$container)),this.$scrollPane=new Vt(this,e,t,i,s,h,r,n,a)}setupOverflow(t){1==t?(this.$rootContainer==this.$container&&(this.$container=new createjs.Container,this.$rootContainer.addChild(this.$container)),this.updateScrollRect(),this.$container.x=this.$margin.left,this.$container.y=this.$margin.top):0==this.$margin.left&&0==this.$margin.top||(this.$rootContainer==this.$container&&(this.$container=new createjs.Container,this.$rootContainer.addChild(this.$container)),this.$container.x=this.$margin.left,this.$container.y=this.$margin.top),this.setBoundsChangedFlag()}handleSizeChanged(){this.$scrollPane?this.$scrollPane.onOwnerSizeChanged():null!=this.$rootContainer.scrollRect&&this.updateScrollRect(),this.$hitArea&&this.$hitArea.graphics.drawRect(this.x,this.y,this.width,this.height),this.parent&&this.parent.$hitArea&&(console.log(1),this.parent.$displayObject.hitArea=null),this.$opaque&&this.updateOpaque()}handleGrayedChanged(){let t=this.getController("grayed");null!=t?t.selectedIndex=this.grayed?1:0:super.handleGrayedChanged()}setBoundsChangedFlag(){(this.$scrollPane||this.$trackBounds)&&(this.$boundsChanged||(this.$boundsChanged=!0,Ct.inst.callLater(this.$validate,this)))}$validate(t){this.$boundsChanged&&this.updateBounds()}ensureBoundsCorrect(){this.$boundsChanged&&this.updateBounds()}updateBounds(){let t=0,e=0,i=0,s=0;if(this.$children.length>0){t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;let h=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=0;this.$children.forEach(i=>{i.ensureSizeCorrect(),n=i.x,n<t&&(t=n),n=i.y,n<e&&(e=n),n=i.x+i.actualWidth,n>h&&(h=n),n=i.y+i.actualHeight,n>r&&(r=n)}),i=h-t,s=r-e}this.setBounds(t,e,i,s)}setBounds(t,e,i,s=0){this.$boundsChanged=!1,this.$scrollPane&&this.$scrollPane.setContentSize(Math.round(t+i),Math.round(e+s))}get viewWidth(){return null!=this.$scrollPane?this.$scrollPane.viewWidth:this.width-this.$margin.left-this.$margin.right}set viewWidth(t){null!=this.$scrollPane?this.$scrollPane.viewWidth=t:this.width=t+this.$margin.left+this.$margin.right}get viewHeight(){return null!=this.$scrollPane?this.$scrollPane.viewHeight:this.height-this.$margin.top-this.$margin.bottom}set viewHeight(t){null!=this.$scrollPane?this.$scrollPane.viewHeight=t:this.height=t+this.$margin.top+this.$margin.bottom}getSnappingPosition(t,e,i){i||(i=new createjs.Point);let s=this.$children.length;if(s<=0)return i.x=0,i.y=0,i;this.ensureBoundsCorrect();let h=null,r=null,n=0;if(0!=e){for(;n<s;n++)if(h=this.$children[n],e<h.y){if(0==n){e=0;break}r=this.$children[n-1],e=e<r.y+r.actualHeight/2?r.y:h.y;break}n==s&&(e=h.y)}if(0!=t){for(n>0&&n--;n<s;n++)if(h=this.$children[n],t<h.x){if(0==n){t=0;break}r=this.$children[n-1],t=t<r.x+r.actualWidth/2?r.x:h.x;break}n==s&&(t=h.x)}return i.x=t,i.y=e,i}childSortingOrderChanged(t,e,i=0){if(0==i)this.$sortingChildCount--,this.setChildIndex(t,this.$children.length);else{0==e&&this.$sortingChildCount++;let i=this.$children.indexOf(t),s=this.getInsertPosForSortingChild(t);i<s?this.$setChildIndex(t,i,s-1):this.$setChildIndex(t,i,s)}}constructFromResource(){this.constructInternal(null,0)}constructInternal(t,e){let i,s,h,r=this.packageItem.owner.getItemAsset(this.packageItem);if(this.$inProgressBuilding=!0,i=r.attributes.size,s=i.split(","),this.$sourceWidth=parseInt(s[0]),this.$sourceHeight=parseInt(s[1]),this.$initWidth=this.$sourceWidth,this.$initHeight=this.$sourceHeight,this.setSize(this.$sourceWidth,this.$sourceHeight),i=r.attributes.pivot,i&&(s=i.split(","),i=r.attributes.anchor,this.internalSetPivot(parseFloat(s[0]),parseFloat(s[1]),"true"==i)),i=r.attributes.opaque,this.opaque="false"!=i,i=r.attributes.overflow,h=i?n(i):0,i=r.attributes.margin,i&&this.$margin.parse(i),2==h){let t,e,h;i=r.attributes.scroll,t=i?a(i):1,i=r.attributes.scrollBar,e=i?u(i):0,i=r.attributes.scrollBarFlags,h=i?parseInt(i):0;let n,l,o,$,c=new Kt;i=r.attributes.scrollBarMargin,i&&c.parse(i),i=r.attributes.scrollBarRes,i&&(s=i.split(","),n=s[0],l=s[1]),i=r.attributes.ptrRes,i&&(s=i.split(","),o=s[0],$=s[1]),this.setupScroll(c,t,e,h,n,l,o,$)}else this.setupOverflow(h);this.$buildingDisplayList=!0;let l=r.children;l.forEach(t=>{if("controller"==t.nodeName){let e=new Ht;this.$controllers.push(e),e.$parent=this,e.setup(t)}});let o=this.packageItem.displayList;if(o.forEach((i,s)=>{let h;null!=t?h=t[e+s]:i.packageItem?(h=K.UIObjectFactory.newObject(i.packageItem),h.packageItem=i.packageItem,h.constructFromResource()):h=K.UIObjectFactory.newObjectDirectly(i.type),h.$inProgressBuilding=!0,h.setupBeforeAdd(i.desc),h.parent=this,this.$children.push(h),h instanceof Qt&&h.mask&&h.mask.set({x:h.mask.x+h.x,y:h.mask.y+h.y})},this),this.relations.setup(r),this.$children.forEach((t,e)=>{t.relations.setup(o[e].desc),t.setupAfterAdd(o[e].desc),t.$inProgressBuilding=!1}),i=r.attributes.mask,i){let t=this.getChildById(i),e=t.displayObject;if(this.removeChild(t),e instanceof createjs.Shape)this.mask=e;else if(!(e.$disp instanceof ct))throw new Error("only Sprite or Graphics can be applied as mask object")}l.forEach(t=>{if("transition"==t.nodeName){let e=new Xt(this);this.$transitions.push(e),e.setup(t)}},this),this.$transitions.length>0&&(this.on("added",this.$added,this),this.on("removed",this.$removed,this)),this.applyAllControllers(),this.$buildingDisplayList=!1,this.$inProgressBuilding=!1,this.appendChildrenList(),this.setBoundsChangedFlag(),this.constructFromXML(r)}appendChildrenList(){this.$children.forEach(t=>{null!=t.displayObject&&t.finalVisible&&this.$container.addChild(t.displayObject)},this)}constructFromXML(t){}$added(t){this.$transitions.forEach(t=>{t.autoPlay&&t.play({times:t.autoPlayRepeat,delay:t.autoPlayDelay})})}$removed(t){this.$transitions.forEach(t=>{t.stop(!1,!1)})}}class Jt extends Qt{constructor(){super(),this.$requestingCmd=0,this.focusable=!0,this.$uiSources=[],this.bringToFrontOnClick=S.bringWindowToFrontOnClick,this.on("added",this.$onShown,this),this.on("removed",this.$onHidden,this),this.on(s.Down,this.$mouseDown,this)}addUISource(t){this.$uiSources.push(t)}set contentPane(t){this.$contentPane!=t&&(null!=this.$contentPane&&this.removeChild(this.$contentPane),this.$contentPane=t,null!=this.$contentPane&&(this.addChild(this.$contentPane),this.setSize(this.$contentPane.width,this.$contentPane.height),this.$contentPane.addRelation(this,24),this.$frame=this.$contentPane.getChild("frame"),null!=this.$frame&&(this.closeButton=this.$frame.getChild("closeButton"),this.dragArea=this.$frame.getChild("dragArea"),this.contentArea=this.$frame.getChild("contentArea"))))}get contentPane(){return this.$contentPane}get frame(){return this.$frame}get closeButton(){return this.$closeButton}set closeButton(t){null!=this.$closeButton&&this.$closeButton.removeClick(this.closeEventHandler),this.$closeButton=t,null!=this.$closeButton&&this.$closeButton.click(this.closeEventHandler,this)}get dragArea(){return this.$dragArea}set dragArea(t){this.$dragArea!=t&&(null!=this.$dragArea&&(this.$dragArea.draggable=!1,this.$dragArea.off("__dragStart",this.$dragStart)),this.$dragArea=t,null!=this.$dragArea&&(this.$dragArea instanceof wt&&this.$dragArea.drawRect(0,"#000","#000"),this.$dragArea.draggable=!0,this.$dragArea.on("__dragStart",this.$dragStart,this)))}get contentArea(){return this.$contentArea}set contentArea(t){this.$contentArea=t}show(){gt.GRoot.inst.showWindow(this)}showOn(t){t.showWindow(this)}hide(){this.isShowing&&this.doHideAnimation()}hideImmediately(){gt.GRoot.inst.hideWindowImmediately(this)}centerOn(t,e=!1){this.setXY(Math.round(.5*(t.width-this.width)),Math.round(.5*(t.height-this.height))),e&&(this.addRelation(t,3),this.addRelation(t,10))}toggleVisible(){this.isTop?this.hide():this.show()}get isShowing(){return null!=this.parent}get isTop(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1}get modal(){return this.$modal}set modal(t){this.$modal=t}bringToFront(){gt.GRoot.inst.bringToFront(this)}showModalWait(t,e=0){0!=e&&(this.$requestingCmd=e),S.windowModalWaiting&&(this.$modalWaitPane||(this.$modalWaitPane=q.createObjectFromURL(S.windowModalWaiting)),this.layoutModalWaitPane(t),this.addChild(this.$modalWaitPane))}layoutModalWaitPane(t){if(null!=this.$contentArea){let e=this.$frame.localToGlobal();e=this.globalToLocal(e.x,e.y,e),this.$modalWaitPane.setXY(e.x+this.$contentArea.x,e.y+this.$contentArea.y),this.$modalWaitPane.setSize(this.$contentArea.width,this.$contentArea.height),t&&t.length&&(this.$modalWaitPane.text=t)}else this.$modalWaitPane.setSize(this.width,this.height)}closeModalWait(t=0){return(0==t||this.$requestingCmd==t)&&(this.$requestingCmd=0,this.$modalWaitPane&&null!=this.$modalWaitPane.parent&&this.removeChild(this.$modalWaitPane),!0)}get modalWaiting(){return this.$modalWaitPane&&null!=this.$modalWaitPane.parent}init(){this.$inited||this.$loading||(this.$uiSources.length>0?(this.$loading=!1,this.$uiSources.forEach(t=>{t.loaded||(t.load(this.$uiLoadComplete,this),this.$loading=!0)},this),this.$loading||this.$init()):this.$init())}onInit(){}onShown(){}onHide(){}doShowAnimation(){this.onShown()}doHideAnimation(){this.hideImmediately()}$uiLoadComplete(){let t=this.$uiSources.length;for(let e=0;e<t;e++)if(!this.$uiSources[e].loaded)return;this.$loading=!1,this.$init()}$init(){this.$inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()}dispose(){this.off("added",this.$onShown),this.off("removed",this.$onHidden),this.off(s.Down,this.$mouseDown),this.$dragArea&&this.$dragArea.off("__dragStart",this.$dragStart),null!=this.parent&&this.hideImmediately(),this.$modalWaitPane&&this.$modalWaitPane.dispose(),this.$contentPane&&this.$contentPane.dispose(),super.dispose()}closeEventHandler(t){this.hide()}$onShown(t){this.$inited?this.doShowAnimation():this.init()}$onHidden(t){this.closeModalWait(),this.onHide()}$mouseDown(t){this.isShowing&&this.bringToFrontOnClick&&this.bringToFront()}$dragStart(t){let e=t.data.currentTarget;pt.castFromNativeObject(e).stopDrag(),this.startDrag(t.data.pointerID)}}let Zt;class te extends Qt{constructor(){super(),this.$volumeScale=1,null==Zt&&(Zt=this),this.opaque=!1,this.$popupStack=[],this.$justClosedPopups=[],this.$uid=te.uniqueID++,jt.inst.on("__mouseWheel",this.dispatchMouseWheel,this)}static findFor(t){if(t instanceof te)return t;if(!t)return Zt;for(var e=t.parent;e;){if(e instanceof te)return e;e=e.parent}return Zt}static get inst(){return null==Zt&&(Zt=new te),Zt}static get globalMouseStatus(){return te.$gmStatus}attachTo(t,e){createjs.Touch.enable(t),t.mouseEnabled=!0,t.mouseChildren=!0,t.enableMouseOver(50),this.$uiStage=new Bt(t,e),this.$uiStage.on("__sizeChanged",this.$winResize,this),this.$uiStage.nativeStage.on(s.Down,this.$stageDown,this),this.$uiStage.nativeStage.on(s.Up,this.$stageUp,this),this.$uiStage.nativeStage.on(s.Move,this.$stageMove,this),this.$uiStage.nativeStage.on(s.Click,this.$click,this),this.$uiStage.nativeStage.addChild(this.$displayObject),this.$winResize(this.$uiStage),this.$modalLayer||(this.$modalLayer=new wt,this.$modalLayer.setSize(this.width,this.height),this.$modalLayer.drawRect(0,"",S.modalLayerColor),this.$modalLayer.addRelation(this,24))}get uniqueID(){return this.$uid}get stageWidth(){return this.$uiStage.stageWidth}get stageHeight(){return this.$uiStage.stageHeight}get contentScaleFactor(){return this.$uiStage.resolution}get applicationContext(){return this.$uiStage.applicationContext}get nativeStage(){return this.$uiStage.nativeStage}get orientation(){return this.$uiStage.orientation}get stageWrapper(){return this.$uiStage}dispatchMouseWheel(t){let e=t.data.event,i=this.getObjectUnderPoint(te.globalMouseStatus.mouseX,te.globalMouseStatus.mouseY);if(null!=i)for(;i.parent&&i.parent!=this;){let t=new createjs.Event("__mouseWheel",!0,!1);t.data={event:e},i.dispatchEvent(t),i=i.parent}}getObjectUnderPoint(t,e){te.sHelperPoint.setValues(t,e),window.test=!0;let i=this.$uiStage.applicationContext.getObjectUnderPoint(te.sHelperPoint.x,te.sHelperPoint.y,0);return pt.castFromNativeObject(i)}showWindow(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()}hideWindow(t){t.hide()}hideWindowImmediately(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()}bringToFront(t){let e;for(e=null==this.$modalLayer.parent||t.modal?this.numChildren-1:this.getChildIndex(this.$modalLayer)-1;e>=0;e--){let i=this.getChildAt(e);if(i==t)return;if(i instanceof Jt)break}e>=0&&this.setChildIndex(t,e)}showModalWait(t=null){null!=S.globalModalWaiting&&(null==this.$modalWaitPane&&(this.$modalWaitPane=q.createObjectFromURL(S.globalModalWaiting),this.$modalWaitPane.addRelation(this,24)),this.$modalWaitPane.setSize(this.width,this.height),this.addChild(this.$modalWaitPane),this.$modalWaitPane.text=t)}closeModalWait(){null!=this.$modalWaitPane&&null!=this.$modalWaitPane.parent&&this.removeChild(this.$modalWaitPane)}closeAllExceptModals(){this.$children.slice().forEach(t=>{t instanceof Jt&&!t.modal&&t.hide()},this)}closeAllWindows(){this.$children.slice().forEach(t=>{t instanceof Jt&&t.hide()},this)}getTopWindow(){for(let t=this.numChildren-1;t>=0;t--){let e=this.getChildAt(t);if(e instanceof Jt)return e}return null}get hasModalWindow(){return null!=this.$modalLayer.parent}get modalWaiting(){return this.$modalWaitPane&&this.$modalWaitPane.inContainer}showPopup(t,e=null,i=0){if(this.$popupStack.length>0){let e=this.$popupStack.indexOf(t);if(-1!=e)for(let t=this.$popupStack.length-1;t>=e;t--)this.removeChild(this.$popupStack.pop())}let s;this.$popupStack.push(t),this.addChild(t),this.adjustModalLayer();let h,r,n=0,a=0;e?(s=e.localToRoot(),n=e.width,a=e.height):s=this.globalToLocal(te.$gmStatus.mouseX,te.$gmStatus.mouseY),h=s.x,h+t.width>this.width&&(h=h+n-t.width),r=s.y+a,(0==i&&r+t.height>this.height||2==i)&&(r=s.y-t.height-1,r<0&&(r=0,h+=.5*n)),t.x=h,t.y=r}togglePopup(t,e=null,i){-1==this.$justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)}hidePopup(t=null){let e;if(null!=t){let i=this.$popupStack.indexOf(t);if(-1!=i)for(e=this.$popupStack.length-1;e>=i;e--)this.closePopup(this.$popupStack.pop())}else{for(e=this.$popupStack.length-1;e>=0;e--)this.closePopup(this.$popupStack[e]);this.$popupStack.length=0}}get hasAnyPopup(){return 0!=this.$popupStack.length}closePopup(t){null!=t.parent&&(t instanceof Jt?t.hide():this.removeChild(t))}showTooltips(t){if(null==this.$defaultTooltipWin){let t=S.tooltipsWin;if(!t)return void console.error("UIConfig.tooltipsWin not defined");this.$defaultTooltipWin=q.createObjectFromURL(t)}this.$defaultTooltipWin.text=t,this.showTooltipsWin(this.$defaultTooltipWin)}showTooltipsWin(t,e=null){this.hideTooltips(),this.$tooltipWin=t;let i=0,s=0;null==e?(i=te.$gmStatus.mouseX+10,s=te.$gmStatus.mouseY+20):(i=e.x,s=e.y);let h=this.globalToLocal(i,s);i=h.x,s=h.y,i+this.$tooltipWin.width>this.width&&(i=i-this.$tooltipWin.width-1,i<0&&(i=10)),s+this.$tooltipWin.height>this.height&&(s=s-this.$tooltipWin.height-1,i-this.$tooltipWin.width-1>0&&(i=i-this.$tooltipWin.width-1),s<0&&(s=10)),this.$tooltipWin.x=i,this.$tooltipWin.y=s,this.addChild(this.$tooltipWin)}hideTooltips(){null!=this.$tooltipWin&&(this.$tooltipWin.parent&&this.removeChild(this.$tooltipWin),this.$tooltipWin=null)}get focus(){return this.$focusedObject&&!this.$focusedObject.onStage&&(this.$focusedObject=null),this.$focusedObject}set focus(t){if(t&&(!t.focusable||!t.onStage))throw new Error("Invalid target to focus");this.setFocus(t)}setFocus(t){if(this.$focusedObject!=t){this.$focusedObject=t;let e=new createjs.Event("__focusChanged",!0,!1);this.dispatchEvent(e,this)}}get volumeScale(){return this.$volumeScale}set volumeScale(t){this.$volumeScale=t}playOneShotSound(t,e=1){var i=this.$volumeScale*e;t.play({volume:i})}adjustModalLayer(){let t=this.numChildren;null!=this.$modalWaitPane&&null!=this.$modalWaitPane.parent&&this.setChildIndex(this.$modalWaitPane,t-1);for(let e=t-1;e>=0;e--){let t=this.getChildAt(e);if(t instanceof Jt&&t.modal)return void(null==this.$modalLayer.parent?this.addChildAt(this.$modalLayer,e):this.setChildIndexBefore(this.$modalLayer,e))}null!=this.$modalLayer.parent&&this.removeChild(this.$modalLayer)}$stageDown(t){te.$gmStatus.mouseX=t.stageX,te.$gmStatus.mouseY=t.stageY,te.$gmStatus.touchDown=!0;let e=t.target;for(;e&&e!=this.nativeStage;){if(it(e)){let t=e.UIOwner;if(t.touchable&&t.focusable){this.setFocus(t);break}}e=e.parent}null!=this.$tooltipWin&&this.hideTooltips(),this.checkPopups(t.target)}checkPopups(t){if(!this.$checkingPopups&&(this.$checkingPopups=!0,this.$justClosedPopups.length=0,this.$popupStack.length>0)){let e,i=t;for(;i&&i!=this.nativeStage;){if(it(i)){let t=this.$popupStack.indexOf(i.UIOwner);if(-1!=t){let e;for(let i=this.$popupStack.length-1;i>t;i--)e=this.$popupStack.pop(),this.closePopup(e),this.$justClosedPopups.push(e);return}}i=i.parent}for(let t=this.$popupStack.length-1;t>=0;t--)e=this.$popupStack[t],this.closePopup(e),this.$justClosedPopups.push(e);this.$popupStack.length=0}}$stageMove(t){te.$gmStatus.mouseX=t.stageX,te.$gmStatus.mouseY=t.stageY}$stageUp(t){te.$gmStatus.touchDown=!1,this.$checkingPopups=!1}$click(t){}$winResize(t){this.setSize(t.stageWidth,t.stageHeight)}}var ee;te.uniqueID=0,te.$gmStatus=new class{constructor(){this.touchDown=!1,this.mouseX=0,this.mouseY=0}},gt.GRoot=te,function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(ee||(ee={}));const ie={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,dropShadowOffsetX:0,dropShadowOffsetY:0,fill:"black",fillGradientType:ee.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},se=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];class he{constructor(t){this.styleID=0,this.reset(),G.deepCopyProperties(this,t,t)}clone(){const t={};return G.deepCopyProperties(t,this,ie),new he(t)}reset(){G.deepCopyProperties(this,ie,ie)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=ne(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get dropShadowOffsetX(){return this._dropShadowOffsetX}set dropShadowOffsetX(t){this._dropShadowOffsetX!==t&&(this._dropShadowOffsetX=t,this.styleID++)}get dropShadowOffsetY(){return this._dropShadowOffsetY}set dropShadowOffsetY(t){this._dropShadowOffsetY!==t&&(this._dropShadowOffsetY=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=ne(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=ne(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let t=e.length-1;t>=0;t--){let i=e[t].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&se.indexOf(i)<0&&(i=`"${i}"`),e[t]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}}function re(t){return"number"==typeof t?H.convertToHtmlColor(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function ne(t){if(Array.isArray(t)){for(let e=0;e<t.length;++e)t[e]=re(t[e]);return t}return re(t)}class ae extends createjs.Text{constructor(t){super(),this.$minHeightID=-1,this.UIOwner=t,this.style=new he({})}get minHeight(){return this.$minHeight}applyStyle(){let t=gt.GRoot.inst.applicationContext.canvas;this.font=this.style.toFontString(),this.color=this.style.fill;let e=this.style.letterSpacing;t.style.letterSpacing=e?e+"px":"0px";let i=this.style.leading;this.lineHeight=i?this.getMeasuredLineHeight()+i:this.getMeasuredLineHeight();let s=this.style.strokeThickness;s&&(this.multiple||(this.multiple=new createjs.Text(this.text,this.font,this.color),this.UIOwner.parent.displayObject.addChild(this.multiple)),this.multiple.outline=s,this.style.stroke!=this.color&&(this.multiple.color=this.style.stroke),this.multiple.lineHeight=this.lineHeight,this.multiple.lineWidth=this.lineWidth);let h=new createjs.Shadow(this.style.dropShadowColor,this.style.dropShadowOffsetX,this.style.dropShadowOffsetY,this.style.dropShadowBlur);this.shadow=h;let{x:r,y:n,width:a,height:l}=this;this.setBounds(r,n,a,l)}$updateMinHeight(){this.$minHeight=this.getMeasuredLineHeight()}get width(){return this.getMetrics().width}set width(t){this.lineWidth=t,this.multiple&&(this.multiple.lineWidth=t)}get height(){return this.lineHeight}set height(t){this.lineHeight=t,this.multiple&&(this.multiple.lineHeight=t)}get textHeight(){return this.getMeasuredHeight()}set textHeight(t){}get textWidth(){return this.getMeasuredWidth()}set content(t){this.text=t,this.multiple&&(this.multiple.text=t)}get content(){return this.text}updateMultiplePosition(t,e){this.multiple&&(this.multiple.x=t,this.multiple.y=e)}}class le{constructor(t,e,i,s,h,r,n,a,l){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=h,this.lineWidths=r,this.lineHeight=n,this.maxLineWidth=a,this.fontProperties=l}static measureText(t,e,i,s=le._canvas){i=null==i?e.wordWrap:i;const h=e.toFontString(),r=le.measureFont(h);0===r.fontSize&&(r.fontSize=e.fontSize,r.ascent=e.fontSize);const n=s.getContext("2d");n.font=h;const a=(i?le.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),l=new Array(a.length);let o=0;for(let t=0;t<a.length;t++){const i=n.measureText(a[t]).width+(a[t].length-1)*e.letterSpacing;l[t]=i,o=Math.max(o,i)}let $=o+e.strokeThickness;e.dropShadow&&($+=e.dropShadowDistance);const c=e.lineHeight||r.fontSize+e.strokeThickness;let d=Math.max(c,r.fontSize+e.strokeThickness)+(a.length-1)*(c+e.leading);return e.dropShadow&&(d+=e.dropShadowDistance),new le(t,e,$,d,a,l,c+e.leading,o,r)}static wordWrap(t,e,i=le._canvas){const s=i.getContext("2d");let h=0,r="",n="";const a=Object.create(null),{letterSpacing:l,whiteSpace:o}=e,$=le.collapseSpaces(o),c=le.collapseNewlines(o);let d=!$;const u=e.wordWrapWidth+l,p=le.tokenize(t);for(let t=0;t<p.length;t++){let i=p[t];if(le.isNewline(i)){if(!c){n+=le.addLine(r),d=!$,r="",h=0;continue}i=" "}if($){const t=le.isBreakingSpace(i),e=le.isBreakingSpace(r[r.length-1]);if(t&&e)continue}const o=le.getFromCache(i,l,a,s);if(o>u)if(""!==r&&(n+=le.addLine(r),r="",h=0),le.canBreakWords(i,e.breakWords)){const t=le.wordWrapSplit(i);for(let o=0;o<t.length;o++){let $=t[o],c=1;for(;t[o+c];){const s=t[o+c],h=$[$.length-1];if(le.canBreakChars(h,s,i,o,e.breakWords))break;$+=s,c++}o+=$.length-1;const p=le.getFromCache($,l,a,s);p+h>u&&(n+=le.addLine(r),d=!1,r="",h=0),r+=$,h+=p}}else{r.length>0&&(n+=le.addLine(r),r="",h=0);const e=t===p.length-1;n+=le.addLine(i,!e),d=!1,r="",h=0}else o+h>u&&(d=!1,n+=le.addLine(r),r="",h=0),(r.length>0||!le.isBreakingSpace(i)||d)&&(r+=i,h+=o)}return n+=le.addLine(r,!1),n}static addLine(t,e=!0){return t=le.trimRight(t),t=e?t+"\n":t}static getFromCache(t,e,i,s){let h=i[t];if("number"!=typeof h){const r=t.length*e;h=s.measureText(t).width+r,i[t]=h}return h}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(t){if("string"!=typeof t)return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!le.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&le._newlines.indexOf(t.charCodeAt(0))>=0}static isBreakingSpace(t,e){return"string"==typeof t&&le._breakingSpaces.indexOf(t.charCodeAt(0))>=0}static tokenize(t){const e=[];let i="";if("string"!=typeof t)return e;for(let s=0;s<t.length;s++){const h=t[s],r=t[s+1];le.isBreakingSpace(h,r)||le.isNewline(h)?(""!==i&&(e.push(i),i=""),e.push(h)):i+=h}return""!==i&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,h){return!0}static wordWrapSplit(t){return t.split("")}static measureFont(t){if(le._fonts[t])return le._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=le._canvas,s=le._context;s.font=t;const h=le.METRICS_STRING+le.BASELINE_SYMBOL,r=Math.ceil(s.measureText(h).width);let n=Math.ceil(s.measureText(le.BASELINE_SYMBOL).width);const a=2*n;n=n*le.BASELINE_MULTIPLIER|0,i.width=r,i.height=a,s.fillStyle="#f00",s.fillRect(0,0,r,a),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(h,0,n);const l=s.getImageData(0,0,r,a).data,o=l.length,$=4*r;let c=0,d=0,u=!1;for(c=0;c<n;++c){for(let t=0;t<$;t+=4)if(255!==l[d+t]){u=!0;break}if(u)break;d+=$}for(e.ascent=n-c,d=o-$,u=!1,c=a;c>n;--c){for(let t=0;t<$;t+=4)if(255!==l[d+t]){u=!0;break}if(u)break;d-=$}return e.descent=c-n,e.fontSize=e.ascent+e.descent,le._fonts[t]=e,e}static clearMetrics(t=""){t?delete le._fonts[t]:le._fonts={}}}const oe=(()=>{try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}})();oe.width=oe.height=10,le._canvas=oe,le._context=oe.getContext("2d"),le._fonts={},le.METRICS_STRING="|ÉqÅ",le.BASELINE_SYMBOL="M",le.BASELINE_MULTIPLIER=1.4,le._newlines=[10,13],le._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];class $e{constructor(){this.width=0,this.height=0,this.textHeight=0,this.y=0}static get(){if($e.pool.length){let t=$e.pool.pop();return t.width=0,t.height=0,t.textHeight=0,t.text=null,t.y=0,t}return new $e}static recycle(t){$e.pool.push(t)}static recycleMany(t){t&&t.length&&t.forEach(t=>{$e.pool.push(t)},this),t.length=0}}$e.pool=[];class ce extends pt{constructor(){super(),this.$verticalAlign=0,this.$offset=new createjs.Point,this.$singleLine=!0,this.$text="",this.$textWidth=0,this.$textHeight=0,this.$style=new he({fontSize:12,fontFamily:S.defaultFont,align:"left",leading:3,fill:0}),this.$verticalAlign=0,this.$text="",this.$autoSize=1,this.$widthAutoSize=!0,this.$heightAutoSize=!0,this.$bitmapPool=[],this.touchable=!1}createDisplayObject(){this.$textField=new ae(this),this.setDisplayObject(this.$textField)}switchBitmapMode(t){t&&this.displayObject==this.$textField?(null==this.$btContainer&&(this.$btContainer=new i(this)),this.switchDisplayObject(this.$btContainer)):t||this.displayObject!=this.$btContainer||this.switchDisplayObject(this.$textField)}dispose(){Ct.inst.remove(this.$render,this),this.$bitmapFont=null,this.$bitmapPool.length=0,this.$bitmapPool=null,this.$style=null,super.dispose()}set text(t){this.setText(t)}setText(t){null==t&&(t=""),this.$text!=t&&(this.$text=t,this.updateGear(6),this.parent&&this.parent.$inProgressBuilding?this.renderNow():this.render())}get text(){return this.getText()}getText(){return this.$text}get color(){return this.getColor()}getColor(){return this.$color}setColor(t){this.$color!=t&&(this.$color=t,this.updateGear(4),this.$style.fill=this.$color,this.render())}set color(t){this.setColor(t)}get titleColor(){return this.color}set titleColor(t){this.color=t}get lineHeight(){return this.$style.lineHeight>0?this.$style.lineHeight:this.$fontProperties?this.$fontProperties.fontSize+this.$style.strokeThickness+this.$style.leading:+this.$style.fontSize+this.$style.strokeThickness}set lineHeight(t){this.$style.lineHeight=t}get font(){return this.$font||S.defaultFont}set font(t){this.$font!=t&&(this.$font=t,this.$font&&H.startsWith(this.$font,"ui://")?this.$bitmapFont=q.getBitmapFontByURL(this.$font):this.$style.fontFamily=this.$font||S.defaultFont,this.render())}get fontSize(){return+this.$style.fontSize}set fontSize(t){t<=0||this.$style.fontSize!=t&&(this.$style.fontSize=t,this.render())}get align(){return this.$style.align}set align(t){this.$style.align!=t&&(this.$style.align=t,this.render())}get verticalAlign(){return this.$verticalAlign}set verticalAlign(t){this.$verticalAlign!=t&&(this.$verticalAlign=t,this.$inProgressBuilding||this.layoutAlign())}get leading(){return this.$style.leading}set leading(t){this.$style.leading!=t&&(this.$style.leading=t,this.render())}get letterSpacing(){return this.$style.letterSpacing}set letterSpacing(t){this.$style.letterSpacing!=t&&(this.$style.letterSpacing=t,this.render())}get underline(){return!1}set underline(t){}get bold(){return"bold"==this.$style.fontWeight}set bold(t){let e=!0===t?"bold":"normal";this.$style.fontWeight!=e&&(this.$style.fontWeight=e,this.render())}get weight(){return this.$style.fontWeight}set weight(t){this.$style.fontWeight!=t&&(this.$style.fontWeight=t,this.render())}get variant(){return this.$style.fontVariant}set variant(t){this.$style.fontVariant!=t&&(this.$style.fontVariant=t,this.render())}get italic(){return"italic"==this.$style.fontStyle}set italic(t){let e=!0===t?"italic":"normal";this.$style.fontStyle!=e&&(this.$style.fontStyle=e,this.render())}get multipleLine(){return!this.$singleLine}set multipleLine(t){t=!t,this.$singleLine!=t&&(this.$singleLine=t,this.render())}get stroke(){return+this.$style.strokeThickness}set stroke(t){this.$style.strokeThickness!=t&&(this.$style.strokeThickness=t)}get strokeColor(){return this.$style.stroke}set strokeColor(t){this.$style.stroke!=t&&(this.$style.stroke=t)}set autoSize(t){this.$autoSize!=t&&(this.$autoSize=t,this.$widthAutoSize=1==t||3==t,this.$heightAutoSize=1==t||2==t,this.render())}get autoSize(){return this.$autoSize}get textWidth(){return this.$requireRender&&this.renderNow(),this.$textWidth}get textHeight(){return this.$requireRender&&this.renderNow(),this.$textHeight}ensureSizeCorrect(){this.$sizeDirty&&this.$requireRender&&this.renderNow()}render(){if(this.$requireRender||(this.$requireRender=!0,Ct.inst.callLater(this.$render,this)),!this.$sizeDirty&&(this.$widthAutoSize||this.$heightAutoSize)){this.$sizeDirty=!0;let t=new createjs.Event("__sizeDelayChange",!0,!1);this.dispatchEvent(t,this)}}applyStyle(){this.$textField.style.stroke=this.$style.stroke,this.$textField.style.strokeThickness=this.$style.strokeThickness,this.$textField.style.fontStyle=this.$style.fontStyle,this.$textField.style.fontVariant=this.$style.fontVariant,this.$textField.style.fontWeight=this.$style.fontWeight,this.$textField.style.letterSpacing=this.$style.letterSpacing,this.$textField.style.align=this.$style.align,this.$textField.style.fontSize=this.$style.fontSize,this.$textField.style.fontFamily=this.$style.fontFamily,this.$textField.style.fill=this.$style.fill,this.$textField.style.dropShadowColor=this.$style.dropShadowColor,this.$textField.style.dropShadowOffsetX=this.$style.dropShadowOffsetX,this.$textField.style.dropShadowOffsetY=this.$style.dropShadowOffsetY,this.$textField.style.leading=this.$style.leading,this.$textField.applyStyle()}$render(){this.$requireRender&&this.renderNow()}renderNow(t=!0){if(this.$requireRender=!1,this.$sizeDirty=!1,null!=this.$bitmapFont)return void this.renderWithBitmapFont(t);this.switchBitmapMode(!1),this.applyStyle(),this.$textField.$updateMinHeight();let e=!this.$widthAutoSize&&this.multipleLine;this.$textField.width=this.$textField.style.wordWrapWidth=e||0==this.autoSize?Math.ceil(this.width):1e4,this.$textField.style.wordWrap=e,this.$textField.style.breakWords=e,this.$textField.content=this.$text,this.$fontProperties=le.measureFont(this.$style.toFontString()),this.$textWidth=Math.ceil(this.$textField.textWidth),this.$textWidth>0&&(this.$textWidth+=2*ce.GUTTER_X),this.$textHeight=Math.ceil(this.$textField.textHeight),this.$textHeight>0&&(this.$textHeight+=2*ce.GUTTER_Y);let i=this.width,s=this.height;3==this.autoSize?this.shrinkTextField():(this.$textField.set({scaleX:1,scaleY:1}),this.$widthAutoSize&&(i=this.$textWidth,this.$textField.width=i),this.$heightAutoSize?(s=this.$textHeight,this.$textField.height!=this.$textHeight&&(this.$textField.height=this.$textHeight)):(s=this.height,this.$textHeight>s&&(this.$textHeight=s))),t&&(this.$updatingSize=!0,this.setSize(i,s),this.$updatingSize=!1),this.layoutAlign()}renderWithBitmapFont(t){this.switchBitmapMode(!0),this.$btContainer.children.forEach((t,e)=>{this.$bitmapPool.push(this.$btContainer.getChildAt(e))},this),this.$btContainer.removeAllChildren(),this.$lines?$e.recycleMany(this.$lines):this.$lines=[];let e,i,s=this.letterSpacing,h=this.leading-1,r=this.width-2*ce.GUTTER_X,n=0,a=0,l=0,o=0,$=0,c=0,d=0,u=0,p=0,g="",f=ce.GUTTER_Y,m=!this.$widthAutoSize&&this.multipleLine,w=this.$bitmapFont.resizable?this.fontSize/this.$bitmapFont.size:1;this.$textWidth=0,this.$textHeight=0;let y=this.text.length;for(let t=0;t<y;++t){let y=this.$text.charAt(t),b=y.charCodeAt(t);if("\n"!=y)if(b>256||b<=32?(c>0&&(u=n),c=0):(0==c&&(d=n),c++)," "==y?(o=Math.ceil(this.fontSize/2),$=Math.ceil(this.fontSize)):(i=this.$bitmapFont.glyphs[y],i?(o=Math.ceil(i.advance*w),$=Math.ceil(i.lineHeight*w)):" "==y?(o=Math.ceil(this.$bitmapFont.size*w/2),$=Math.ceil(this.$bitmapFont.size*w)):(o=0,$=0)),$>l&&(l=$),$>a&&(a=$),0!=n&&(n+=s),n+=o,!m||n<=r)g+=y;else{if(e=$e.get(),e.height=a,e.textHeight=l,0==g.length)e.text=y;else if(c>0&&u>0){g+=y;let t=g.length-c;e.text=H.trimRight(g.substr(0,t)),e.width=u,g=g.substr(t+1),n-=d}else e.text=g,e.width=n-(o+s),g=y,n=o,a=$,l=$;e.y=f,f+=e.height+h,e.width>this.$textWidth&&(this.$textWidth=e.width),c=0,d=0,u=0,this.$lines.push(e)}else g+=y,e=$e.get(),e.width=n,0==l&&(0==p&&(p=Math.ceil(this.fontSize*w)),0==a&&(a=p),l=a),e.height=a,p=a,e.textHeight=l,e.text=g,e.y=f,f+=e.height+h,e.width>this.$textWidth&&(this.$textWidth=e.width),this.$lines.push(e),g="",n=0,a=0,l=0,c=0,d=0,u=0}(g.length>0||this.$lines.length>0&&H.endsWith(this.$lines[this.$lines.length-1].text,"\n"))&&(e=$e.get(),e.width=n,0==a&&(a=p),0==l&&(l=a),e.height=a,e.textHeight=l,e.text=g,e.y=f,e.width>this.$textWidth&&(this.$textWidth=e.width),this.$lines.push(e)),this.$textWidth>0&&(this.$textWidth+=2*ce.GUTTER_X),0==this.$lines.length?this.$textHeight=0:(e=this.$lines[this.$lines.length-1],this.$textHeight=e.y+e.height+ce.GUTTER_Y);let b,x=0;b=this.$widthAutoSize?0==this.$textWidth?0:this.$textWidth:this.width,x=this.$heightAutoSize?0==this.$textHeight?0:this.$textHeight:this.height,t&&(this.$updatingSize=!0,this.setSize(b,x),this.$updatingSize=!1),0!=b&&0!=x&&(r=this.width-2*ce.GUTTER_X,this.$lines.forEach(t=>{let e=ce.GUTTER_X,h=0,n=0;h="center"==this.align?(r-t.width)/2:"right"==this.align?r-t.width:0,y=t.text.length;for(let r=0;r<y;r++){let a=t.text.charAt(r);if(i=this.$bitmapFont.glyphs[a],null!=i){let r;n=(t.height+t.textHeight)/2-Math.ceil(i.lineHeight*w),r=this.$bitmapPool.length?this.$bitmapPool.pop():new yt,r.x=e+h+Math.ceil(i.offsetX*w),r.y=t.y+n+Math.ceil(i.offsetY*w),r.texture=i.texture.image,r.textureRect=i.texture.rect;let{x:a,y:l,width:o,height:$}=i;r.sourceRect=new createjs.Rectangle(a,l,o,$),r.set({scaleX:w,scaleY:w}),r.tint=!0===this.$bitmapFont.colorable?this.$color:"0xFFFFFF",this.$btContainer.addChild(r),e+=s+Math.ceil(i.advance*w)}else e+=" "==a?s+Math.ceil(this.$bitmapFont.size*w/2):s}}))}localToGlobal(t=0,e=0,i){return t-=this.$offset.x,e-=this.$offset.y,super.localToGlobal(t,e,i)}globalToLocal(t=0,e=0,i){let s=super.globalToLocal(t,e,i);return s.x-=this.$offset.x,s.y-=this.$offset.y,s}handleSizeChanged(){this.$updatingSize||(null!=this.$bitmapFont?this.$widthAutoSize||this.render():this.$inProgressBuilding?(this.$textField.width=this.width,this.$textField.height=this.height):3==this.$autoSize?this.shrinkTextField():this.$widthAutoSize||(this.$heightAutoSize?this.$textField.width=this.width:(this.$textField.width=this.width,this.$textField.height=this.height)),this.layoutAlign())}shrinkTextField(){let t=Math.min(1,this.width/this.$textWidth);this.$textField.set({scaleX:t,scaleY:t})}layoutAlign(){let t=this.$textWidth,e=this.$textHeight;if(3==this.autoSize&&(t*=this.displayObject.scaleX,e*=this.displayObject.scaleY),0==this.$verticalAlign||0==e)this.$offset.y=ce.GUTTER_Y;else{let t=Math.max(0,this.height-e);1==this.$verticalAlign?this.$offset.y=.5*t:2==this.$verticalAlign&&(this.$offset.y=t)}let i=0;switch(this.$style.align){case"center":i=.5*(this.width-t);break;case"right":i=this.width-t}this.$offset.x=i,this.updatePosition()}updatePosition(){let t=Math.floor(this.x+this.$offset.x),e=Math.floor(this.y+this.$offset.y);this.displayObject.set({x:t,y:e}),this.$textField.updateMultiplePosition(t,e)}handleXYChanged(){super.handleXYChanged(),this.$displayObject&&this.updatePosition()}setupBeforeAdd(t){super.setupBeforeAdd(t);let e,i=t.attributes.font;i&&(this.font=i),i=t.attributes.vAlign,i&&(this.verticalAlign=w(i)),i=t.attributes.leading,i&&(this.$style.leading=parseInt(i)),i=t.attributes.letterSpacing,i&&(this.$style.letterSpacing=parseInt(i)),i=t.attributes.fontSize,i&&(this.$style.fontSize=parseInt(i)),i=t.attributes.color,i&&(this.color=i),i=t.attributes.shadowColor,i&&(this.$style.dropShadowColor=i),i=t.attributes.shadowOffset,i&&(e=i.split(","),e.length>1&&(this.$style.dropShadowOffsetX=parseInt(e[0]),this.$style.dropShadowOffsetY=parseInt(e[1]))),i=t.attributes.align,i&&(this.align=m(i)),i=t.attributes.autoSize,i&&(this.autoSize=f(i),this.$widthAutoSize=1==this.$autoSize||3==this.$autoSize,this.$heightAutoSize=1==this.$autoSize||2==this.$autoSize),this.underline="true"==t.attributes.underline,this.italic="true"==t.attributes.italic,this.bold="true"==t.attributes.bold,this.multipleLine="true"!=t.attributes.singleLine,i=t.attributes.strokeColor,i&&(this.strokeColor=i,i=t.attributes.strokeSize,this.stroke=i?parseInt(i):1)}setupAfterAdd(t){super.setupAfterAdd(t);let e=t.attributes.text;null!=e&&e.length>0&&(this.text=e),this.$sizeDirty=!1}}ce.GUTTER_X=2,ce.GUTTER_Y=2;class de extends ce{constructor(){super(),this.on("__linkClick",this.$clickLink,this)}set ubbEnabled(t){this.$ubbEnabled!=t&&(this.$ubbEnabled=t,this.render())}get ubbEnabled(){return this.$ubbEnabled}setupBeforeAdd(t){super.setupBeforeAdd(t),this.$ubbEnabled="true"==t.attributes.ubb}set textFlow(t){this.$textFlow=t,this.render()}set text(t){this.$text=t,null==this.$text&&(this.$text=""),this.$textField.width=this.width,this.updateGear(6),this.render()}$clickLink(t){let e=new createjs.Event("__linkClick",!0,!1);e.data=t.text,this.dispatchEvent(e,this)}dispose(){this.off("__linkClick",this.$clickLink),super.dispose()}}class ue extends createjs.EventDispatcher{constructor(t){super(),this.$requestToShow=!1,this.inputElement=null,this.inputDiv=null,this.$scaleX=0,this.$scaleY=0,this.textValue="",this.colorValue="0xffffff",this.$attrsCache={},this.$textfield=t}$addToStage(){this.htmlInput=zt.inst}initElement(){let t=this.$textfield.localToGlobal(0,0),e=t.x,i=t.y,s=this.htmlInput.$scaleX,h=this.htmlInput.$scaleY;this.$textfield.multipleLine||(this.inputElement.style.top=-this.$textfield.leading*h+"px"),this.inputDiv.style.top=(i+1)*h+"px",this.inputDiv.style.left=e*s+"px";let r=this.$textfield,n=1,a=1,l=0;for(;r.parent;)n*=r.scaleX,a*=r.scaleY,l+=r.rotation,r=r.parent;let o=this.inputDiv.style;o.transform=o.webkitTransform=o.msTransform=o.mozTransform=o.oTransform="rotate("+l+"deg)",this.$scaleX=s*n,this.$scaleY=h*a}get textField(){return this.$textfield}$show(){if(this.htmlInput.isCurrentInput(this))this.inputElement.onblur=null;else{this.inputElement=this.htmlInput.requestInput(this),this.$textfield.multipleLine||(this.inputElement.type=this.$textfield.type);for(let t in this.$attrsCache)this.inputElement.setAttribute(t,this.$attrsCache[t]);this.inputDiv=this.htmlInput.$wrapper}this.htmlInput.$requestToShow=!0,this.$requestToShow=!0,this.initElement()}$hide(){}onBlurHandler(){this.htmlInput.clearInputElement(),this.htmlInput.clearAttributes(this.$attrsCache),window.scrollTo(0,0)}get text(){return this.textValue||(this.textValue=""),this.textValue}set text(t){this.textValue=t,this.inputElement&&(this.inputElement.value=this.textValue)}setColor(t){this.colorValue=t,this.inputElement&&this.setElementStyle("color",H.HEX2RGB(this.colorValue))}$onBlur(){}onInputHandler(){window.setTimeout(()=>{this.inputElement&&this.inputElement.selectionStart==this.inputElement.selectionEnd&&(this.textValue=this.inputElement.value,this.dispatchEvent("updateText"))},0)}setAreaHeight(){let t=this.$textfield;if(t.multipleLine){let e=t.textHeight;if(t.height<=t.fontSize)this.setElementStyle("height",t.fontSize*this.$scaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",t.lineHeight*this.$scaleY+"px");else if(t.height<e)this.setElementStyle("height",t.height*this.$scaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",t.lineHeight*this.$scaleY+"px");else{this.setElementStyle("height",(e+t.leading)*this.$scaleY+"px");let i=(t.height-e)*this.$scaleY,s=i*this.getVAlignFactor(t),h=i-s;this.setElementStyle("padding",s+"px 0px "+h+"px 0px"),this.setElementStyle("lineHeight",t.lineHeight*this.$scaleY+"px")}}}getVAlignFactor(t){let e=0;switch(t.verticalAlign){case 0:break;case 1:e=.5;break;case 2:e=1}return e}onClickHandler(t){if(this.$requestToShow){this.$requestToShow=!1,this.inputElement.value=this.text,null==this.inputElement.onblur&&(this.inputElement.onblur=Ut.create(this.onBlurHandler,this)),this.resetInput(),this.$textfield.maxLength>0?this.inputElement.setAttribute("maxlength",String(this.$textfield.maxLength)):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus();let t=new createjs.Event("__focusChanged",!0,!1);t.data="focus",this.dispatchEvent(t)}}onDisconnect(){this.inputElement=null;let t=new createjs.Event("__focusChanged",!0,!1);t.data="blur",this.dispatchEvent(t)}setElementStyle(t,e){if(null!=e&&this.inputElement){this.inputElement.style[t]=e}}setAttribute(t,e){null!=t&&null!=e&&(this.$attrsCache[t]=e)}getAttribute(t){return this.$attrsCache[t]}$removeFromStage(){this.inputElement&&this.htmlInput.disconnect(this)}resetInput(){if(this.inputElement){let t=this.$textfield;this.setElementStyle("fontFamily",t.font),this.setElementStyle("fontStyle",t.italic?"italic":"normal"),this.setElementStyle("fontWeight",t.bold?"bold":"normal"),this.setElementStyle("textAlign",t.align),this.setElementStyle("fontSize",t.fontSize*this.$scaleY+"px"),this.setElementStyle("color",H.convertToHtmlColor(+t.color)),this.setElementStyle("width",t.width*this.$scaleX+"px");let e="middle",i=0;switch(t.verticalAlign){case 0:e="top";break;case 1:e="middle",i=.5;break;case 2:e="bottom",i=1}if(this.setElementStyle("verticalAlign",e),t.multipleLine)this.setAreaHeight();else if(this.setElementStyle("lineHeight",t.lineHeight*this.$scaleY+"px"),t.height<t.fontSize)this.setElementStyle("height",t.fontSize*this.$scaleY+"px"),this.setElementStyle("padding","0px 0px "+.5*t.fontSize*this.$scaleX+"px 0px");else{this.setElementStyle("height",t.fontSize*this.$scaleY+"px");let e=(t.height-t.fontSize)*this.$scaleY,s=e*i,h=e-s,r=.5*t.fontSize*this.$scaleY;h<r&&(h=r),this.setElementStyle("padding",s+"px 0px "+h+"px 0px")}this.inputDiv.style.clip="rect(0px "+t.width*this.$scaleX+"px "+t.height*this.$scaleY+"px 0px)",this.inputDiv.style.height=t.height*this.$scaleY+"px",this.inputDiv.style.width=t.width*this.$scaleX+"px"}}}class pe{constructor(t){this.$inited=!1,this.$restrictString=null,this.$restrictRegex=null,this.$focused=!1,this.$textField=t,this.$input=new ue(t)}initialize(){this.$inited||(this.$input.$addToStage(),this.$input.on("updateText",this.updateText,this),this.$input.on("__focusChanged",this.focusHandler,this),this.$textField.on(s.Down,this.textFieldDownHandler,this),this.$inited=!0)}textFieldDownHandler(){this.$onFocus()}destroy(){this.$inited&&(this.$input.$removeFromStage(),this.$textField.off(s.Down,this.textFieldDownHandler),te.inst.off(s.Down,this.onStageDown),this.$input.off("updateText",this.updateText),this.$input.off("__focusChanged",this.focusHandler),this.$inited=!1)}get text(){return this.$input.text}set text(t){this.$input.text=t}setColor(t){return this.$input.setColor(t)}updateText(){let t=this.$input.text,e=!1;if(null!=this.$restrictRegex){let i=t.match(this.$restrictRegex);t=i?i.join(""):"",e=!0}e&&this.$input.text!=t&&(this.$input.text=t),this.$textField.text=this.$input.text;let i=new createjs.Event("__textChange",!0,!1);i.data={textField:this.$textField},this.$textField.dispatchEvent(i,this)}onStageDown(t){pt.castFromNativeObject(t.currentTarget)!=this.$textField&&this.$input.$hide()}focusHandler(t){let{data:e}=t;"focus"==e?this.$focused||(this.$focused=!0,this.$textField.$isTyping=!0,this.$textField.alpha=.01,this.$textField.dispatchEvent("__focusChanged","focus"),this.$textField.dispatchEvent("__textFocusIn",this.$textField)):"blur"==e&&this.$focused&&(this.$focused=!1,te.inst.off(s.Down,this.onStageDown),this.$textField.$isTyping=!1,this.$textField.alpha=1,this.$input.$onBlur(),this.$textField.dispatchEvent("__focusChanged","blur"),this.$textField.dispatchEvent("__textFocusOut",this.$textField))}get isFocused(){return this.$focused}$getProperty(t){return this.$inited&&this.$input.getAttribute(t)||null}$setProperty(t,e){this.$inited&&this.$input.setAttribute(t,e)}get $restrict(){return this.$restrictString}set $restrict(t){this.$restrictString=t,null!=this.$restrictString&&this.$restrictString.length>0?this.$restrictRegex=new RegExp(this.$restrictString):this.$restrictRegex=null}get type(){return this.$type}set type(t){t!=this.$type&&(this.$type=t)}tryHideInput(){!this.$textField.visible&&this.$input&&this.$input.$removeFromStage()}$updateProperties(){if(this.isFocused)return this.$input.resetInput(),void this.tryHideInput();this.$input.text=this.$textField.text,this.$input.resetInput(),this.tryHideInput()}$onFocus(){this.$textField.visible&&!this.$focused&&(te.inst.off(s.Down,this.onStageDown),Ct.inst.callLater(()=>{te.inst.on(s.Down,this.onStageDown,this)},this),this.$input.$show())}}class ge extends ce{constructor(){super(),this.$util=null,this.$isTyping=!1,this.focusable=!0,this.editable=!0,this.type="text",this.on("removed",this.removed,this),this.on("added",this.added,this),this.$util.initialize()}createDisplayObject(){super.createDisplayObject(),this.$hitArea=new createjs.Shape,this.$hitArea.graphics.beginFill("#000").drawRect(0,0,this.$width,this.$height),this.$displayObject.hitArea=this.$hitArea}handleSizeChanged(){super.handleSizeChanged(),this.$hitArea.graphics.drawRect(0,0,this.$width,this.$height),this.$displayObject.hitArea=this.$hitArea}removed(t){this.$util&&this.$util.destroy()}added(t){this.$util&&this.$util.initialize()}requestFocus(){gt.GRoot.inst.focus=this,this.$util.$onFocus()}get editable(){return this.$editable}set editable(t){t!=this.$editable&&(this.$editable=t,this.$editable?(this.$util||(this.$util=new pe(this)),this.$util.initialize()):this.$util&&this.$util.destroy(),this.touchable=this.$editable)}changeToPassText(t){let e="";for(let i=0,s=t.length;i<s;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}getText(){return this.$util.text}setText(t){null==t&&(t=""),this.$text!=t&&(this.$util.text=t,super.setText(t))}setColor(t){super.setColor(t),this.$util.setColor(t)}get promptText(){return this.$util.$getProperty("placeholder")}set promptText(t){null==t&&(t=""),this.$util.$setProperty("placeholder",t)}get maxLength(){return parseInt(this.$util.$getProperty("maxlength"))||0}set maxLength(t){this.$util.$setProperty("maxlength",String(t))}get restrict(){return this.$util.$restrict}set restrict(t){this.$util.$restrict=t}get password(){return"password"==this.type}set password(t){this.type="password"}get type(){return this.$util.type}set type(t){this.$util.type=t}dispose(){super.dispose(),this.off("removed",this.removed),this.off("added",this.added),this.$util.destroy(),this.$util=null}renderNow(t=!0){this.$requireRender=!1,this.$sizeDirty=!1,this.$util.$updateProperties(),this.$isTyping&&this.decorateInputbox();let e=this.$text;"password"==this.type&&(this.$text=this.changeToPassText(this.$text)),super.renderNow(t),this.$text=e}decorateInputbox(){}setupBeforeAdd(t){super.setupBeforeAdd(t);var e=t.attributes.maxLength;null!=e&&(this.maxLength=parseInt(e)),null!=(e=t.attributes.restrict)&&(this.restrict=e),"true"==(e=t.attributes.password)?this.password=!0:"4"==(e=t.attributes.keyboardType)?this.type="number":"3"==e?this.type="url":"5"==e?this.type="tel":"6"==e&&(this.type="email")}}class fe extends class{constructor(){this.$count=0,this.$pool={}}get count(){return this.$count}clear(){for(let t in this.$pool){let e=this.$pool[t];e&&(e.length=0,e=null)}this.$pool={},this.$count=0}get(t){let e=this.$pool[t];return null==e&&(e=[],this.$pool[t]=e),e.length?(this.$count--,e.shift()):this.createObject(t)}recycle(t,e){if(!t)return;let i=this.$pool[t];null==i&&(i=[],this.$pool[t]=i),this.$count++,i.push(e)}}{constructor(){super()}clear(){for(let t in this.$pool){let e=this.$pool[t];e&&e.forEach(t=>{t.dispose()})}super.clear()}createObject(t){return q.createObjectFromURL(t)}}class me extends pt{constructor(){super(),this.$frame=0,this.$color="#fff",this.$contentSourceWidth=0,this.$contentSourceHeight=0,this.$contentWidth=0,this.$contentHeight=0,this.$loadingTexture=null,this.$playing=!0,this.$url="",this.$fill=0,this.$align="left",this.$verticalAlign=0,this.$showErrorSign=!0,this.$color="#fff"}createDisplayObject(){this.$container=new i(this),this.$hitArea=new createjs.Shape,this.$hitArea.graphics.beginFill("#000").drawRect(0,0,0,0),this.$container.hitArea=this.$hitArea,this.setDisplayObject(this.$container)}dispose(){this.clearContent(),super.dispose()}get url(){return this.$url}set url(t){this.$url!=t&&(this.$url=t,this.loadContent(),this.updateGear(7))}get icon(){return this.$url}set icon(t){this.url=t}get align(){return this.$align}set align(t){this.$align!=t&&(this.$align=t,this.updateLayout())}get verticalAlign(){return this.$verticalAlign}set verticalAlign(t){this.$verticalAlign!=t&&(this.$verticalAlign=t,this.updateLayout())}get fill(){return this.$fill}set fill(t){this.$fill!=t&&(this.$fill=t,this.updateLayout())}get autoSize(){return this.$autoSize}set autoSize(t){this.$autoSize!=t&&(this.$autoSize=t,this.updateLayout())}get playing(){return this.$playing}set playing(t){this.$playing!=t&&(this.$playing=t,this.$content instanceof Ot&&(this.$content.playing=t),this.updateGear(5))}get frame(){return this.$frame}set frame(t){this.$frame!=t&&(this.$frame=t,this.$content instanceof Ot&&(this.$content.currentFrame=t),this.updateGear(5))}get color(){return this.$color}set color(t){this.$color!=t&&(this.$color=t,this.updateGear(4),this.applyColor())}applyColor(){this.$content&&(this.$content.tint=this.$color)}get showErrorSign(){return this.$showErrorSign}set showErrorSign(t){this.$showErrorSign=t}get content(){return this.$content}get texture(){return this.$content instanceof St?this.$content.texture:null}set texture(t){this.url=null,this.switchToMovieMode(!1),this.$content instanceof St&&(this.$content.texture=t),t?(this.$contentSourceWidth=t.width,this.$contentSourceHeight=t.height):this.$contentSourceWidth=this.$contentHeight=0,this.updateLayout()}loadContent(){this.clearContent(),this.$url&&(H.startsWith(this.$url,"ui://")?this.loadFromPackage(this.$url):this.loadExternal())}loadFromPackage(t){if(this.$contentItem=q.getItemByURL(t),this.$contentItem)if(this.$contentItem.load(),0==this.$contentItem.type)null==this.$contentItem.texture?this.setErrorState():(this.switchToMovieMode(!1),this.$content.$initDisp(this.$contentItem),this.$contentSourceWidth=this.$contentItem.width,this.$contentSourceHeight=this.$contentItem.height,this.updateLayout());else if(2==this.$contentItem.type){this.switchToMovieMode(!0),this.$contentSourceWidth=this.$contentItem.width,this.$contentSourceHeight=this.$contentItem.height;let t=this.$content;t.interval=this.$contentItem.interval,t.swing=this.$contentItem.swing,t.repeatDelay=this.$contentItem.repeatDelay,t.frames=this.$contentItem.frames,t.boundsRect=new createjs.Rectangle(0,0,this.$contentSourceWidth,this.$contentSourceHeight),this.updateLayout()}else this.setErrorState();else this.setErrorState()}switchToMovieMode(t){this.$container.removeAllChildren(),t?this.$content instanceof Ot||(this.$content=new Ot(this)):this.$content instanceof St||(this.$content=new St(null)),this.$container.addChild(this.$content)}loadExternal(){let t=new yt;this.$loadingTexture=t}freeExternal(t){}$loadResCompleted(t){t?this.onExternalLoadSuccess(t):(this.onExternalLoadFailed(),this.freeExternal(this.$loadingTexture),this.$loadingTexture=null),this.$loadingTexture=null}onExternalLoadSuccess(t){this.$container.removeAllChildren(),this.$content&&this.$content instanceof St||(this.$content=new St(null),this.$content.$initDisp()),this.$container.addChild(this.$content),this.$content.texture=t.texture,this.$contentSourceWidth=t.sourceRect.width,this.$contentSourceHeight=t.sourceRect.height,this.updateLayout()}onExternalLoadFailed(){this.setErrorState()}setErrorState(){this.$showErrorSign&&(null==this.$errorSign&&S.loaderErrorSign&&(this.$errorSign=me.$errorSignPool.get(S.loaderErrorSign)),this.$errorSign&&(this.$errorSign.width=this.width,this.$errorSign.height=this.height,this.$container.addChild(this.$errorSign.displayObject)))}clearErrorState(){this.$errorSign&&(this.$container.removeChild(this.$errorSign.displayObject),me.$errorSignPool.recycle(this.$errorSign.resourceURL,this.$errorSign),this.$errorSign=null)}updateLayout(){if(null!=this.$content)if(this.$content.set({x:0,y:0}),this.$content.set({scaleX:1,scaleY:1}),this.$contentWidth=this.$contentSourceWidth,this.$contentHeight=this.$contentSourceHeight,this.$autoSize)this.$updatingLayout=!0,0==this.$contentWidth&&(this.$contentWidth=50),0==this.$contentHeight&&(this.$contentHeight=30),this.setSize(this.$contentWidth,this.$contentHeight),this.$updatingLayout=!1;else{let t=1,e=1;0!=this.$fill&&(t=this.width/this.$contentSourceWidth,e=this.height/this.$contentSourceHeight,1==t&&1==e||(2==this.$fill?t=e:3==this.$fill?e=t:1==this.$fill?t>e?t=e:e=t:5==this.$fill&&(t>e?e=t:t=e),this.$contentWidth=this.$contentSourceWidth*t,this.$contentHeight=this.$contentSourceHeight*e)),this.$content instanceof St?(this.$content.width=this.$contentWidth,this.$content.height=this.$contentHeight):this.$content.set({scaleX:t,scaleY:e}),"center"==this.$align?this.$content.x=Math.floor((this.width-this.$contentWidth)/2):"right"==this.$align&&(this.$content.x=this.width-this.$contentWidth),1==this.$verticalAlign?this.$content.y=Math.floor((this.height-this.$contentHeight)/2):2==this.$verticalAlign&&(this.$content.y=this.height-this.$contentHeight)}else this.$autoSize&&(this.$updatingLayout=!0,this.setSize(50,30),this.$updatingLayout=!1)}clearContent(){this.clearErrorState(),this.$content&&this.$content.parent&&this.$container.removeChild(this.$content),this.$loadingTexture&&(this.freeExternal(this.$loadingTexture),this.$loadingTexture=null),this.$content&&this.$content.destroy(),this.$content=null,this.$contentItem=null}handleSizeChanged(){this.$updatingLayout||this.updateLayout(),this.$hitArea.graphics.drawRect(0,0,this.width,this.height)}setupBeforeAdd(t){let e;super.setupBeforeAdd(t),e=t.attributes.url,e&&(this.$url=e),e=t.attributes.align,e&&(this.$align=m(e)),e=t.attributes.vAlign,e&&(this.$verticalAlign=w(e)),e=t.attributes.fill,e&&(this.$fill=l(e)),this.$autoSize="true"==t.attributes.autoSize,e=t.attributes.errorSign,e&&(this.$showErrorSign="true"==e),this.$playing="false"!=t.attributes.playing,e=t.attributes.color,e&&(this.color=e),this.$url&&this.loadContent()}}me.$errorSignPool=new fe;let we=function(t){return t&&"titleColor"in t&&"fontSize"in t};class ye extends Qt{constructor(){super()}get icon(){return null!=this.$iconObject?this.$iconObject.icon:null}set icon(t){null!=this.$iconObject&&(this.$iconObject.icon=t),this.updateGear(7)}get title(){return this.$titleObject?this.$titleObject.text:null}set title(t){this.$titleObject&&(this.$titleObject.text=t),this.updateGear(6)}get text(){return this.title}set text(t){this.title=t}get titleColor(){return we(this.$titleObject)?this.$titleObject.titleColor:""}set titleColor(t){we(this.$titleObject)&&(this.$titleObject.titleColor=t)}get fontSize(){return we(this.$titleObject)?this.$titleObject.fontSize:0}set fontSize(t){we(this.$titleObject)&&(this.$titleObject.fontSize=t)}set editable(t){this.$titleObject&&(this.$titleObject.editable=t)}get editable(){return!!(this.$titleObject&&this.$titleObject instanceof ge)&&this.$titleObject.editable}constructFromXML(t){super.constructFromXML(t),this.$titleObject=this.getChild("title"),this.$iconObject=this.getChild("icon")}setupAfterAdd(t){super.setupAfterAdd(t);let e=V.getChildNodes(t,"Label");if(e&&e.length>0){let i;if(i=(t=e[0]).attributes.title,i&&(this.text=i),i=t.attributes.icon,i&&(this.icon=i),i=t.attributes.titleColor,i&&(this.titleColor=i),this.$titleObject instanceof ge){i=t.attributes.prompt;let e=this.$titleObject;i&&(e.promptText=i),i=t.attributes.maxLength,i&&(e.maxLength=parseInt(i)),i=t.attributes.restrict,i&&(e.restrict=i),i=t.attributes.password,i&&(e.password="true"==i)}}}}class be{set controller(t){this.$controller=t}set name(t){this.$id=this.$controller.getPageIdByName(t)}get name(){return this.$id?this.$controller.getPageNameById(this.$id):null}set index(t){this.$id=this.$controller.getPageId(t)}get index(){return this.$id?this.$controller.getPageIndexById(this.$id):-1}clear(){this.$id=null}set id(t){this.$id=t}get id(){return this.$id}}class xe extends Qt{constructor(){super(),this.$mode=0,this.$title="",this.$icon="",this.$sound=S.buttonSound,this.$soundVolumeScale=S.buttonSoundVolumeScale,this.$pageOption=new be,this.$changeStateOnClick=!0,this.$downEffect=0,this.$downEffectValue=.8,this.$container.cursor="pointer"}setDisplayObject(t){super.setDisplayObject(t)}get icon(){return this.$icon}set icon(t){this.$icon=t,t=this.$selected&&this.$selectedIcon?this.$selectedIcon:this.$icon,null!=this.$iconObject&&(this.$iconObject.icon=t),this.updateGear(7)}get selectedIcon(){return this.$selectedIcon}set selectedIcon(t){this.$selectedIcon=t,t=this.$selected&&this.$selectedIcon?this.$selectedIcon:this.$icon,null!=this.$iconObject&&(this.$iconObject.icon=t)}get title(){return this.$title}set title(t){this.$title=t,this.$titleObject&&(this.$titleObject.text=this.$selected&&this.$selectedTitle?this.$selectedTitle:this.$title),this.updateGear(6)}get text(){return this.title}set text(t){this.title=t}get selectedTitle(){return this.$selectedTitle}set selectedTitle(t){this.$selectedTitle=t,this.$titleObject&&(this.$titleObject.text=this.$selected&&this.$selectedTitle?this.$selectedTitle:this.$title)}get titleColor(){if(we(this.$titleObject))return this.$titleObject.titleColor}set titleColor(t){we(this.$titleObject)&&(this.$titleObject.titleColor=t)}get fontSize(){return we(this.$titleObject)?this.$titleObject.fontSize:0}set fontSize(t){we(this.$titleObject)&&(this.$titleObject.fontSize=t)}get sound(){return this.$sound}set sound(t){this.$sound=t}get soundVolumeScale(){return this.$soundVolumeScale}set soundVolumeScale(t){this.$soundVolumeScale=t}set selected(t){if(0!=this.$mode&&this.$selected!=t){if(this.$selected=t,this.grayed&&this.$buttonController&&this.$buttonController.hasPage(xe.DISABLED)?this.$selected?this.setState(xe.SELECTED_DISABLED):this.setState(xe.DISABLED):this.$selected?this.setState(this.$over?xe.SELECTED_OVER:xe.DOWN):this.setState(this.$over?xe.OVER:xe.UP),this.$selectedTitle&&this.$titleObject&&(this.$titleObject.text=this.$selected?this.$selectedTitle:this.$title),this.$selectedIcon){let t=this.$selected?this.$selectedIcon:this.$icon;null!=this.$iconObject&&(this.$iconObject.icon=t)}this.$relatedController&&this.$parent&&!this.$parent.$buildingDisplayList&&(this.$selected?(this.$relatedController.selectedPageId=this.$pageOption.id,this.$relatedController.$autoRadioGroupDepth&&this.$parent.adjustRadioGroupDepth(this,this.$relatedController)):1==this.$mode&&this.$relatedController.selectedPageId==this.$pageOption.id&&(this.$relatedController.oppositePageId=this.$pageOption.id))}}get selected(){return this.$selected}get mode(){return this.$mode}set mode(t){this.$mode!=t&&(0==t&&(this.selected=!1),this.$mode=t)}get relatedController(){return this.$relatedController}set relatedController(t){t!=this.$relatedController&&(this.$relatedController=t,this.$pageOption.controller=t,this.$pageOption.clear())}get pageOption(){return this.$pageOption}get changeStateOnClick(){return this.$changeStateOnClick}set changeStateOnClick(t){this.$changeStateOnClick=t}get linkedPopup(){return this.$linkedPopup}set linkedPopup(t){this.$linkedPopup=t}addStateListener(t,e){this.on("__stateChanged",t,e)}removeStateListener(t){this.off("__stateChanged",t)}fireClick(t=!0){t&&0==this.$mode&&(this.setState(xe.OVER),Ct.inst.add(100,1,this.setState,this,xe.DOWN),Ct.inst.add(200,1,this.setState,this,xe.UP)),this.$click(null)}setState(t){if(this.$buttonController&&(this.$buttonController.selectedPage=t),1==this.$downEffect)if(t==xe.DOWN||t==xe.SELECTED_OVER||t==xe.SELECTED_DISABLED){let t=255*this.$downEffectValue,e=(t<<16)+(t<<8)+t;this.$children.forEach(t=>{nt(t)&&(t.color=e)})}else this.$children.forEach(t=>{nt(t)&&(t.color=16777215)});else 2==this.$downEffect&&(t==xe.DOWN||t==xe.SELECTED_OVER||t==xe.SELECTED_DISABLED?this.setScale(this.$downEffectValue,this.$downEffectValue):this.setScale(1,1))}handleControllerChanged(t){super.handleControllerChanged(t),this.$relatedController==t&&(this.selected=this.$pageOption.id==t.selectedPageId)}handleGrayedChanged(){this.$buttonController&&this.$buttonController.hasPage(xe.DISABLED)?this.grayed?this.$selected&&this.$buttonController.hasPage(xe.SELECTED_DISABLED)?this.setState(xe.SELECTED_DISABLED):this.setState(xe.DISABLED):this.$selected?this.setState(xe.DOWN):this.setState(xe.UP):super.handleGrayedChanged()}constructFromXML(t){let e;super.constructFromXML(t),e=(t=V.getChildNodes(t,"Button")[0]).attributes.mode,e&&(this.$mode=g(e)),e=t.attributes.sound,null!=e&&(this.$sound=e),e=t.attributes.volume,e&&(this.$soundVolumeScale=parseInt(e)/100),e=t.attributes.downEffect,e&&(this.$downEffect="dark"==e?1:"scale"==e?2:0,e=t.attributes.downEffectValue,this.$downEffectValue=parseFloat(e),2==this.$downEffect&&this.setPivot(.5,.5)),this.$buttonController=this.getController("button"),this.$titleObject=this.getChild("title"),this.$iconObject=this.getChild("icon"),null!=this.$titleObject&&(this.$title=this.$titleObject.text),null!=this.$iconObject&&(this.$icon=this.$iconObject.icon),0==this.$mode&&this.setState(xe.UP),this.on(s.Over,this.$rollover,this),this.on(s.Out,this.$rollout,this),this.on(s.Down,this.$mousedown,this),this.on(s.Click,this.$click,this),this.$hitArea=new createjs.Shape,this.$hitArea.graphics.beginFill("#fff").drawRect(0,0,this.width,this.height),this.$displayObject.hitArea=this.$hitArea}setupAfterAdd(t){if(super.setupAfterAdd(t),t=V.getChildNodes(t,"Button")[0]){let e;e=t.attributes.title,e&&(this.title=e),e=t.attributes.icon,e&&(this.icon=e),e=t.attributes.selectedTitle,e&&(this.selectedTitle=e),e=t.attributes.selectedIcon,e&&(this.selectedIcon=e),e=t.attributes.titleColor,e&&(this.titleColor=H.HEX2RGB(e)),e=t.attributes.sound,null!=e&&(this.$sound=e),e=t.attributes.volume,e&&(this.$soundVolumeScale=parseInt(e)/100),e=t.attributes.titleFontSize,e&&(this.fontSize=parseInt(e)),e=t.attributes.controller,this.$relatedController=e?this.$parent.getController(e):null,this.$pageOption.id=t.attributes.page,this.selected="true"==t.attributes.checked}}$rollover(t){this.$buttonController&&this.$buttonController.hasPage(xe.OVER)&&(this.$over=!0,this.$down||this.setState(this.$selected?xe.SELECTED_OVER:xe.OVER))}$rollout(t){this.$buttonController&&this.$buttonController.hasPage(xe.OVER)&&(this.$over=!1,this.$down||this.setState(this.$selected?xe.DOWN:xe.UP))}$mousedown(t){this.$down=!0,this.$mouseUpEvent=gt.GRoot.inst.nativeStage.on(s.Up,this.$mouseup,this),0==this.$mode&&(this.grayed&&this.$buttonController&&this.$buttonController.hasPage(xe.DISABLED)?this.setState(xe.SELECTED_DISABLED):this.setState(xe.DOWN)),null!=this.$linkedPopup&&(this.$linkedPopup instanceof Jt?this.$linkedPopup.toggleVisible():gt.GRoot.inst.togglePopup(this.$linkedPopup,this))}$mouseup(t){this.$down&&(gt.GRoot.inst.nativeStage.off(s.Up,this.$mouseUpEvent),this.$down=!1,0==this.$mode&&(this.grayed&&this.$buttonController&&this.$buttonController.hasPage(xe.DISABLED)?this.setState(xe.DISABLED):this.$over?this.setState(xe.OVER):this.setState(xe.UP)))}$click(t){if(this.$sound){var e=q.getItemByURL(this.$sound);if(e){var i=e.owner.getItemAsset(e);i&&gt.GRoot.inst.playOneShotSound(i,this.$soundVolumeScale)}}if(this.$changeStateOnClick)if(1==this.$mode){this.selected=!this.$selected;let t=new createjs.Event("__stateChanged",!0,!1);t.data={selected:this.selected},this.dispatchEvent(t,this)}else if(2==this.$mode&&!this.$selected){this.selected=!0;let t=new createjs.Event("__stateChanged",!0,!1);t.data={selected:this.selected},this.dispatchEvent(t,this)}}dispose(){Ct.inst.remove(this.setState,this),Ct.inst.remove(this.setState,this),gt.GRoot.inst.off(s.Up,this.$mouseup),super.dispose()}}xe.UP="up",xe.DOWN="down",xe.OVER="over",xe.SELECTED_OVER="selectedOver",xe.DISABLED="disabled",xe.SELECTED_DISABLED="selectedDisabled";class Se extends Qt{constructor(){super(),this.$visibleItemCount=0,this.$selectedIndex=0,this.$popupDir=1,this.$visibleItemCount=S.defaultComboBoxVisibleItemCount,this.$itemsUpdated=!0,this.$selectedIndex=-1,this.$items=[],this.$values=[]}get text(){return this.$titleObject?this.$titleObject.text:null}set text(t){this.$titleObject&&(this.$titleObject.text=t),this.updateGear(6)}get icon(){return this.$iconObject?this.$iconObject.icon:null}set icon(t){this.$iconObject&&(this.$iconObject.icon=t),this.updateGear(7)}get titleColor(){if(we(this.$titleObject))return this.$titleObject.titleColor}set titleColor(t){we(this.$titleObject)&&(this.$titleObject.titleColor=t)}get visibleItemCount(){return this.$visibleItemCount}set visibleItemCount(t){this.$visibleItemCount=t}get popupDirection(){return this.$popupDir}set popupDirection(t){this.$popupDir=t}get items(){return this.$items}set items(t){t?this.$items=t.concat():this.$items.length=0,this.$items.length>0?(this.$selectedIndex>=this.$items.length?this.$selectedIndex=this.$items.length-1:-1==this.$selectedIndex&&(this.$selectedIndex=0),this.text=this.$items[this.$selectedIndex],null!=this.$icons&&this.$selectedIndex<this.$icons.length&&(this.icon=this.$icons[this.$selectedIndex])):(this.text="",null!=this.$icons&&(this.icon=null),this.$selectedIndex=-1),this.$itemsUpdated=!0}get icons(){return this.$icons}set icons(t){this.$icons=t,null!=this.$icons&&-1!=this.$selectedIndex&&this.$selectedIndex<this.$icons.length&&(this.icon=this.$icons[this.$selectedIndex])}get values(){return this.$values}set values(t){t?this.$values=t.concat():this.$values.length=0}get selectedIndex(){return this.$selectedIndex}set selectedIndex(t){this.$selectedIndex!=t&&(this.$selectedIndex=t,this.selectedIndex>=0&&this.selectedIndex<this.$items.length?(this.text=this.$items[this.$selectedIndex],null!=this.$icons&&this.$selectedIndex<this.$icons.length&&(this.icon=this.$icons[this.$selectedIndex])):(this.text="",null!=this.$icons&&(this.icon=null)))}get value(){return this.$values[this.$selectedIndex]}set value(t){this.selectedIndex=this.$values.indexOf(t)}setState(t){this.$buttonController&&(this.$buttonController.selectedPage=t)}constructFromXML(t){let e;if(super.constructFromXML(t),t=V.getChildNodes(t,"ComboBox")[0],this.$buttonController=this.getController("button"),this.$titleObject=this.getChild("title"),this.$iconObject=this.getChild("icon"),e=t.attributes.dropdown,e){if(this.$dropdown=q.createObjectFromURL(e),!this.$dropdown)throw new Error("the 'dropdown' is not specified, it must be a component definied in the package pool");if(this.$dropdown.name="this.dropdown",this.$list=this.$dropdown.getChild("list"),null==this.$list)throw new Error(this.resourceURL+": the dropdown component must have a GList child and named 'list'.");this.$list.on("__itemClick",this.$clickItem,this),this.$list.addRelation(this.$dropdown,14),this.$list.removeRelation(this.$dropdown,15),this.$dropdown.addRelation(this.$list,15),this.$dropdown.removeRelation(this.$list,14),this.$dropdown.on("removed",this.$popupWinClosed,this)}Nt.any||(this.on(s.Over,this.$rollover,this),this.on(s.Out,this.$rollout,this)),this.on(s.Down,this.$mousedown,this)}dispose(){Ct.inst.remove(this.delayedClickItem,this),this.$list.off("__itemClick",this.$clickItem),this.$dropdown.off("removed",this.$popupWinClosed),te.inst.nativeStage.off(s.Up,this.$mouseUpEvent),this.$popupWinClosed(null),this.$dropdown&&(this.$dropdown.dispose(),this.$dropdown=null),super.dispose()}setupAfterAdd(t){if(super.setupAfterAdd(t),t=V.getChildNodes(t,"ComboBox")[0]){let e;e=t.attributes.titleColor,e&&(this.titleColor=e),e=t.attributes.visibleItemCount,e&&(this.$visibleItemCount=parseInt(e));let i=t.children;i&&i.forEach((t,i)=>{"item"==t.nodeName&&(this.$items.push(t.attributes.title),this.$values.push(t.attributes.value),e=t.attributes.icon,e&&(this.$icons||(this.$icons=new Array(length)),this.$icons[i]=e))}),e=t.attributes.title,e?(this.text=e,this.$selectedIndex=this.$items.indexOf(e)):this.$items.length>0?(this.$selectedIndex=0,this.text=this.$items[0]):this.$selectedIndex=-1,e=t.attributes.icon,e&&(this.icon=e),e=t.attributes.direction,e&&("up"==e?this.$popupDir=2:"auto"==e&&(this.$popupDir=0))}}showDropdown(){this.$itemsUpdated&&(this.$itemsUpdated=!1,this.$list.removeChildrenToPool(),this.$items.forEach((t,e)=>{let i=this.$list.addItemFromPool();i.name=e<this.$values.length?this.$values[e]:"",i.text=this.$items[e],i.icon=null!=this.$icons&&e<this.$icons.length?this.$icons[e]:null},this),this.$list.resizeToFit(this.$visibleItemCount)),this.$list.selectedIndex=-1,this.$dropdown.width=this.width,te.findFor(this).togglePopup(this.$dropdown,this,this.$popupDir),this.$dropdown.parent&&this.setState(xe.DOWN)}$popupWinClosed(t){this.$over?this.setState(xe.OVER):this.setState(xe.UP)}$clickItem(t){let e=t.data.item,i=this.$list.getChildIndex(e);Ct.inst.add(100,1,this.delayedClickItem,this,i)}delayedClickItem(t){this.$dropdown.parent instanceof te&&this.$dropdown.parent.hidePopup(),this.$selectedIndex=t,this.$selectedIndex>=0?this.text=this.$items[this.$selectedIndex]:this.text="";let e=new createjs.Event("__stateChanged",!0,!1);e.data={selectedIndex:this.$selectedIndex},this.dispatchEvent(e,this)}$rollover(t){this.$over=!0,this.$down||this.$dropdown&&this.$dropdown.parent||this.setState(xe.OVER)}$rollout(t){this.$over=!1,this.$down||this.$dropdown&&this.$dropdown.parent||this.setState(xe.UP)}$mousedown(t){t.stopPropagation(),te.inst.checkPopups(t.target),this.$down=!0,this.$mouseUpEvent=te.inst.nativeStage.on(s.Up,this.$mouseup,this),this.$dropdown&&this.showDropdown()}$mouseup(t){this.$down&&(this.$down=!1,te.inst.nativeStage.off(s.Up,this.$mouseUpEvent),this.$dropdown&&!this.$dropdown.parent&&(this.$over?this.setState(xe.OVER):this.setState(xe.UP)))}}class ve extends Qt{constructor(){super(),this.$max=0,this.$value=0,this.$barMaxWidth=0,this.$barMaxHeight=0,this.$barMaxWidthDelta=0,this.$barMaxHeightDelta=0,this.$titleType=0,this.$value=50,this.$max=100,this.$clickPos=new createjs.Point}get titleType(){return this.$titleType}set titleType(t){this.$titleType=t}get max(){return this.$max}set max(t){this.$max!=t&&(this.$max=t,this.update())}get value(){return this.$value}set value(t){this.$value!=t&&(this.$value=t,this.update())}update(){let t=Math.min(this.$value/this.$max,1);this.updateWidthPercent(t)}updateWidthPercent(t){if(this.$titleObject)switch(this.$titleType){case 0:this.$titleObject.text=Math.round(100*t)+"%";break;case 1:this.$titleObject.text=`${this.$value}/${this.$max}`;break;case 2:this.$titleObject.text=""+this.$value;break;case 3:this.$titleObject.text=""+this.$max}this.$barObjectH&&(this.$barObjectH.width=(this.width-this.$barMaxWidthDelta)*t),this.$barObjectV&&(this.$barObjectV.height=(this.height-this.$barMaxHeightDelta)*t),this.$aniObject instanceof Tt&&(this.$aniObject.frame=Math.round(100*t))}handleSizeChanged(){super.handleSizeChanged(),this.$barObjectH&&(this.$barMaxWidth=this.width-this.$barMaxWidthDelta),this.$barObjectV&&(this.$barMaxHeight=this.height-this.$barMaxHeightDelta),this.$inProgressBuilding||this.update()}setupAfterAdd(t){super.setupAfterAdd(t),(t=V.getChildNodes(t,"Slider")[0])&&(this.$value=parseInt(t.attributes.value),this.$max=parseInt(t.attributes.max)),this.update()}constructFromXML(t){let e;super.constructFromXML(t),(t=V.getChildNodes(t,"Slider")[0])&&(e=t.attributes.titleType,e&&(this.$titleType=d(e))),this.$titleObject=this.getChild("title"),this.$barObjectH=this.getChild("bar"),this.$barObjectV=this.getChild("bar_v"),this.$aniObject=this.getChild("ani"),this.$gripObject=this.getChild("grip"),this.$barObjectH&&(this.$barMaxWidth=this.$barObjectH.width,this.$barMaxWidthDelta=this.width-this.$barMaxWidth),this.$barObjectV&&(this.$barMaxHeight=this.$barObjectV.height,this.$barMaxHeightDelta=this.height-this.$barMaxHeight),this.$gripObject&&this.$gripObject.on(s.Down,this.$gripMouseDown,this)}$gripMouseDown(t){this.$clickPos=this.globalToLocal(t.stageX,t.stageY),this.$clickPercent=this.$value/this.$max,this.$mouseMoveEvent=te.inst.nativeStage.on(s.Move,this.$gripMouseMove,this),this.$mouseUpEvent=te.inst.nativeStage.on(s.Up,this.$gripMouseUp,this)}$gripMouseMove(t){let e,i=this.globalToLocal(t.stageX,t.stageY,ve.sSilderHelperPoint),s=i.x-this.$clickPos.x,h=i.y-this.$clickPos.y;e=this.$barObjectH?this.$clickPercent+s/this.$barMaxWidth:this.$clickPercent+h/this.$barMaxHeight,e>1?e=1:e<0&&(e=0);let r=Math.round(this.$max*e);if(r!=this.$value){this.$value=r;let t=new createjs.Event("__stateChanged",!0,!1);this.dispatchEvent(t,this)}this.updateWidthPercent(e)}$gripMouseUp(t){let e=this.$value/this.$max;this.updateWidthPercent(e),te.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),te.inst.nativeStage.off(s.Up,this.$mouseUpEvent)}dispose(){this.$gripObject&&this.$gripObject.off(s.Down,this.$gripMouseDown),te.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),te.inst.nativeStage.off(s.Up,this.$mouseUpEvent),super.dispose()}}ve.sSilderHelperPoint=new createjs.Point;class Ce extends Qt{constructor(){super(),this.$max=0,this.$value=0,this.$barMaxWidth=0,this.$barMaxHeight=0,this.$barMaxWidthDelta=0,this.$barMaxHeightDelta=0,this.$barStartX=0,this.$barStartY=0,this.$tweenValue=0,this.$titleType=0,this.$value=50,this.$max=100}get titleType(){return this.$titleType}set titleType(t){this.$titleType!=t&&(this.$titleType=t,this.update(this.$value))}get max(){return this.$max}set max(t){this.$max!=t&&(this.$max=t,this.update(this.$value))}get value(){return this.$value}set value(t){null!=this.$tweener&&(this.$tweener.paused=!0,this.$tweener=null),this.$value!=t&&(this.$value=t,this.update(this.$value))}tweenValue(t,e){return this.$value!=t?(this.$tweener&&(this.$tweener.paused=!0,this.$tweener.removeAllEventListeners(),createjs.Tween.removeTweens(this)),this.$tweenValue=this.$value,this.$value=t,this.$tweener=createjs.Tween.get(this,{onChange:Ut.create(this.onUpdateTween,this)}).to({$tweenValue:t},1e3*e,Ce.easeLinear),this.$tweener):null}onUpdateTween(){this.update(this.$tweenValue)}update(t){let e=0!=this.$max?Math.min(t/this.$max,1):0;if(this.$titleObject)switch(this.$titleType){case 0:this.$titleObject.text=Math.round(100*e)+"%";break;case 1:this.$titleObject.text=`${Math.round(t)}/${Math.round(this.$max)}`;break;case 2:this.$titleObject.text=""+Math.round(t);break;case 3:this.$titleObject.text=""+Math.round(this.$max)}let i=this.width-this.$barMaxWidthDelta,s=this.height-this.$barMaxHeightDelta;this.$reverse?(this.$barObjectH&&(this.$barObjectH.width=i*e,this.$barObjectH.x=this.$barStartX+(i-this.$barObjectH.width)),this.$barObjectV&&(this.$barObjectV.height=s*e,this.$barObjectV.y=this.$barStartY+(s-this.$barObjectV.height))):(this.$barObjectH&&(this.$barObjectH.width=i*e),this.$barObjectV&&(this.$barObjectV.height=s*e)),this.$aniObject instanceof Tt&&(this.$aniObject.frame=Math.round(100*e))}constructFromXML(t){let e;super.constructFromXML(t),e=(t=V.getChildNodes(t,"ProgressBar")[0]).attributes.titleType,e&&(this.$titleType=d(e)),this.$reverse="true"==t.attributes.reverse,this.$titleObject=this.getChild("title"),this.$barObjectH=this.getChild("bar"),this.$barObjectV=this.getChild("bar_v"),this.$aniObject=this.getChild("ani"),this.$barObjectH&&(this.$barMaxWidth=this.$barObjectH.width,this.$barMaxWidthDelta=this.width-this.$barMaxWidth,this.$barStartX=this.$barObjectH.x),this.$barObjectV&&(this.$barMaxHeight=this.$barObjectV.height,this.$barMaxHeightDelta=this.height-this.$barMaxHeight,this.$barStartY=this.$barObjectV.y)}handleSizeChanged(){super.handleSizeChanged(),this.$barObjectH&&(this.$barMaxWidth=this.width-this.$barMaxWidthDelta),this.$barObjectV&&(this.$barMaxHeight=this.height-this.$barMaxHeightDelta),this.$inProgressBuilding||this.update(this.$value)}setupAfterAdd(t){super.setupAfterAdd(t),(t=V.getChildNodes(t,"ProgressBar")[0])&&(this.$value=parseInt(t.attributes.value)||0,this.$max=parseInt(t.attributes.max)||0),this.update(this.$value)}dispose(){this.$tweener&&(this.$tweener.paused=!0,this.$tweener.removeAllEventListeners()),createjs.Tween.removeTweens(this),this.$tweener=null,super.dispose()}}Ce.easeLinear=x("linear");class Ie extends Qt{constructor(){super(),this.$dragOffset=new createjs.Point,this.$scrollPerc=0}setScrollPane(t,e){this.$target=t,this.$vertical=e}set displayPerc(t){this.$vertical?(this.$fixedGripSize||(this.$grip.height=t*this.$bar.height),this.$grip.y=this.$bar.y+(this.$bar.height-this.$grip.height)*this.$scrollPerc):(this.$fixedGripSize||(this.$grip.width=t*this.$bar.width),this.$grip.x=this.$bar.x+(this.$bar.width-this.$grip.width)*this.$scrollPerc)}get scrollPerc(){return this.$scrollPerc}set scrollPerc(t){this.$scrollPerc=t,this.$vertical?this.$grip.y=this.$bar.y+(this.$bar.height-this.$grip.height)*this.$scrollPerc:this.$grip.x=this.$bar.x+(this.$bar.width-this.$grip.width)*this.$scrollPerc}get minSize(){return this.$vertical?(null!=this.$arrowButton1?this.$arrowButton1.height:0)+(null!=this.$arrowButton2?this.$arrowButton2.height:0):(null!=this.$arrowButton1?this.$arrowButton1.width:0)+(null!=this.$arrowButton2?this.$arrowButton2.width:0)}constructFromXML(t){super.constructFromXML(t),null!=(t=V.getChildNodes(t,"ScrollBar")[0])&&(this.$fixedGripSize="true"==t.attributes.fixedGripSize),this.$grip=this.getChild("grip"),this.$grip?(this.$bar=this.getChild("bar"),this.$bar?(this.$arrowButton1=this.getChild("arrow1"),this.$arrowButton2=this.getChild("arrow2"),this.$grip.on(s.Down,this.$gripMouseDown,this),this.$arrowButton1&&this.$arrowButton1.on(s.Down,this.$arrowButton1Click,this),this.$arrowButton2&&this.$arrowButton2.on(s.Down,this.$arrowButton2Click,this),this.on(s.Down,this.$barMouseDown,this)):console.error("please create and define 'bar' in the Editor for the scrollbar")):console.error("please create and define 'grip' in the Editor for the scrollbar")}$gripMouseDown(t){this.$bar&&(t.stopPropagation(),this.$dragOffset=new createjs.Point(t.localX,t.localY),this.$dragOffset.x-=this.$grip.x,this.$dragOffset.y-=this.$grip.y,this.$mouseMoveEvent=te.inst.nativeStage.on(s.Move,this.$gripDragging,this),this.$mouseUpEvent=te.inst.nativeStage.on(s.Up,this.$gripDraggingEnd,this))}$gripDragging(t){let e=t.target.localToLocal(t.localX,t.localY,this.$displayObject);if(0==Ie.sScrollbarHelperPoint.x&&0==Ie.sScrollbarHelperPoint.y&&(Ie.sScrollbarHelperPoint.x=this.$target.$xPos,Ie.sScrollbarHelperPoint.y=this.$target.$yPos),e.x-=Ie.sScrollbarHelperPoint.x,e.y-=Ie.sScrollbarHelperPoint.y,this.$vertical){let t=e.y-this.$dragOffset.y;this.$target.setPercY((t-this.$bar.y)/(this.$bar.height-this.$grip.height),!1)}else{let t=e.x-this.$dragOffset.x;this.$target.setPercX((t-this.$bar.x)/(this.$bar.width-this.$grip.width),!1)}}$gripDraggingEnd(t){Ie.sScrollbarHelperPoint=new createjs.Point,te.inst.nativeStage.off(s.Move,this.$mouseMoveEvent),te.inst.nativeStage.off(s.Up,this.$mouseUpEvent)}$arrowButton1Click(t){t.stopPropagation(),this.$vertical?this.$target.scrollUp():this.$target.scrollLeft()}$arrowButton2Click(t){t.stopPropagation(),this.$vertical?this.$target.scrollDown():this.$target.scrollRight()}$barMouseDown(t){let e=new createjs.Point(t.localX,t.localY);this.$vertical?e.y<0?this.$target.scrollUp(4):this.$target.scrollDown(4):e.x<0?this.$target.scrollLeft(4):this.$target.scrollRight(4)}dispose(){this.off(s.Down,this.$barMouseDown),Ie.sScrollbarHelperPoint=new createjs.Point,this.$arrowButton1&&this.$arrowButton1.off(s.Down,this.$arrowButton1Click),this.$arrowButton2&&this.$arrowButton2.off(s.Down,this.$arrowButton2Click),this.$grip.off(s.Down,this.$gripMouseDown),this.$gripDraggingEnd(null),super.dispose()}}Ie.sScrollbarHelperPoint=new createjs.Point;class Pe{constructor(){this.width=0,this.height=0,this.updateFlag=0,this.selected=!1}}class Ee extends Qt{constructor(){super(),this.$lineCount=0,this.$columnCount=0,this.$lineGap=0,this.$columnGap=0,this.$lastSelectedIndex=0,this.$numItems=0,this.$firstIndex=0,this.$curLineItemCount=0,this.$virtualListChanged=0,this.$apexIndex=0,this.$childrenRenderOrder=0,this.$itemInfoVer=0,this.$enterCounter=0,this.$trackBounds=!0,this.$pool=new fe,this.$layout=0,this.$autoResizeItem=!0,this.$lastSelectedIndex=-1,this.$selectionMode=0,this.opaque=!0,this.scrollItemToViewOnClick=!0,this.$align="left",this.$verticalAlign=0,this.$container=new createjs.Container,this.$rootContainer.addChild(this.$container),this.$container.cursor="pointer"}get childrenRenderOrder(){return this.$childrenRenderOrder}set childrenRenderOrder(t){this.$childrenRenderOrder!=t&&(this.$childrenRenderOrder=t,this.appendChildrenList())}get apexIndex(){return this.$apexIndex}set apexIndex(t){this.$apexIndex!=t&&(this.$apexIndex=t,2==this.$childrenRenderOrder&&this.appendChildrenList())}appendChildrenList(){const t=this.$children.length;if(0==t)return;let e,i;switch(this.$childrenRenderOrder){case 0:for(e=0;e<t;e++)i=this.$children[e],null!=i.displayObject&&i.finalVisible&&this.$container.addChild(i.displayObject);break;case 1:for(e=t-1;e>=0;e--)i=this.$children[e],null!=i.displayObject&&i.finalVisible&&this.$container.addChild(i.displayObject);break;case 2:for(e=0;e<this.$apexIndex;e++)i=this.$children[e],null!=i.displayObject&&i.finalVisible&&this.$container.addChild(i.displayObject);for(e=t-1;e>=this.$apexIndex;e--)i=this.$children[e],null!=i.displayObject&&i.finalVisible&&this.$container.addChild(i.displayObject)}}setXY(t,e){this.$x==t&&this.$y==e||(this.$x=t,this.$y=e,this.handleXYChanged(),this.updateGear(1),pt.draggingObject!=this||pt.sUpdatingWhileDragging||this.localToGlobalRect(0,0,this.width,this.height,pt.sGlobalRect))}$setChildIndex(t,e,i=0){let s=this.$children.length;if(i>s&&(i=s),e==i)return e;if(this.$children.splice(e,1),this.$children.splice(i,0,t),t.inContainer){let e,h,r=0;if(0==this.$childrenRenderOrder){for(h=0;h<i;h++)e=this.$children[h],e.inContainer&&r++;r==this.$container.children.length&&r--,this.$container.setChildIndex(t.displayObject,r)}else if(1==this.$childrenRenderOrder){for(h=s-1;h>i;h--)e=this.$children[h],e.inContainer&&r++;r==this.$container.children.length&&r--,this.$container.setChildIndex(t.displayObject,r)}else Ct.inst.callLater(this.appendChildrenList,this);this.setBoundsChangedFlag()}return i}childStateChanged(t){if(!this.$buildingDisplayList)if(t instanceof ft)this.$children.forEach(e=>{e.group==t&&this.childStateChanged(e)},this);else if(t.displayObject)if(t.finalVisible){let e,i,s=this.$children.length;if(!t.displayObject.parent){let h=0;if(0==this.$childrenRenderOrder){for(let e=0;e<s&&(i=this.$children[e],i!=t);e++)null!=i.displayObject&&null!=i.displayObject.parent&&h++;this.$container.addChildAt(t.displayObject,h)}else if(1==this.$childrenRenderOrder){for(e=s-1;e>=0&&(i=this.$children[e],i!=t);e--)null!=i.displayObject&&null!=i.displayObject.parent&&h++;this.$container.addChildAt(t.displayObject,h)}else this.$container.addChild(t.displayObject),Ct.inst.callLater(this.appendChildrenList,this)}}else t.displayObject.parent&&this.$container.removeChild(t.displayObject)}dispose(){Ct.inst.remove(this.$refreshVirtualList,this),this.$pool.clear(),this.$scrollPane&&this.$scrollPane.off("__scroll",this.$scrolled),super.dispose()}get layout(){return this.$layout}set layout(t){this.$layout!=t&&(this.$layout=t,this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0))}get lineCount(){return this.$lineCount}set lineCount(t){this.$lineCount!=t&&(this.$lineCount=t,3!=this.$layout&&4!=this.$layout||(this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0)))}get columnCount(){return this.$columnCount}set columnCount(t){this.$columnCount!=t&&(this.$columnCount=t,2!=this.$layout&&4!=this.$layout||(this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0)))}get lineGap(){return this.$lineGap}set lineGap(t){this.$lineGap!=t&&(this.$lineGap=t,this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0))}get columnGap(){return this.$columnGap}set columnGap(t){this.$columnGap!=t&&(this.$columnGap=t,this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0))}get align(){return this.$align}set align(t){this.$align!=t&&(this.$align=t,this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0))}get verticalAlign(){return this.$verticalAlign}set verticalAlign(t){this.$verticalAlign!=t&&(this.$verticalAlign=t,this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0))}get virtualItemSize(){return this.$itemSize}set virtualItemSize(t){this.$virtual&&(null==this.$itemSize&&(this.$itemSize=new createjs.Point),this.$itemSize.copy(t),this.setVirtualListChangedFlag(!0))}get defaultItem(){return this.$defaultItem}set defaultItem(t){this.$defaultItem=t}get autoResizeItem(){return this.$autoResizeItem}set autoResizeItem(t){this.$autoResizeItem!=t&&(this.$autoResizeItem=t,this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0))}get selectionMode(){return this.$selectionMode}set selectionMode(t){this.$selectionMode=t}get selectionController(){return this.$selectionController}set selectionController(t){this.$selectionController=t}get itemPool(){return this.$pool}getFromPool(t=null){t||(t=this.$defaultItem);let e=this.$pool.get(t);return null!=e&&(e.visible=!0),e}returnToPool(t){this.$pool.recycle(t.resourceURL,t)}addChildAt(t,e=0){return super.addChildAt(t,e),t instanceof xe&&(t.selected=!1,t.changeStateOnClick=!1),t.click(this.$clickItem,this),t}addItem(t=null){return t||(t=this.$defaultItem),this.addChild(q.createObjectFromURL(t))}addItemFromPool(t=null){return this.addChild(this.getFromPool(t))}removeChildAt(t,e=!1){if(t>=0&&t<this.numChildren){let i=this.$children[t];return i.parent=null,0!=i.sortingOrder&&this.$sortingChildCount--,this.$children.splice(t,1),i.inContainer&&(this.$container.removeChild(i.displayObject),2==this.$childrenRenderOrder&&Ct.inst.callLater(this.appendChildrenList,this)),!0===e&&i.dispose(),this.setBoundsChangedFlag(),i.removeClick(this.$clickItem),i}throw new Error("Invalid child index")}removeChildToPoolAt(t){let e=this.removeChildAt(t);this.returnToPool(e)}removeChildToPool(t){super.removeChild(t),this.returnToPool(t)}removeChildrenToPool(t=0,e=-1){(e<0||e>=this.$children.length)&&(e=this.$children.length-1);for(let i=t;i<=e;++i)this.removeChildToPoolAt(t)}get selectedIndex(){let t;if(this.$virtual)for(t=0;t<this.$realNumItems;t++){const e=this.$virtualItems[t];if(e.obj instanceof xe&&e.obj.selected||null==e.obj&&e.selected)return this.$loop?t%this.$numItems:t}else{const e=this.$children.length;for(t=0;t<e;t++){const e=this.$children[t];if(null!=e&&e.selected)return t}}return-1}set selectedIndex(t){t>=0&&t<this.numItems?(0!=this.selectionMode&&this.clearSelection(),this.addSelection(t)):this.clearSelection()}getSelection(){let t,e=[];if(this.$virtual)for(t=0;t<this.$realNumItems;t++){const i=this.$virtualItems[t];if(i.obj instanceof xe&&i.obj.selected||null==i.obj&&i.selected){let i=t;if(this.$loop&&(i=t%this.$numItems,-1!=e.indexOf(i)))continue;e.push(i)}}else{const i=this.$children.length;for(t=0;t<i;t++){const i=this.$children[t];null!=i&&i.selected&&e.push(t)}}return e}addSelection(t,e=!1){if(3==this.$selectionMode)return;this.checkVirtualList(),0==this.$selectionMode&&this.clearSelection(),e&&this.scrollToView(t),this.$lastSelectedIndex=t;let i=null;if(this.$virtual){const e=this.$virtualItems[t];null!=e.obj&&(i=e.obj),e.selected=!0}else i=this.getChildAt(t);null==i||i.selected||(i.selected=!0,this.updateSelectionController(t))}removeSelection(t){if(3==this.$selectionMode)return;let e=null;if(this.$virtual){const i=this.$virtualItems[t];null!=i.obj&&(e=i.obj),i.selected=!1}else e=this.getChildAt(t);null!=e&&(e.selected=!1)}clearSelection(){let t;if(this.$virtual)for(t=0;t<this.$realNumItems;t++){const e=this.$virtualItems[t];e.obj instanceof xe&&(e.obj.selected=!1),e.selected=!1}else{const e=this.$children.length;for(t=0;t<e;t++){const e=this.$children[t];null!=e&&(e.selected=!1)}}}clearSelectionExcept(t){let e;if(this.$virtual)for(e=0;e<this.$realNumItems;e++){const i=this.$virtualItems[e];i.obj!=t&&(i.obj instanceof xe&&(i.obj.selected=!1),i.selected=!1)}else{const i=this.$children.length;for(e=0;e<i;e++){const i=this.$children[e];null!=i&&i!=t&&(i.selected=!1)}}}selectAll(){this.checkVirtualList();let t,e=-1;if(this.$virtual)for(t=0;t<this.$realNumItems;t++){const i=this.$virtualItems[t];i.obj instanceof xe&&!i.obj.selected&&(i.obj.selected=!0,e=t),i.selected=!0}else{const i=this.$children.length;for(t=0;t<i;t++){const i=this.$children[t];null==i||i.selected||(i.selected=!0,e=t)}}-1!=e&&this.updateSelectionController(e)}selectNone(){this.clearSelection()}selectReverse(){this.checkVirtualList();let t,e=-1;if(this.$virtual)for(t=0;t<this.$realNumItems;t++){const i=this.$virtualItems[t];i.obj instanceof xe&&(i.obj.selected=!i.obj.selected,i.obj.selected&&(e=t)),i.selected=!i.selected}else{const i=this.$children.length;for(t=0;t<i;t++){const i=this.$children[t];null!=i&&(i.selected=!i.selected,i.selected&&(e=t))}}-1!=e&&this.updateSelectionController(e)}handleArrowKey(t){let e,i,s,h,r=this.selectedIndex;if(-1!=r)switch(t){case 38:if(0==this.$layout||3==this.$layout)r--,r>=0&&(this.clearSelection(),this.addSelection(r,!0));else if(2==this.$layout||4==this.$layout){for(e=this.$children[r],i=0,s=r-1;s>=0;s--){if(h=this.$children[s],h.y!=e.y){e=h;break}i++}for(;s>=0;s--)if(h=this.$children[s],h.y!=e.y){this.clearSelection(),this.addSelection(s+i+1,!0);break}}break;case 39:if(1==this.$layout||2==this.$layout||4==this.$layout)r++,r<this.$children.length&&(this.clearSelection(),this.addSelection(r,!0));else if(3==this.$layout){e=this.$children[r],i=0;const t=this.$children.length;for(s=r+1;s<t;s++){if(h=this.$children[s],h.x!=e.x){e=h;break}i++}for(;s<t;s++)if(h=this.$children[s],h.x!=e.x){this.clearSelection(),this.addSelection(s-i-1,!0);break}}break;case 40:if(0==this.$layout||3==this.$layout)r++,r<this.$children.length&&(this.clearSelection(),this.addSelection(r,!0));else if(2==this.$layout||4==this.$layout){e=this.$children[r],i=0;const t=this.$children.length;for(s=r+1;s<t;s++){if(h=this.$children[s],h.y!=e.y){e=h;break}i++}for(;s<t;s++)if(h=this.$children[s],h.y!=e.y){this.clearSelection(),this.addSelection(s-i-1,!0);break}}break;case 37:if(1==this.$layout||2==this.$layout||4==this.$layout)r--,r>=0&&(this.clearSelection(),this.addSelection(r,!0));else if(3==this.$layout){for(e=this.$children[r],i=0,s=r-1;s>=0;s--){if(h=this.$children[s],h.x!=e.x){e=h;break}i++}for(;s>=0;s--)if(h=this.$children[s],h.x!=e.x){this.clearSelection(),this.addSelection(s+i+1,!0);break}}}}$clickItem(t){if(null!=this.$scrollPane&&this.$scrollPane.isDragging)return;const e=pt.castFromNativeObject(t.currentTarget);if(!e)return;this.setSelectionOnEvent(e),this.$scrollPane&&this.scrollItemToViewOnClick&&this.$scrollPane.scrollToView(e,!0);let i=new createjs.Event("__itemClick",!0,!1);i.data={item:e},this.dispatchEvent(i,this)}setSelectionOnEvent(t){if(!(t instanceof xe)||3==this.$selectionMode)return;let e=!1,i=this.childIndexToItemIndex(this.getChildIndex(t));if(0==this.$selectionMode)t.selected||(this.clearSelectionExcept(t),t.selected=!0);else if(jt.inst.isKeyPressed(16)){if(!t.selected)if(-1!=this.$lastSelectedIndex){const t=Math.min(this.$lastSelectedIndex,i),s=Math.min(Math.max(this.$lastSelectedIndex,i),this.numItems-1);let h;if(this.$virtual)for(h=t;h<=s;h++){const t=this.$virtualItems[h];t.obj instanceof xe&&(t.obj.selected=!0),t.selected=!0}else for(h=t;h<=s;h++){const t=this.getChildAt(h);null!=t&&(t.selected=!0)}e=!0}else t.selected=!0}else jt.inst.isKeyPressed(17)||2==this.$selectionMode?t.selected=!t.selected:t.selected?this.clearSelectionExcept(t):(this.clearSelectionExcept(t),t.selected=!0);e||(this.$lastSelectedIndex=i),t.selected&&this.updateSelectionController(i)}resizeToFit(t=1e6,e=0){this.ensureBoundsCorrect();const i=this.numItems;if(t>i&&(t=i),this.$virtual){const e=Math.ceil(t/this.$curLineItemCount);0==this.$layout||2==this.$layout?this.viewHeight=e*this.$itemSize.y+Math.max(0,e-1)*this.$lineGap:this.viewWidth=e*this.$itemSize.x+Math.max(0,e-1)*this.$columnGap}else if(0==t)0==this.$layout||2==this.$layout?this.viewHeight=e:this.viewWidth=e;else{let i,s=t-1;for(;s>=0&&(i=this.getChildAt(s),this.foldInvisibleItems&&!i.visible);)s--;if(s<0)0==this.$layout||2==this.$layout?this.viewHeight=e:this.viewWidth=e;else{let t=0;0==this.$layout||2==this.$layout?(t=i.y+i.height,t<e&&(t=e),this.viewHeight=t):(t=i.x+i.width,t<e&&(t=e),this.viewWidth=t)}}}getMaxItemWidth(){const t=this.$children.length;let e=0;for(let i=0;i<t;i++){const t=this.getChildAt(i);t.width>e&&(e=t.width)}return e}handleSizeChanged(){super.handleSizeChanged(),this.setBoundsChangedFlag(),this.$virtual&&this.setVirtualListChangedFlag(!0)}handleControllerChanged(t){super.handleControllerChanged(t),this.$selectionController==t&&(this.selectedIndex=t.selectedIndex)}updateSelectionController(t){if(null!=this.$selectionController&&!this.$selectionController.$updating&&t<this.selectionController.pageCount){const e=this.$selectionController;this.$selectionController=null,e.selectedIndex=t,this.$selectionController=e}}getSnappingPosition(t,e,i=null){if(this.$virtual){let s,h;return i||(i=new createjs.Point),0==this.$layout||2==this.$layout?(s=e,Ee.$lastPosHelper=e,h=this.getIndexOnPos1(!1),e=Ee.$lastPosHelper,h<this.$virtualItems.length&&s-e>this.$virtualItems[h].height/2&&h<this.$realNumItems&&(e+=this.$virtualItems[h].height+this.$lineGap)):1==this.$layout||3==this.$layout?(s=t,Ee.$lastPosHelper=t,h=this.getIndexOnPos2(!1),t=Ee.$lastPosHelper,h<this.$virtualItems.length&&s-t>this.$virtualItems[h].width/2&&h<this.$realNumItems&&(t+=this.$virtualItems[h].width+this.$columnGap)):(s=t,Ee.$lastPosHelper=t,h=this.getIndexOnPos3(!1),t=Ee.$lastPosHelper,h<this.$virtualItems.length&&s-t>this.$virtualItems[h].width/2&&h<this.$realNumItems&&(t+=this.$virtualItems[h].width+this.$columnGap)),i.x=t,i.y=e,i}return super.getSnappingPosition(t,e,i)}scrollToView(t,e=!1,i=!1){if(this.$virtual){if(0==this.$numItems)return;if(this.checkVirtualList(),t>=this.$virtualItems.length)throw new Error(`Invalid child index: ${t} is larger than max length: ${this.$virtualItems.length}`);let s;this.$loop&&(t=Math.floor(this.$firstIndex/this.$numItems)*this.$numItems+t);const h=this.$virtualItems[t];let r,n=0;if(0==this.$layout||2==this.$layout){for(r=0;r<t;r+=this.$curLineItemCount)n+=this.$virtualItems[r].height+this.$lineGap;s=new createjs.Rectangle(0,n,this.$itemSize.x,h.height)}else if(1==this.$layout||3==this.$layout){for(r=0;r<t;r+=this.$curLineItemCount)n+=this.$virtualItems[r].width+this.$columnGap;s=new createjs.Rectangle(n,0,h.width,this.$itemSize.y)}else{const e=t/(this.$curLineItemCount*this.$curLineItemCount2);s=new createjs.Rectangle(e*this.viewWidth+t%this.$curLineItemCount*(h.width+this.$columnGap),t/this.$curLineItemCount%this.$curLineItemCount2*(h.height+this.$lineGap),h.width,h.height)}i=!0,null!=this.$scrollPane&&this.$scrollPane.scrollToView(s,e,i)}else{const s=this.getChildAt(t);null!=this.$scrollPane?this.$scrollPane.scrollToView(s,e,i):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(s,e,i)}}getFirstChildInView(){return this.childIndexToItemIndex(super.getFirstChildInView())}childIndexToItemIndex(t){if(!this.$virtual)return t;if(4==this.$layout){for(let e=this.$firstIndex;e<this.$realNumItems;e++)if(null!=this.$virtualItems[e].obj&&--t<0)return e;return t}return t+=this.$firstIndex,this.$loop&&this.$numItems>0&&(t%=this.$numItems),t}itemIndexToChildIndex(t){if(!this.$virtual)return t;if(4==this.$layout)return this.getChildIndex(this.$virtualItems[t].obj);if(this.$loop&&this.$numItems>0){const e=this.$firstIndex%this.$numItems;t=t>=e?this.$firstIndex+(t-e):this.$firstIndex+this.$numItems+(e-t)}else t-=this.$firstIndex;return t}setVirtual(){this.$setVirtual(!1)}setVirtualAndLoop(){this.$setVirtual(!0)}$setVirtual(t){if(!this.$virtual){if(null==this.$scrollPane)throw new Error("Virtual list must be scrollable");if(t){if(2==this.$layout||3==this.$layout)throw new Error("Virtual list with loop mode is not supported for both FlowHorizontal and FlowVertical layout");this.$scrollPane.bouncebackEffect=!1}if(this.$virtual=!0,this.$loop=t,this.$virtualItems=[],this.removeChildrenToPool(),null==this.$itemSize){this.$itemSize=new createjs.Point;const t=this.getFromPool(null);if(null==t)throw new Error("Virtual list must have a default list item resource specified through list.defaultItem = resUrl.");this.$itemSize.x=t.width,this.$itemSize.y=t.height,this.returnToPool(t)}0==this.$layout||2==this.$layout?(this.$scrollPane.scrollSpeed=this.$itemSize.y,this.$loop&&(this.$scrollPane.$loop=2)):(this.$scrollPane.scrollSpeed=this.$itemSize.x,this.$loop&&(this.$scrollPane.$loop=1)),this.$scrollPane.on("__scroll",this.$scrolled,this),this.setVirtualListChangedFlag(!0)}}get numItems(){return this.$virtual?this.$numItems:this.$children.length}set numItems(t){let e;if(this.$virtual){if(null==this.itemRenderer)throw new Error("list.itemRenderer is required");this.$numItems=t,this.$loop?this.$realNumItems=6*this.$numItems:this.$realNumItems=this.$numItems;const i=this.$virtualItems.length;if(this.$realNumItems>i)for(e=i;e<this.$realNumItems;e++){let t=new Pe;t.width=this.$itemSize.x,t.height=this.$itemSize.y,this.$virtualItems.push(t)}else for(e=this.$realNumItems;e<i;e++)this.$virtualItems[e].selected=!1;0!=this.$virtualListChanged&&Ct.inst.remove(this.$refreshVirtualList,this),this.$refreshVirtualList()}else{const i=this.$children.length;if(t>i)for(e=i;e<t;e++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider(e));else this.removeChildrenToPool(t,i);if(null!=this.itemRenderer)for(e=0;e<t;e++)this.itemRenderer(e,this.getChildAt(e))}}refreshVirtualList(){this.setVirtualListChangedFlag(!1)}checkVirtualList(){0!=this.$virtualListChanged&&(this.$refreshVirtualList(),Ct.inst.remove(this.$refreshVirtualList,this))}setVirtualListChangedFlag(t=!1){t?this.$virtualListChanged=2:0==this.$virtualListChanged&&(this.$virtualListChanged=1),Ct.inst.callLater(this.$refreshVirtualList,this)}$refreshVirtualList(){const t=2==this.$virtualListChanged;this.$virtualListChanged=0,this.$eventLocked=!0,t&&(0==this.$layout||1==this.$layout?this.$curLineItemCount=1:2==this.$layout?this.$columnCount>0?this.$curLineItemCount=this.$columnCount:(this.$curLineItemCount=Math.floor((this.$scrollPane.viewWidth+this.$columnGap)/(this.$itemSize.x+this.$columnGap)),this.$curLineItemCount<=0&&(this.$curLineItemCount=1)):3==this.$layout?this.$lineCount>0?this.$curLineItemCount=this.$lineCount:(this.$curLineItemCount=Math.floor((this.$scrollPane.viewHeight+this.$lineGap)/(this.$itemSize.y+this.$lineGap)),this.$curLineItemCount<=0&&(this.$curLineItemCount=1)):(this.$columnCount>0?this.$curLineItemCount=this.$columnCount:(this.$curLineItemCount=Math.floor((this.$scrollPane.viewWidth+this.$columnGap)/(this.$itemSize.x+this.$columnGap)),this.$curLineItemCount<=0&&(this.$curLineItemCount=1)),this.$lineCount>0?this.$curLineItemCount2=this.$lineCount:(this.$curLineItemCount2=Math.floor((this.$scrollPane.viewHeight+this.$lineGap)/(this.$itemSize.y+this.$lineGap)),this.$curLineItemCount2<=0&&(this.$curLineItemCount2=1))));let e=0,i=0;if(this.$realNumItems>0){let t,s=Math.ceil(this.$realNumItems/this.$curLineItemCount)*this.$curLineItemCount,h=Math.min(this.$curLineItemCount,this.$realNumItems);if(0==this.$layout||2==this.$layout){for(t=0;t<s;t+=this.$curLineItemCount)e+=this.$virtualItems[t].height+this.$lineGap;if(e>0&&(e-=this.$lineGap),this.$autoResizeItem)i=this.$scrollPane.viewWidth;else{for(t=0;t<h;t++)i+=this.$virtualItems[t].width+this.$columnGap;i>0&&(i-=this.$columnGap)}}else if(1==this.$layout||3==this.$layout){for(t=0;t<s;t+=this.$curLineItemCount)i+=this.$virtualItems[t].width+this.$columnGap;if(i>0&&(i-=this.$columnGap),this.$autoResizeItem)e=this.$scrollPane.viewHeight;else{for(t=0;t<h;t++)e+=this.$virtualItems[t].height+this.$lineGap;e>0&&(e-=this.$lineGap)}}else{i=Math.ceil(s/(this.$curLineItemCount*this.$curLineItemCount2))*this.viewWidth,e=this.viewHeight}}this.handleAlign(i,e),this.$scrollPane.setContentSize(i,e),this.$eventLocked=!1,this.handleScroll(!0)}$scrolled(){this.handleScroll(!1)}getIndexOnPos1(t){if(this.$realNumItems<this.$curLineItemCount)return Ee.$lastPosHelper=0,0;let e,i,s;if(this.numChildren>0&&!t){if(i=this.getChildAt(0).y,i>Ee.$lastPosHelper){for(e=this.$firstIndex-this.$curLineItemCount;e>=0;e-=this.$curLineItemCount)if(i-=this.$virtualItems[e].height+this.$lineGap,i<=Ee.$lastPosHelper)return Ee.$lastPosHelper=i,e;return Ee.$lastPosHelper=0,0}for(e=this.$firstIndex;e<this.$realNumItems;e+=this.$curLineItemCount){if(s=i+this.$virtualItems[e].height+this.$lineGap,s>Ee.$lastPosHelper)return Ee.$lastPosHelper=i,e;i=s}return Ee.$lastPosHelper=i,this.$realNumItems-this.$curLineItemCount}for(i=0,e=0;e<this.$realNumItems;e+=this.$curLineItemCount){if(s=i+this.$virtualItems[e].height+this.$lineGap,s>Ee.$lastPosHelper)return Ee.$lastPosHelper=i,e;i=s}return Ee.$lastPosHelper=i,this.$realNumItems-this.$curLineItemCount}getIndexOnPos2(t){if(this.$realNumItems<this.$curLineItemCount)return Ee.$lastPosHelper=0,0;let e,i,s;if(this.numChildren>0&&!t){if(i=this.getChildAt(0).x,i>Ee.$lastPosHelper){for(e=this.$firstIndex-this.$curLineItemCount;e>=0;e-=this.$curLineItemCount)if(i-=this.$virtualItems[e].width+this.$columnGap,i<=Ee.$lastPosHelper)return Ee.$lastPosHelper=i,e;return Ee.$lastPosHelper=0,0}for(e=this.$firstIndex;e<this.$realNumItems;e+=this.$curLineItemCount){if(s=i+this.$virtualItems[e].width+this.$columnGap,s>Ee.$lastPosHelper)return Ee.$lastPosHelper=i,e;i=s}return Ee.$lastPosHelper=i,this.$realNumItems-this.$curLineItemCount}for(i=0,e=0;e<this.$realNumItems;e+=this.$curLineItemCount){if(s=i+this.$virtualItems[e].width+this.$columnGap,s>Ee.$lastPosHelper)return Ee.$lastPosHelper=i,e;i=s}return Ee.$lastPosHelper=i,this.$realNumItems-this.$curLineItemCount}getIndexOnPos3(t){if(this.$realNumItems<this.$curLineItemCount)return Ee.$lastPosHelper=0,0;const e=this.viewWidth,i=Math.floor(Ee.$lastPosHelper/e),s=i*(this.$curLineItemCount*this.$curLineItemCount2);let h,r,n=i*e;for(h=0;h<this.$curLineItemCount;h++){if(r=n+this.$virtualItems[s+h].width+this.$columnGap,r>Ee.$lastPosHelper)return Ee.$lastPosHelper=n,s+h;n=r}return Ee.$lastPosHelper=n,s+this.$curLineItemCount-1}handleScroll(t){this.$eventLocked||(this.$enterCounter=0,0==this.$layout||2==this.$layout?(this.handleScroll1(t),this.handleArchOrder1()):1==this.$layout||3==this.$layout?(this.handleScroll2(t),this.handleArchOrder2()):this.handleScroll3(t),this.$boundsChanged=!1)}handleScroll1(t){if(this.$enterCounter++,this.$enterCounter>3)return void console.warn("this list view cannot be filled full as the itemRenderer function always returns an item with different size.");let e=this.$scrollPane.scrollingPosY,i=e+this.$scrollPane.viewHeight;const s=i==this.$scrollPane.contentHeight;Ee.$lastPosHelper=e;const h=this.getIndexOnPos1(t);if(h==this.$firstIndex&&!t)return;e=Ee.$lastPosHelper;const r=this.$firstIndex;this.$firstIndex=h;let n=h;const a=r>h,l=this.numChildren,o=r+l-1;let $,c,d,u,p,g=a?o:r,f=0,m=e,w=0,y=0,b=this.defaultItem;const x=(this.$scrollPane.viewWidth-this.$columnGap*(this.$curLineItemCount-1))/this.$curLineItemCount;for(this.$itemInfoVer++;n<this.$realNumItems&&(s||m<i);){if(c=this.$virtualItems[n],(null==c.obj||t)&&(null!=this.itemProvider&&(b=this.itemProvider(n%this.$numItems),null==b&&(b=this.$defaultItem),b=q.normalizeURL(b)),null!=c.obj&&c.obj.resourceURL!=b&&(c.obj instanceof xe&&(c.selected=c.obj.selected),this.removeChildToPool(c.obj),c.obj=null)),null==c.obj){if(a){for(p=g;p>=r;p--)if(d=this.$virtualItems[p],null!=d.obj&&d.updateFlag!=this.$itemInfoVer&&d.obj.resourceURL==b){d.obj instanceof xe&&(d.selected=d.obj.selected),c.obj=d.obj,d.obj=null,p==g&&g--;break}}else for(p=g;p<=o;p++)if(d=this.$virtualItems[p],null!=d.obj&&d.updateFlag!=this.$itemInfoVer&&d.obj.resourceURL==b){d.obj instanceof xe&&(d.selected=d.obj.selected),c.obj=d.obj,d.obj=null,p==g&&g++;break}null!=c.obj?this.setChildIndex(c.obj,a?n-h:this.numChildren):(c.obj=this.$pool.get(b),a?this.addChildAt(c.obj,n-h):this.addChild(c.obj)),c.obj instanceof xe&&(c.obj.selected=c.selected),$=!0}else $=t;$&&(this.$autoResizeItem&&(0==this.$layout||this.$columnCount>0)&&c.obj.setSize(x,c.obj.height,!0),this.itemRenderer(n%this.$numItems,c.obj),n%this.$curLineItemCount==0&&(w+=Math.ceil(c.obj.height)-c.height,n==h&&r>h&&(y=Math.ceil(c.obj.height)-c.height)),c.width=Math.ceil(c.obj.width),c.height=Math.ceil(c.obj.height)),c.updateFlag=this.$itemInfoVer,c.obj.setXY(f,m),n==h&&(i+=c.height),f+=c.width+this.$columnGap,n%this.$curLineItemCount==this.$curLineItemCount-1&&(f=0,m+=c.height+this.$lineGap),n++}for(u=0;u<l;u++)c=this.$virtualItems[r+u],c.updateFlag!=this.$itemInfoVer&&null!=c.obj&&(c.obj instanceof xe&&(c.selected=c.obj.selected),this.removeChildToPool(c.obj),c.obj=null);0==w&&0==y||this.$scrollPane.changeContentSizeOnScrolling(0,w,0,y),n>0&&this.numChildren>0&&this.$container.y<0&&this.getChildAt(0).y>-this.$container.y&&this.handleScroll1(!1)}handleScroll2(t){if(this.$enterCounter++,this.$enterCounter>3)return void console.warn("this list view cannot be filled full as the itemRenderer function always returns an item with different size.");let e=this.$scrollPane.scrollingPosX,i=e+this.$scrollPane.viewWidth;const s=e==this.$scrollPane.contentWidth;Ee.$lastPosHelper=e;const h=this.getIndexOnPos2(t);if(h==this.$firstIndex&&!t)return;e=Ee.$lastPosHelper;const r=this.$firstIndex;this.$firstIndex=h;let n=h;const a=r>h,l=this.numChildren;let o,$,c,d,u,p=r+l-1,g=a?p:r,f=e,m=0,w=0,y=0,b=this.defaultItem;const x=(this.$scrollPane.viewHeight-this.$lineGap*(this.$curLineItemCount-1))/this.$curLineItemCount;for(this.$itemInfoVer++;n<this.$realNumItems&&(s||f<i);){if($=this.$virtualItems[n],(null==$.obj||t)&&(null!=this.itemProvider&&(b=this.itemProvider(n%this.$numItems),null==b&&(b=this.$defaultItem),b=q.normalizeURL(b)),null!=$.obj&&$.obj.resourceURL!=b&&($.obj instanceof xe&&($.selected=$.obj.selected),this.removeChildToPool($.obj),$.obj=null)),null==$.obj){if(a){for(u=g;u>=r;u--)if(c=this.$virtualItems[u],null!=c.obj&&c.updateFlag!=this.$itemInfoVer&&c.obj.resourceURL==b){c.obj instanceof xe&&(c.selected=c.obj.selected),$.obj=c.obj,c.obj=null,u==g&&g--;break}}else for(u=g;u<=p;u++)if(c=this.$virtualItems[u],null!=c.obj&&c.updateFlag!=this.$itemInfoVer&&c.obj.resourceURL==b){c.obj instanceof xe&&(c.selected=c.obj.selected),$.obj=c.obj,c.obj=null,u==g&&g++;break}null!=$.obj?this.setChildIndex($.obj,a?n-h:this.numChildren):($.obj=this.$pool.get(b),a?this.addChildAt($.obj,n-h):this.addChild($.obj)),$.obj instanceof xe&&($.obj.selected=$.selected),o=!0}else o=t;o&&(this.$autoResizeItem&&(1==this.$layout||this.$lineCount>0)&&$.obj.setSize($.obj.width,x,!0),this.itemRenderer(n%this.$numItems,$.obj),n%this.$curLineItemCount==0&&(w+=Math.ceil($.obj.width)-$.width,n==h&&r>h&&(y=Math.ceil($.obj.width)-$.width)),$.width=Math.ceil($.obj.width),$.height=Math.ceil($.obj.height)),$.updateFlag=this.$itemInfoVer,$.obj.setXY(f,m),n==h&&(i+=$.width),m+=$.height+this.$lineGap,n%this.$curLineItemCount==this.$curLineItemCount-1&&(m=0,f+=$.width+this.$columnGap),n++}for(d=0;d<l;d++)$=this.$virtualItems[r+d],$.updateFlag!=this.$itemInfoVer&&null!=$.obj&&($.obj instanceof xe&&($.selected=$.obj.selected),this.removeChildToPool($.obj),$.obj=null);0==w&&0==y||this.$scrollPane.changeContentSizeOnScrolling(w,0,y,0),n>0&&this.numChildren>0&&this.$container.x<0&&this.getChildAt(0).x>-this.$container.x&&this.handleScroll2(!1)}handleScroll3(t){let e=this.$scrollPane.scrollingPosX;Ee.$lastPosHelper=e;const i=this.getIndexOnPos3(t);if(i==this.$firstIndex&&!t)return;e=Ee.$lastPosHelper;const s=this.$firstIndex;this.$firstIndex=i;let h=s;const r=this.$virtualItems.length,n=this.$curLineItemCount*this.$curLineItemCount2,a=i%this.$curLineItemCount,l=this.viewWidth,o=Math.floor(i/n)*n,$=o+2*n;let c,d,u,p,g,f=this.$defaultItem;const m=(this.$scrollPane.viewWidth-this.$columnGap*(this.$curLineItemCount-1))/this.$curLineItemCount,w=(this.$scrollPane.viewHeight-this.$lineGap*(this.$curLineItemCount2-1))/this.$curLineItemCount2;for(this.$itemInfoVer++,d=o;d<$;d++)if(!(d>=this.$realNumItems)){if(g=d%this.$curLineItemCount,d-o<n){if(g<a)continue}else if(g>a)continue;u=this.$virtualItems[d],u.updateFlag=this.$itemInfoVer}let y=null,b=0;for(d=o;d<$;d++)if(!(d>=this.$realNumItems)&&(u=this.$virtualItems[d],u.updateFlag==this.$itemInfoVer)){if(null==u.obj){for(;h<r;){if(p=this.$virtualItems[h],null!=p.obj&&p.updateFlag!=this.$itemInfoVer){p.obj instanceof xe&&(p.selected=p.obj.selected),u.obj=p.obj,p.obj=null;break}h++}-1==b&&(b=this.getChildIndex(y)+1),null==u.obj?(null!=this.itemProvider&&(f=this.itemProvider(d%this.$numItems),null==f&&(f=this.$defaultItem),f=q.normalizeURL(f)),u.obj=this.$pool.get(f),this.addChildAt(u.obj,b)):b=this.setChildIndexBefore(u.obj,b),b++,u.obj instanceof xe&&(u.obj.selected=u.selected),c=!0}else c=t,b=-1,y=u.obj;c&&(this.$autoResizeItem&&(this.$curLineItemCount==this.$columnCount&&this.$curLineItemCount2==this.$lineCount?u.obj.setSize(m,w,!0):this.$curLineItemCount==this.$columnCount?u.obj.setSize(m,u.obj.height,!0):this.$curLineItemCount2==this.$lineCount&&u.obj.setSize(u.obj.width,w,!0)),this.itemRenderer(d%this.$numItems,u.obj),u.width=Math.ceil(u.obj.width),u.height=Math.ceil(u.obj.height))}let x=o/n*l,S=x,v=0,C=0;for(d=o;d<$;d++)d>=this.$realNumItems||(u=this.$virtualItems[d],u.updateFlag==this.$itemInfoVer&&u.obj.setXY(S,v),u.height>C&&(C=u.height),d%this.$curLineItemCount==this.$curLineItemCount-1?(S=x,v+=C+this.$lineGap,C=0,d==o+n-1&&(x+=l,S=x,v=0)):S+=u.width+this.$columnGap);for(d=h;d<r;d++)u=this.$virtualItems[d],u.updateFlag!=this.$itemInfoVer&&null!=u.obj&&(u.obj instanceof xe&&(u.selected=u.obj.selected),this.removeChildToPool(u.obj),u.obj=null)}handleArchOrder1(){if(2==this.$childrenRenderOrder){const t=this.$scrollPane.posY+this.viewHeight/2;let e=Number.POSITIVE_INFINITY,i=0,s=0;const h=this.numChildren;for(let r=0;r<h;r++){const h=this.getChildAt(r);this.foldInvisibleItems&&!h.visible||(i=Math.abs(t-h.y-h.height/2),i<e&&(e=i,s=r))}this.apexIndex=s}}handleArchOrder2(){if(2==this.childrenRenderOrder){const t=this.$scrollPane.posX+this.viewWidth/2;let e=Number.POSITIVE_INFINITY,i=0,s=0;const h=this.numChildren;for(let r=0;r<h;r++){const h=this.getChildAt(r);this.foldInvisibleItems&&!h.visible||(i=Math.abs(t-h.x-h.width/2),i<e&&(e=i,s=r))}this.apexIndex=s}}handleAlign(t,e){let i=0,s=0;e<this.viewHeight&&(1==this.$verticalAlign?s=Math.floor((this.viewHeight-e)/2):2==this.$verticalAlign&&(s=this.viewHeight-e)),t<this.viewWidth&&("center"==this.$align?i=Math.floor((this.viewWidth-t)/2):"right"==this.$align&&(i=this.viewWidth-t)),i==this.$alignOffset.x&&s==this.$alignOffset.y||(this.$alignOffset.setValues(i,s),null!=this.$scrollPane?this.$scrollPane.adjustMaskContainer():(this.$container.x=this.$margin.left+this.$alignOffset.x,this.$container.y=this.$margin.top+this.$alignOffset.y))}updateBounds(){if(this.$virtual)return;let t,e,i=0,s=0,h=0,r=0,n=0,a=0,l=0,o=0,$=0;const c=this.$children.length,d=this.viewWidth,u=this.viewHeight;let p,g=0,f=0;if(0==this.$layout){for(t=0;t<c;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=s&&(s+=this.$lineGap),e.y=s,this.$autoResizeItem&&e.setSize(d,e.height,!0),s+=Math.ceil(e.height),e.width>h&&(h=e.width));n=Math.ceil(h),a=s}else if(1==this.$layout){for(t=0;t<c;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=i&&(i+=this.$columnGap),e.x=i,this.$autoResizeItem&&e.setSize(e.width,u,!0),i+=Math.ceil(e.width),e.height>r&&(r=e.height));n=i,a=Math.ceil(r)}else if(2==this.$layout)if(this.$autoResizeItem&&this.$columnCount>0){for(t=0;t<c;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(g+=e.sourceWidth,l++,l==this.$columnCount||t==c-1)){for(p=(d-g-(l-1)*this.$columnGap)/g,i=0,l=f;l<=t;l++)e=this.getChildAt(l),this.foldInvisibleItems&&!e.visible||(e.setXY(i,s),l<t?(e.setSize(e.sourceWidth+Math.round(e.sourceWidth*p),e.height,!0),i+=Math.ceil(e.width)+this.$columnGap):e.setSize(d-i,e.height,!0),e.height>r&&(r=e.height));s+=Math.ceil(r)+this.$lineGap,r=0,l=0,f=t+1,g=0}a=s+Math.ceil(r),n=d}else{for(t=0;t<c;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=i&&(i+=this.$columnGap),(0!=this.$columnCount&&l>=this.$columnCount||0==this.$columnCount&&i+e.width>d&&0!=r)&&(i=0,s+=Math.ceil(r)+this.$lineGap,r=0,l=0),e.setXY(i,s),i+=Math.ceil(e.width),i>h&&(h=i),e.height>r&&(r=e.height),l++);a=s+Math.ceil(r),n=Math.ceil(h)}else if(3==this.$layout)if(this.$autoResizeItem&&this.$lineCount>0){for(t=0;t<c;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(g+=e.sourceHeight,l++,l==this.$lineCount||t==c-1)){for(p=(u-g-(l-1)*this.$lineGap)/g,s=0,l=f;l<=t;l++)e=this.getChildAt(l),this.foldInvisibleItems&&!e.visible||(e.setXY(i,s),l<t?(e.setSize(e.width,e.sourceHeight+Math.round(e.sourceHeight*p),!0),s+=Math.ceil(e.height)+this.$lineGap):e.setSize(e.width,u-s,!0),e.width>h&&(h=e.width));i+=Math.ceil(h)+this.$columnGap,h=0,l=0,f=t+1,g=0}n=i+Math.ceil(h),a=u}else{for(t=0;t<c;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=s&&(s+=this.$lineGap),(0!=this.$lineCount&&l>=this.$lineCount||0==this.$lineCount&&s+e.height>u&&0!=h)&&(s=0,i+=Math.ceil(h)+this.$columnGap,h=0,l=0),e.setXY(i,s),s+=Math.ceil(e.height),s>r&&(r=s),e.width>h&&(h=e.width),l++);n=i+Math.ceil(h),a=Math.ceil(r)}else{let m;if(this.$autoResizeItem&&this.$lineCount>0&&(m=Math.floor((u-(this.$lineCount-1)*this.$lineGap)/this.$lineCount)),this.$autoResizeItem&&this.$columnCount>0){for(t=0;t<c;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(g+=e.sourceWidth,l++,l==this.$columnCount||t==c-1)){for(p=(d-g-(l-1)*this.$columnGap)/g,i=0,l=f;l<=t;l++)e=this.getChildAt(l),this.foldInvisibleItems&&!e.visible||(e.setXY(o*d+i,s),l<t?(e.setSize(e.sourceWidth+Math.round(e.sourceWidth*p),this.$lineCount>0?m:e.height,!0),i+=Math.ceil(e.width)+this.$columnGap):e.setSize(d-i,this.$lineCount>0?m:e.height,!0),e.height>r&&(r=e.height));s+=Math.ceil(r)+this.$lineGap,r=0,l=0,f=t+1,g=0,$++,(0!=this.$lineCount&&$>=this.$lineCount||0==this.$lineCount&&s+e.height>u)&&(o++,s=0,$=0)}}else for(t=0;t<c;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=i&&(i+=this.$columnGap),this.$autoResizeItem&&this.$lineCount>0&&e.setSize(e.width,m,!0),(0!=this.$columnCount&&l>=this.$columnCount||0==this.$columnCount&&i+e.width>d&&0!=r)&&(i=0,s+=Math.ceil(r)+this.$lineGap,r=0,l=0,$++,(0!=this.$lineCount&&$>=this.$lineCount||0==this.$lineCount&&s+e.height>u&&0!=h)&&(o++,s=0,$=0)),e.setXY(o*d+i,s),i+=Math.ceil(e.width),i>h&&(h=i),e.height>r&&(r=e.height),l++);a=o>0?u:s+Math.ceil(r),n=(o+1)*d}this.handleAlign(n,a),this.setBounds(0,0,n,a)}setupBeforeAdd(t){let e,i,s;if(super.setupBeforeAdd(t),e=t.attributes.layout,e&&(this.$layout=o(e)),e=t.attributes.overflow,s=e?n(e):0,e=t.attributes.margin,e&&this.$margin.parse(e),e=t.attributes.align,e&&(this.$align=m(e)),e=t.attributes.vAlign,e&&(this.$verticalAlign=w(e)),2==s){let s,h,r;e=t.attributes.scroll,s=e?a(e):1,e=t.attributes.scrollBar,h=e?u(e):0,e=t.attributes.scrollBarFlags,r=e?parseInt(e):0;let n,l,o,$,c=new Kt;e=t.attributes.scrollBarMargin,e&&c.parse(e),e=t.attributes.scrollBarRes,e&&(i=e.split(","),n=i[0],l=i[1]),e=t.attributes.ptrRes,e&&(i=e.split(","),o=i[0],$=i[1]),this.setupScroll(c,s,h,r,n,l,o,$)}else this.setupOverflow(s);e=t.attributes.lineGap,e&&(this.$lineGap=parseInt(e)),e=t.attributes.colGap,e&&(this.$columnGap=parseInt(e)),e=t.attributes.lineItemCount,e&&(2==this.$layout||4==this.$layout?this.$columnCount=parseInt(e):3==this.$layout&&(this.$lineCount=parseInt(e))),e=t.attributes.lineItemCount2,e&&(this.$lineCount=parseInt(e)),e=t.attributes.selectionMode,e&&(this.$selectionMode=$(e)),e=t.attributes.defaultItem,e&&(this.$defaultItem=e),e=t.attributes.autoItemSize,1==this.$layout||0==this.$layout?this.$autoResizeItem="false"!=e:this.$autoResizeItem="true"==e,e=t.attributes.renderOrder,e&&(this.$childrenRenderOrder=y(e),2==this.$childrenRenderOrder&&(e=t.attributes.apex,e&&(this.$apexIndex=parseInt(e)))),t.children.forEach(t=>{if("item"!=t.nodeName)return;let i=t.attributes.url;if(i||(i=this.$defaultItem),!i)return;let s=this.getFromPool(i);null!=s&&(this.addChild(s),e=t.attributes.title,e&&(s.text=e),e=t.attributes.icon,e&&(s.icon=e),e=t.attributes.name,e&&(s.name=e),e=t.attributes.selectedIcon,e&&s instanceof xe&&(s.selectedIcon=e))},this)}setupAfterAdd(t){let e;super.setupAfterAdd(t),e=t.attributes.selectionController,e&&(this.$selectionController=this.parent.getController(e))}}Ee.$lastPosHelper=0;class ke{static setPackageItemExtension(t,e){ke.packageItemExtensions[t.substring(5)]=e}static newObject(t){switch(t.type){case 0:return new vt;case 2:return new Tt;case 4:let e=ke.packageItemExtensions[t.owner.id+t.id];if(e)return new e;let i=t.owner.getItemAsset(t).attributes.extention;if(null==i)return new Qt;switch(i){case"Button":return new xe;case"ProgressBar":return new Ce;case"Label":return new ye;case"Slider":return new ve;case"ScrollBar":return new Ie;case"ComboBox":return new Se;default:return new Qt}}return null}static newObjectDirectly(t){switch(t){case"image":return new vt;case"movieclip":return new Tt;case"component":return new Qt;case"text":return new ce;case"list":return new Ee;case"richtext":return new de;case"inputtext":return new ge;case"group":return new ft;case"graph":return new wt;case"loader":return null!=ke.loaderExtension?new ke.loaderExtension:new me}return null}}ke.packageItemExtensions={},K.UIObjectFactory=ke;t.AssetLoader=k,t.Binder=Ut,t.BlendModeMap=r,t.Controller=Ht,t.DefaultUIStageOptions=At,t.DragIndicator=class{constructor(){this.$agent=new me,this.$agent.draggable=!0,this.$agent.touchable=!1,this.$agent.setSize(100,100),this.$agent.setPivot(.5,.5,!0),this.$agent.align="center",this.$agent.verticalAlign=1,this.$agent.sortingOrder=1e6,this.$agent.on("__dragEnd",this.$dragEnd,this)}get dragAgent(){return this.$agent}get isDragging(){return null!=this.$agent.parent}get sourceObject(){return this.$sourceObject}startDrag(t,e,i,s=-1){if(this.isDragging)return;this.$sourceObject=t,this.$sourceData=i,this.$agent.url=e,te.inst.addChild(this.$agent);const h=te.inst.globalToLocal(te.globalMouseStatus.mouseX,te.globalMouseStatus.mouseY);this.$agent.setXY(h.x,h.y),this.$agent.startDrag(s)}cancel(){null!=this.$agent.parent&&(this.$agent.stopDrag(),te.inst.removeChild(this.$agent),this.$sourceData=null)}$dragEnd(t){if(!this.isDragging)return;te.inst.removeChild(this.$agent);let e=this.$sourceData;this.$sourceData=null;let i=te.inst.getObjectUnderPoint(t.target.x,t.target.y);for(;null!=i;){if(i.hasListener("__dragDrop")){i.requestFocus();let t=i.displayObject,s=new createjs.Event("__dragDrop",!0,!1);return s.data={currentTarget:t,sourceData:e},void i.dispatchEvent(s,this)}i=i.parent}}},t.GButton=xe,t.GComboBox=Se,t.GComponent=Qt,t.GGraph=wt,t.GGroup=ft,t.GImage=vt,t.GLabel=ye,t.GList=Ee,t.GLoader=me,t.GMovieClip=Tt,t.GObject=pt,t.GProgressBar=Ce,t.GRichTextField=de,t.GRoot=te,t.GScrollBar=Ie,t.GSlider=ve,t.GTextField=ce,t.GTextInput=ge,t.GTimer=Ct,t.GearXMLNodeNameMap=h,t.InteractiveEvents=s,t.PackageItem=X,t.ParseAlignType=m,t.ParseAutoSizeType=f,t.ParseButtonMode=g,t.ParseEaseType=x,t.ParseFlipType=p,t.ParseListChildrenRenderOrder=y,t.ParseListLayoutType=o,t.ParseListSelectionMode=$,t.ParseLoaderFillType=l,t.ParseOverflowType=n,t.ParsePackageItemType=c,t.ParseProgressTitleType=d,t.ParseScrollBarDisplayType=u,t.ParseScrollType=a,t.ParseVertAlignType=w,t.PopupMenu=class{constructor(t=null){if(!t&&!(t=S.popupMenu))throw new Error("UIConfig.popupMenu not defined");this.$contentPane=q.createObjectFromURL(t),this.$contentPane.on("added",this.$addedToStage,this),this.$list=this.$contentPane.getChild("list"),this.$list.removeChildrenToPool(),this.$list.addRelation(this.$contentPane,14),this.$list.removeRelation(this.$contentPane,15),this.$contentPane.addRelation(this.$list,15),this.$list.on("__itemClick",this.$clickItem,this)}dispose(){Ct.inst.remove(this.$delayClickItem,this),this.$list.off("__itemClick",this.$clickItem),this.$contentPane.off("added",this.$addedToStage),this.$contentPane.dispose()}addItem(t,e){let i=this.$list.addItemFromPool();i.title=t,i.data=e,i.grayed=!1;let s=i.getController("checked");return null!=s&&(s.selectedIndex=0),i}addItemAt(t,e,i){let s=this.$list.getFromPool();this.$list.addChildAt(s,e),s.title=t,s.data=i,s.grayed=!1;let h=s.getController("checked");return null!=h&&(h.selectedIndex=0),s}addSeperator(){if(null==S.popupMenuSeperator)throw new Error("UIConfig.popupMenuSeperator not defined");this.$list.addItemFromPool(S.popupMenuSeperator)}getItemName(t){return this.$list.getChildAt(t).name}setItemText(t,e){this.$list.getChild(t).title=e}setItemVisible(t,e){let i=this.$list.getChild(t);i.visible!=e&&(i.visible=e,this.$list.setBoundsChangedFlag())}setItemGrayed(t,e){this.$list.getChild(t).grayed=e}setItemCheckable(t,e){let i=this.$list.getChild(t).getController("checked");null!=i&&(e?0==i.selectedIndex&&(i.selectedIndex=1):i.selectedIndex=0)}setItemChecked(t,e){let i=this.$list.getChild(t).getController("checked");null!=i&&(i.selectedIndex=e?2:1)}isItemChecked(t){let e=this.$list.getChild(t).getController("checked");return null!=e&&2==e.selectedIndex}removeItem(t){let e=this.$list.getChild(t);if(null!=e){let t=this.$list.getChildIndex(e);return this.$list.removeChildToPoolAt(t),!0}return!1}clearItems(){this.$list.removeChildrenToPool()}get itemCount(){return this.$list.numChildren}get contentPane(){return this.$contentPane}get list(){return this.$list}show(t=null,e){(null!=t?te.findFor(t):te.inst).showPopup(this.contentPane,t instanceof te?null:t,e)}$clickItem(t){let e=t.data.item;Ct.inst.add(100,1,this.$delayClickItem,this,e)}$delayClickItem(t){if(!(t instanceof xe))return;if(t.grayed)return void(this.$list.selectedIndex=-1);let e=t.getController("checked");null!=e&&0!=e.selectedIndex&&(1==e.selectedIndex?e.selectedIndex=2:e.selectedIndex=1);let i=this.$contentPane.parent;i&&i.hidePopup(this.contentPane),null!=t.data&&t.data.call(null),Ct.inst.remove(this.$delayClickItem,this)}$addedToStage(){this.$list.selectedIndex=-1,this.$list.resizeToFit(1e5,10)}},t.ScrollPane=Vt,t.StringUtil=H,t.Transition=Xt,t.UIConfig=S,t.UIObjectFactory=ke,t.UIPackage=q,t.UIStage=Bt,t.Window=Jt,Object.defineProperty(t,"__esModule",{value:!0})}));